!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function n(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var r={},a={},o=t.parcelRequired7c6;null==o&&((o=function(e){if(e in r)return r[e].exports;if(e in a){var t=a[e];delete a[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},t.parcelRequired7c6=o),o.register("ikNsj",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}})),o.register("8dTuY",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t,n){return a.apply(null,arguments)};var n,r=(n=o("gOtiv"))&&n.__esModule?n:{default:n};function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function a(e,t,n){return(a=i()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&r.default(a,n.prototype),a}).apply(null,arguments)}})),o.register("417tI",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}})),o.register("lhF45",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r.default(e)););return e};var n,r=(n=o("eSWTR"))&&n.__esModule?n:{default:n}}));var u=o("eZ7d6"),s=o("2TvXO"),c=o("jGMOa"),l=o("dauUa"),h=o("jxsHo"),f=o("hmUQ5"),d=o("6JpON");function v(){return(v=e(u)(e(s).mark((function t(n){var r,i,a;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),l.API.resetPage(),!(r=n.target[0].value)){t.next=18;break}return f.spiner.start(),l.API.setSearchQuery(r),t.next=8,l.API.fetchKeyword();case 8:if((i=t.sent).length){t.next=14;break}return c.filmBoxRef.innerHTML='<div style="width: 100%;"><img src="https://myron5.github.io/goit-js-hw-07/img-keyword.jpg" style="width: 100%; object-fit: cover;"></div>',e(d).Notify.warning("ðŸ’” Sorry but we can`t find films for this word"),f.spiner.stop(),t.abrupt("return");case 14:(0,h.renderFilms)(i,c.filmBoxRef),a=(0,h.pagination)(l.API.getPage(),l.API.getMax()),(0,h.renderPagination)(a,c.filmBoxRef),f.spiner.stop();case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e(u)(e(s).mark((function t(){var n,r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.spiner.start(),e.next=3,l.API.fetchPopularMovies();case 3:n=e.sent,(0,h.renderFilms)(n,c.filmBoxRef),r=(0,h.pagination)(l.API.getPage(),l.API.getMax()),(0,h.renderPagination)(r,c.filmBoxRef),f.spiner.stop();case 8:case"end":return e.stop()}}),t)})))(),c.formRef.addEventListener("submit",(function(e){return v.apply(this,arguments)}));u=o("eZ7d6"),s=o("2TvXO");var p=o("dyT35"),y=(l=o("dauUa"),c=o("jGMOa"),o("aNvF6"));d=o("6JpON");function m(e){return g.apply(this,arguments)}function g(){return(g=e(u)(e(s).mark((function t(n){var r,i,a,o,u;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.target.classList.contains("js-films-list")){t.next=2;break}return t.abrupt("return");case 2:return c.filmBoxRef.removeEventListener("click",m),t.prev=3,r=Number(n.target.closest(".movie_card").attributes.getNamedItem("js-id").value),t.next=7,l.API.fetchById(r);case 7:if(i=t.sent){t.next=10;break}throw new Error("âŒ Something go wrong, so we can`t load your film");case 10:(a=w(b(i))).show(),document.body.style.overflow="hidden",x(a),k(r,i),(o=document.querySelector(".trailer-btn")).style.display="none",(u=i.videos.results).length>0&&(u.every((function(e){return!e.type.includes("Trailer")}))?o.style.display="none":o.style.display="block"),o.addEventListener("click",(function(){var e=_(T(u.find((function(e){if("Trailer"===e.type)return e}))));e.show(),x(e)})),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(3),e(d).Notify.failure(t.t0.message),console.log(t.t0.message);case 26:case"end":return t.stop()}}),t,null,[[3,22]])})))).apply(this,arguments)}function k(t,n){var r=document.querySelector(".movie__to-watched"),i=document.querySelector(".movie__to-queue");if(!y.storage.signIn)return r.style.display="none",void(i.style.display="none");y.storage.checkWatched(t)&&(r.textContent="Moved to Watched",r.setAttribute("js-disabled","")),y.storage.checkQueue(t)&&(i.textContent="Moved to Queue",i.setAttribute("js-disabled","")),r.addEventListener("click",(function(t){t.preventDefault(),t.target.hasAttribute("js-disabled")?e(d).Notify.warning("ðŸŽ¬ Your film has already sucessfully been added"):(y.storage.addFilmToWatch(n),r.textContent="Moved to Watched",r.setAttribute("js-disabled",""))})),i.addEventListener("click",(function(t){t.preventDefault(),t.target.hasAttribute("js-disabled")?e(d).Notify.warning("ðŸŽ¬ Your film has already sucessfully been added"):(y.storage.addFilmToQueue(n),i.textContent="Moved to Queue",i.setAttribute("js-disabled",""))}))}function w(e){return p.create(e,{onShow:I,onClose:function(){document.body.style.overflow="",c.filmBoxRef.addEventListener("click",m)}})}function b(e){var t=e.poster_path,n=e.original_title,r=e.vote_average,i=e.vote_count,a=e.popularity,o=e.genres,u=e.overview;return'\n  <div class="modal">\n    <button class="button__modal" type="button">\n    </button>\n    <div class="movie__description-card">\n      <div class="div__movie-img" >\n        <img\n          class="movie__img"\n          src="https://image.tmdb.org/t/p/w500'.concat(t,'"\n          alt="info of movie"\n        />\n      </div>\n      <div class="movie__desc">\n        <p class="movie__title">').concat(n,'</p>\n        <table class="movie__characters">\n          <tbody class="character__table">\n            <tr>\n              <td class="character">Vote / Votes</td>\n              <td class="character__item "><span class="vote">').concat(r.toFixed(1),'</span><span class="vote__slash">/</span><span class="vote__grey">').concat(i,'</span></td>\n            </tr>\n            <tr>\n              <td class="character">Popularity</td>\n              <td class="character__item">').concat(a.toFixed(1),'</td>\n            </tr>\n            <tr>\n              <td class="character">Original Title</td>\n              <td class="character__item">').concat(n,'</td>\n            </tr>\n            <tr>\n              <td class="character">Genre</td>\n              <td class="character__item">').concat(0===o.length?"Another genre":o[0].name,'</td>\n            </tr>\n          </tbody>\n        </table>\n        <p class="movie__about">About</p>\n        <p class="movie__about-description">\n        ').concat(u,'\n        </p>\n        <ul class="button__list">\n          <li class="button__item">\n            <button class="movie__to-watched" type="button">\n              add to Watched\n            </button>\n          </li>\n          <li class="button__item">\n            <button class="movie__to-queue" type="button">add to queue</button>\n          </li>\n        </ul>\n        <button class="trailer-btn" type="button">watch trailer</button>\n      </div>\n    </div>\n  </div>')}function x(e){var t=e.element().querySelector("button"),n=function(r){r.preventDefault(),e.close(),t.removeEventListener("click",n)};t.addEventListener("click",n)}function I(e){var t=function(n){if("Escape"!==n.code)return!1;e.close(),document.removeEventListener("keydown",t)};document.addEventListener("keydown",t)}function _(e){return p.create(e,{onShow:I})}function T(e){var t=e.key;return'<iframe\n  width="1141"\n  height="641"\n  src="https://www.youtube.com/embed/'.concat(t,'"\n  frameborder="0"\n  allowfullscreen\n></iframe>\n  <button type="button" class="button__trailer--close"></button>')}c.filmBoxRef.addEventListener("click",m);var E=o("ckB89"),S=o("4mzug"),A=o("ikNsj"),C=o("7SURw"),N=(E=o("ckB89"),S=o("4mzug"),o("k8LMu")),D=o("8sKqN"),R=o("jiX0X"),O={};Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(e){return U(e)};var P=V(o("8dTuY")),L=V(o("417tI")),M=V(o("eSWTR")),F=V(o("gOtiv"));function V(e){return e&&e.__esModule?e:{default:e}}function U(e){var t="function"==typeof Map?new Map:void 0;return U=function(e){if(null===e||!L.default(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return P.default(e,arguments,M.default(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),F.default(n,e)},U(e)}var q,B,j,G=o("brQQZ"),K=q={};function z(){throw new Error("setTimeout has not been defined")}function W(){throw new Error("clearTimeout has not been defined")}function H(e){if(B===setTimeout)return setTimeout(e,0);if((B===z||!B)&&setTimeout)return B=setTimeout,setTimeout(e,0);try{return B(e,0)}catch(t){try{return B.call(null,e,0)}catch(t){return B.call(this,e,0)}}}!function(){try{B="function"==typeof setTimeout?setTimeout:z}catch(e){B=z}try{j="function"==typeof clearTimeout?clearTimeout:W}catch(e){j=W}}();var Q,Y=[],X=!1,J=-1;function Z(){X&&Q&&(X=!1,Q.length?Y=Q.concat(Y):J=-1,Y.length&&$())}function $(){if(!X){var e=H(Z);X=!0;for(var t=Y.length;t;){for(Q=Y,Y=[];++J<t;)Q&&Q[J].run();J=-1,t=Y.length}Q=null,X=!1,function(e){if(j===clearTimeout)return clearTimeout(e);if((j===W||!j)&&clearTimeout)return j=clearTimeout,clearTimeout(e);try{j(e)}catch(t){try{return j.call(null,e)}catch(t){return j.call(this,e)}}}(e)}}function ee(e,t){this.fun=e,this.array=t}function te(){}K.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Y.push(new ee(e,t)),1!==Y.length||X||H($)},ee.prototype.run=function(){this.fun.apply(null,this.array)},K.title="browser",K.browser=!0,K.env={},K.argv=[],K.version="",K.versions={},K.on=te,K.addListener=te,K.once=te,K.off=te,K.removeListener=te,K.removeAllListeners=te,K.emit=te,K.prependListener=te,K.prependOnceListener=te,K.listeners=function(e){return[]},K.binding=function(e){throw new Error("process.binding is not supported")},K.cwd=function(){return"/"},K.chdir=function(e){throw new Error("process.chdir is not supported")},K.umask=function(){return 0};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ne=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},re={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,u=o?e[i+1]:0,s=i+2<e.length,c=s?e[i+2]:0,l=a>>2,h=(3&a)<<4|u>>4,f=(15&u)<<2|c>>6,d=63&c;s||(d=64,o||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(ne(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var u=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&u)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,u=++i<e.length?n[e.charAt(i)]:64,s=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==u||null==s)throw Error();var c=a<<2|o>>4;if(r.push(c),64!==u){var l=o<<4&240|u>>2;if(r.push(l),64!==s){var h=u<<6&192|s;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},ie=function(e){return function(e){var t=ne(e);return re.encodeByteArray(t,!0)}(e).replace(/\./g,"")},ae=function(e){try{return re.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oe(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=oe(e[n],t[n]));return e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ue=function(){
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},se=function(){try{return ue()||function(){if(void 0!==q&&void 0!==q.env);}()||function(){if("undefined"!=typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}var t=e&&ae(e[1]);return t&&JSON.parse(t)}}()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},ce=function(){var e;return null===(e=se())||void 0===e?void 0:e.config},le=function(e){var t;return null===(t=se())||void 0===t?void 0:t["_".concat(e)]},he=function(){"use strict";function t(){var n=this;e(E)(this,t),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))}return e(S)(t,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function fe(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[ie(JSON.stringify({alg:"none",type:"JWT"})),ie(JSON.stringify(a)),""].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ve(){var e,n=null===(e=se())||void 0===e?void 0:e.forceEnvironment;if("node"===n)return!0;if("browser"===n)return!1;try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}}function pe(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function ye(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function me(){var e=de();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function ge(){try{return"object"==typeof indexedDB}catch(e){return!1}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ke=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o;return e(E)(this,r),(o=n.call(this,i)).code=t,o.customData=a,o.name="FirebaseError",Object.setPrototypeOf(e(C)(o),r.prototype),Error.captureStackTrace&&Error.captureStackTrace(e(C)(o),we.prototype.create),o}return r}(e(O)(Error)),we=function(){"use strict";function t(n,r,i){e(E)(this,t),this.service=n,this.serviceName=r,this.errors=i}return e(S)(t,[{key:"create",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0]||{},a="".concat(this.service,"/").concat(e),o=this.errors[e],u=o?be(o,i):"Error",s="".concat(this.serviceName,": ").concat(u," (").concat(a,")."),c=new ke(a,s,i);return c}}]),t}();function be(e,t){return e.replace(xe,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var xe=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ie(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _e(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Te(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t),i=!0,a=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;if(!r.includes(c))return!1;var l=e[c],h=t[c];if(Ee(l)&&Ee(h)){if(!Te(l,h))return!1}else if(l!==h)return!1}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}var f=!0,d=!1,v=void 0;try{for(var p,y=r[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){var m=p.value;if(!n.includes(m))return!1}}catch(e){d=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw v}}return!0}function Ee(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Se(t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=function(t,r){var i=e(D)(r.value,2),a=i[0],o=i[1];Array.isArray(o)?o.forEach((function(e){n.push(encodeURIComponent(a)+"="+encodeURIComponent(e))})):n.push(encodeURIComponent(a)+"="+encodeURIComponent(o))},s=Object.entries(t)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u(0,o)}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n.length?"&"+n.join("&"):""}function Ae(t){var n={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var r=e(D)(t.split("="),2),i=r[0],a=r[1];n[decodeURIComponent(i)]=decodeURIComponent(a)}})),n}function Ce(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(e,t){var n=new De(e,t);return n.subscribe.bind(n)}var De=function(){"use strict";function t(n,r){var i=this;e(E)(this,t),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then((function(){n(i)})).catch((function(e){i.error(e)}))}return e(S)(t,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(u in e&&"function"==typeof e[u])return!0}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=Re),void 0===r.error&&(r.error=Re),void 0===r.complete&&(r.complete=Re);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),t}();function Re(){}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Oe(e){return e&&e._delegate?e._delegate:e}u=o("eZ7d6"),E=o("ckB89"),S=o("4mzug"),D=o("8sKqN"),R=o("jiX0X"),s=o("2TvXO");var Pe=function(){"use strict";function t(n,r,i){e(E)(this,t),this.name=n,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e(S)(t,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),t}(),Le="[DEFAULT]",Me=function(){"use strict";function t(n,r){e(E)(this,t),this.name=n,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e(S)(t,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new he;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService({instanceIdentifier:Le})}catch(e){}var n=!0,r=!1,i=void 0;try{for(var a,o=this.instancesDeferred.entries()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=e(D)(a.value,2),s=u[0],c=u[1],l=this.normalizeInstanceIdentifier(s);try{var h=this.getOrInitializeService({instanceIdentifier:l});c.resolve(h)}catch(e){}}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Array.from(t.instances.values()),n.next=3,Promise.all(e(R)(r.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))).concat(e(R)(r.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return n.stop()}}),n)})))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.options,r=void 0===n?{}:n,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error("".concat(this.name,"(").concat(i,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a=this.getOrInitializeService({instanceIdentifier:i,options:r}),o=!0,u=!1,s=void 0;try{for(var c,l=this.instancesDeferred.entries()[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=e(D)(c.value,2),f=h[0],d=h[1],v=this.normalizeInstanceIdentifier(f);i===v&&d.resolve(a)}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;try{s(e,t)}catch(e){}}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===Le?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(e){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le;return this.component?this.component.multipleInstances?e:Le:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),t}();var Fe=function(){"use strict";function t(n){e(E)(this,t),this.name=n,this.providers=new Map}return e(S)(t,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Me(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),t}(),Ve={};n(Ve,"_DEFAULT_ENTRY_NAME",(function(){return bt})),n(Ve,"_apps",(function(){return It})),n(Ve,"_components",(function(){return _t})),n(Ve,"_addComponent",(function(){return Tt})),n(Ve,"_addOrOverwriteComponent",(function(){return Et})),n(Ve,"_registerComponent",(function(){return St})),n(Ve,"_getProvider",(function(){return At})),n(Ve,"_removeServiceInstance",(function(){return Ct})),n(Ve,"_clearComponents",(function(){return Nt})),n(Ve,"SDK_VERSION",(function(){return Pt})),n(Ve,"initializeApp",(function(){return Lt})),n(Ve,"getApp",(function(){return Mt})),n(Ve,"getApps",(function(){return Ft})),n(Ve,"deleteApp",(function(){return Vt})),n(Ve,"registerVersion",(function(){return qt})),n(Ve,"onLog",(function(){return Bt})),n(Ve,"setLogLevel",(function(){return jt})),n(Ve,"FirebaseError",(function(){return ke}));u=o("eZ7d6"),E=o("ckB89"),S=o("4mzug"),A=o("ikNsj"),R=o("jiX0X"),s=o("2TvXO"),E=o("ckB89"),S=o("4mzug"),A=o("ikNsj"),R=o("jiX0X");var Ue,qe,Be=[];(qe=Ue||(Ue={}))[qe.DEBUG=0]="DEBUG",qe[qe.VERBOSE=1]="VERBOSE",qe[qe.INFO=2]="INFO",qe[qe.WARN=3]="WARN",qe[qe.ERROR=4]="ERROR",qe[qe.SILENT=5]="SILENT";var je,Ge={debug:Ue.DEBUG,verbose:Ue.VERBOSE,info:Ue.INFO,warn:Ue.WARN,error:Ue.ERROR,silent:Ue.SILENT},Ke=Ue.INFO,ze=(je={},e(A)(je,Ue.DEBUG,"log"),e(A)(je,Ue.VERBOSE,"log"),e(A)(je,Ue.INFO,"info"),e(A)(je,Ue.WARN,"warn"),e(A)(je,Ue.ERROR,"error"),je),We=function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];var o;if(!(n<t.logLevel)){var u=(new Date).toISOString(),s=ze[n];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(n,")"));(o=console)[s].apply(o,["[".concat(u,"]  ").concat(t.name,":")].concat(e(R)(i)))}},He=function(){"use strict";function t(n){e(E)(this,t),this.name=n,this._logLevel=Ke,this._logHandler=We,this._userLogHandler=null,Be.push(this)}return e(S)(t,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in Ue))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?Ge[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ue.DEBUG].concat(e(R)(n))),this._logHandler.apply(this,[this,Ue.DEBUG].concat(e(R)(n)))}},{key:"log",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ue.VERBOSE].concat(e(R)(n))),this._logHandler.apply(this,[this,Ue.VERBOSE].concat(e(R)(n)))}},{key:"info",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ue.INFO].concat(e(R)(n))),this._logHandler.apply(this,[this,Ue.INFO].concat(e(R)(n)))}},{key:"warn",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ue.WARN].concat(e(R)(n))),this._logHandler.apply(this,[this,Ue.WARN].concat(e(R)(n)))}},{key:"error",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ue.ERROR].concat(e(R)(n))),this._logHandler.apply(this,[this,Ue.ERROR].concat(e(R)(n)))}}]),t}();function Qe(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=Be[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=null;t&&t.level&&(s=Ge[t.level]),u.userLogHandler=null===e?null:function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];var o=i.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");n>=(null!=s?s:t.logLevel)&&e({level:Ue[n].toLowerCase(),message:o,args:i,type:t.name})}}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}u=o("eZ7d6");var Ye={};Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.default=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Je.default(e,t,n[t])}))}return e};var Xe,Je=(Xe=o("ikNsj"))&&Xe.__esModule?Xe:{default:Xe};var Ze,$e;R=o("jiX0X"),s=o("2TvXO"),R=o("jiX0X");var et=new WeakMap,tt=new WeakMap,nt=new WeakMap,rt=new WeakMap,it=new WeakMap;var at={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return tt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||nt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return st(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function ot(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?($e||($e=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(ct(this),n),st(et.get(this))}:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return st(t.apply(ct(this),n))}:function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];var o,u=(o=t).call.apply(o,[ct(this),n].concat(e(R)(i)));return nt.set(u,n.sort?n.sort():[n]),st(u)}}function ut(e){return"function"==typeof e?ot(e):(e instanceof IDBTransaction&&function(e){if(!tt.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));tt.set(e,t)}}(e),t=e,(Ze||(Ze=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,at):e);var t}function st(e){if(e instanceof IDBRequest)return t=e,(n=new Promise((function(e,n){var r=function(){t.removeEventListener("success",i),t.removeEventListener("error",a)},i=function(){e(st(t.result)),r()},a=function(){n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",a)}))).then((function(e){e instanceof IDBCursor&&et.set(e,t)})).catch((function(){})),it.set(n,t),n;var t,n;if(rt.has(e))return rt.get(e);var r=ut(e);return r!==e&&(rt.set(e,r),it.set(r,e)),r}var ct=function(e){return it.get(e)};function lt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,u=indexedDB.open(e,t),s=st(u);return i&&u.addEventListener("upgradeneeded",(function(e){i(st(u.result),e.oldVersion,e.newVersion,st(u.transaction))})),r&&u.addEventListener("blocked",(function(){return r()})),s.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(){return a()}))})).catch((function(){})),s}var ht=["get","getKey","getAll","getAllKeys","count"],ft=["put","add","delete","clear"],dt=new Map;function vt(t,n){if(t instanceof IDBDatabase&&!(n in t)&&"string"==typeof n){if(dt.get(n))return dt.get(n);var r=n.replace(/FromIndex$/,""),i=n!==r,a=ft.includes(r);if(r in(i?IDBIndex:IDBObjectStore).prototype&&(a||ht.includes(r))){var o,c=(o=e(u)(e(s).mark((function t(n){var o,u,c,l,h,f,d=arguments;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o=d.length,u=new Array(o>1?o-1:0),c=1;c<o;c++)u[c-1]=d[c];return h=this.transaction(n,a?"readwrite":"readonly"),f=h.store,i&&(f=f.index(u.shift())),t.next=7,Promise.all([(l=f)[r].apply(l,e(R)(u)),a&&h.done]);case 7:return t.abrupt("return",t.sent[0]);case 8:case"end":return t.stop()}}),t,this)}))),function(e){return o.apply(this,arguments)});return dt.set(n,c),c}}}at=function(t){return e(Ye)({},t,{get:function(e,n,r){return vt(e,n)||t.get(e,n,r)},has:function(e,n){return!!vt(e,n)||t.has(e,n)}})}(at);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pt=function(){"use strict";function t(n){e(E)(this,t),this.container=n}return e(S)(t,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),t}();var yt,mt,gt="@firebase/app",kt="0.9.3",wt=new He("@firebase/app"),bt="[DEFAULT]",xt=(yt={},e(A)(yt,gt,"fire-core"),e(A)(yt,"@firebase/app-compat","fire-core-compat"),e(A)(yt,"@firebase/analytics","fire-analytics"),e(A)(yt,"@firebase/analytics-compat","fire-analytics-compat"),e(A)(yt,"@firebase/app-check","fire-app-check"),e(A)(yt,"@firebase/app-check-compat","fire-app-check-compat"),e(A)(yt,"@firebase/auth","fire-auth"),e(A)(yt,"@firebase/auth-compat","fire-auth-compat"),e(A)(yt,"@firebase/database","fire-rtdb"),e(A)(yt,"@firebase/database-compat","fire-rtdb-compat"),e(A)(yt,"@firebase/functions","fire-fn"),e(A)(yt,"@firebase/functions-compat","fire-fn-compat"),e(A)(yt,"@firebase/installations","fire-iid"),e(A)(yt,"@firebase/installations-compat","fire-iid-compat"),e(A)(yt,"@firebase/messaging","fire-fcm"),e(A)(yt,"@firebase/messaging-compat","fire-fcm-compat"),e(A)(yt,"@firebase/performance","fire-perf"),e(A)(yt,"@firebase/performance-compat","fire-perf-compat"),e(A)(yt,"@firebase/remote-config","fire-rc"),e(A)(yt,"@firebase/remote-config-compat","fire-rc-compat"),e(A)(yt,"@firebase/storage","fire-gcs"),e(A)(yt,"@firebase/storage-compat","fire-gcs-compat"),e(A)(yt,"@firebase/firestore","fire-fst"),e(A)(yt,"@firebase/firestore-compat","fire-fst-compat"),e(A)(yt,"fire-js","fire-js"),e(A)(yt,"firebase","fire-js-all"),yt),It=new Map,_t=new Map;function Tt(e,t){try{e.container.addComponent(t)}catch(n){wt.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Et(e,t){e.container.addOrOverwriteComponent(t)}function St(e){var t=e.name;if(_t.has(t))return wt.debug("There were multiple attempts to register component ".concat(t,".")),!1;_t.set(t,e);var n=!0,r=!1,i=void 0;try{for(var a,o=It.values()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){Tt(a.value,e)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}function At(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ct(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bt;At(e,t).clearInstance(n)}function Nt(){_t.clear()}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Dt=(mt={},e(A)(mt,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),e(A)(mt,"bad-app-name","Illegal App name: '{$appName}"),e(A)(mt,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),e(A)(mt,"app-deleted","Firebase App named '{$appName}' already deleted"),e(A)(mt,"no-options","Need to provide options, when not being deployed to hosting via source."),e(A)(mt,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),e(A)(mt,"invalid-log-argument","First argument to `onLog` must be null or a function."),e(A)(mt,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),e(A)(mt,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),e(A)(mt,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),e(A)(mt,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),mt),Rt=new we("app","Firebase",Dt),Ot=function(){"use strict";function t(n,r,i){var a=this;e(E)(this,t),this._isDeleted=!1,this._options=Object.assign({},n),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Pe("app",(function(){return a}),"PUBLIC"))}return e(S)(t,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Rt.create("app-deleted",{appName:this._name})}}]),t}(),Pt="9.17.1";function Lt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!=typeof t){var r=t;t={name:r}}var i=Object.assign({name:bt,automaticDataCollectionEnabled:!1},t),a=i.name;if("string"!=typeof a||!a)throw Rt.create("bad-app-name",{appName:String(a)});if(n||(n=ce()),!n)throw Rt.create("no-options");var o=It.get(a);if(o){if(Te(n,o.options)&&Te(i,o.config))return o;throw Rt.create("duplicate-app",{appName:a})}var u=new Fe(a),s=!0,c=!1,l=void 0;try{for(var h,f=_t.values()[Symbol.iterator]();!(s=(h=f.next()).done);s=!0){var d=h.value;u.addComponent(d)}}catch(e){c=!0,l=e}finally{try{s||null==f.return||f.return()}finally{if(c)throw l}}var v=new Ot(n,i,u);return It.set(a,v),v}function Mt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bt,t=It.get(e);if(!t&&e===bt)return Lt();if(!t)throw Rt.create("no-app",{appName:e});return t}function Ft(){return Array.from(It.values())}function Vt(e){return Ut.apply(this,arguments)}function Ut(){return(Ut=e(u)(e(s).mark((function t(n){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.name,!It.has(r)){e.next=6;break}return It.delete(r),e.next=5,Promise.all(n.container.getProviders().map((function(e){return e.delete()})));case 5:n.isDeleted=!0;case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function qt(e,t,n){var r,i=null!==(r=xt[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var u=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&u.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&u.push("and"),o&&u.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void wt.warn(u.join(" "))}St(new Pe("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}function Bt(e,t){if(null!==e&&"function"!=typeof e)throw Rt.create("invalid-log-argument");Qe(e,t)}function jt(e){var t;t=e,Be.forEach((function(e){e.setLogLevel(t)}))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gt="firebase-heartbeat-store",Kt=null;function zt(){return Kt||(Kt=lt("firebase-heartbeat-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(Gt)}}).catch((function(e){throw Rt.create("idb-open",{originalErrorMessage:e.message})}))),Kt}function Wt(e){return Ht.apply(this,arguments)}function Ht(){return(Ht=e(u)(e(s).mark((function t(n){var r,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,zt();case 3:return r=e.sent,e.abrupt("return",r.transaction(Gt).objectStore(Gt).get(Xt(n)));case 7:e.prev=7,e.t0=e.catch(0),e.t0 instanceof ke?wt.warn(e.t0.message):(i=Rt.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),wt.warn(i.message));case 10:case"end":return e.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function Qt(e,t){return Yt.apply(this,arguments)}function Yt(){return(Yt=e(u)(e(s).mark((function t(n,r){var i,a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,zt();case 3:return i=e.sent,a=i.transaction(Gt,"readwrite"),o=a.objectStore(Gt),e.next=8,o.put(r,Xt(n));case 8:return e.abrupt("return",a.done);case 11:e.prev=11,e.t0=e.catch(0),e.t0 instanceof ke?wt.warn(e.t0.message):(u=Rt.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),wt.warn(u.message));case 14:case"end":return e.stop()}}),t,null,[[0,11]])})))).apply(this,arguments)}function Xt(e){return"".concat(e.name,"!").concat(e.options.appId)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt=function(){"use strict";function t(n){var r=this;e(E)(this,t),this.container=n,this._heartbeatsCache=null;var i=this.container.getProvider("app").getImmediate();this._storage=new tn(i),this._heartbeatsCachePromise=this._storage.read().then((function(e){return r._heartbeatsCache=e,e}))}return e(S)(t,[{key:"triggerHeartbeat",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.container.getProvider("platform-logger").getImmediate(),i=r.getPlatformInfoString(),a=Zt(),null!==t._heartbeatsCache){e.next=7;break}return e.next=6,t._heartbeatsCachePromise;case 6:t._heartbeatsCache=e.sent;case 7:if(t._heartbeatsCache.lastSentHeartbeatDate!==a&&!t._heartbeatsCache.heartbeats.some((function(e){return e.date===a}))){e.next=11;break}return e.abrupt("return");case 11:t._heartbeatsCache.heartbeats.push({date:a,agent:i});case 12:return t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",t._storage.overwrite(t._heartbeatsCache));case 14:case"end":return e.stop()}}),n)})))()}},{key:"getHeartbeatsHeader",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i,a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t._heartbeatsCache){e.next=3;break}return e.next=3,t._heartbeatsCachePromise;case 3:if(null!==t._heartbeatsCache&&0!==t._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(r=Zt(),i=$t(t._heartbeatsCache.heartbeats),a=i.heartbeatsToSend,o=i.unsentEntries,u=ie(JSON.stringify({version:2,heartbeats:a})),t._heartbeatsCache.lastSentHeartbeatDate=r,!(o.length>0)){e.next=15;break}return t._heartbeatsCache.heartbeats=o,e.next=13,t._storage.overwrite(t._heartbeatsCache);case 13:e.next=16;break;case 15:t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache);case 16:return e.abrupt("return",u);case 17:case"end":return e.stop()}}),n)})))()}}]),t}();function Zt(){return(new Date).toISOString().substring(0,10)}function $t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=[],r=e.slice(),i=!0,a=!1,o=void 0;try{for(var u,s=function(e,i){var a=i.value,o=n.find((function(e){return e.agent===a.agent}));if(o){if(o.dates.push(a.date),nn(n)>t)return o.dates.pop(),"break"}else if(n.push({agent:a.agent,dates:[a.date]}),nn(n)>t)return n.pop(),"break";r=r.slice(1)},c=e[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var l=s(c,u);if("break"===l)break}}catch(e){a=!0,o=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}return{heartbeatsToSend:n,unsentEntries:r}}var en,tn=function(){"use strict";function t(n){e(E)(this,t),this.app=n,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return e(S)(t,[{key:"runIndexedDBEnvironmentCheck",value:function(){return e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ge()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),t)})))()}},{key:"read",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,Wt(t.app);case 9:return r=e.sent,e.abrupt("return",r||{heartbeats:[]});case 11:case"end":return e.stop()}}),n)})))()}},{key:"overwrite",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,n._canUseIndexedDBPromise;case 3:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,n.read();case 10:return a=e.sent,e.abrupt("return",Qt(n.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:a.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 12:case"end":return e.stop()}}),r)})))()}},{key:"add",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a;return e(s).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=3,n._canUseIndexedDBPromise;case 3:if(r.sent){r.next=8;break}return r.abrupt("return");case 8:return r.next=10,n.read();case 10:return a=r.sent,r.abrupt("return",Qt(n.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:a.lastSentHeartbeatDate,heartbeats:e(R)(a.heartbeats).concat(e(R)(t.heartbeats))}));case 12:case"end":return r.stop()}}),r)})))()}}]),t}();function nn(e){return ie(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */en="",St(new Pe("platform-logger",(function(e){return new pt(e)}),"PRIVATE")),St(new Pe("heartbeat",(function(e){return new Jt(e)}),"PRIVATE")),qt(gt,kt,en),qt(gt,kt,"esm2017"),qt("fire-js","");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var rn,an=function(){"use strict";function t(n,r){var i=this;e(E)(this,t),this._delegate=n,this.firebase=r,Tt(n,new Pe("app-compat",(function(){return i}),"PUBLIC")),this.container=n.container}return e(S)(t,[{key:"automaticDataCollectionEnabled",get:function(){return this._delegate.automaticDataCollectionEnabled},set:function(e){this._delegate.automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this._delegate.name}},{key:"options",get:function(){return this._delegate.options}},{key:"delete",value:function(){var e=this;return new Promise((function(t){e._delegate.checkDestroyed(),t()})).then((function(){return e.firebase.INTERNAL.removeApp(e.name),Vt(e._delegate)}))}},{key:"_getService",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bt;this._delegate.checkDestroyed();var r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(t=r.getComponent())||void 0===t?void 0:t.instantiationMode)||r.initialize(),r.getImmediate({identifier:n})}},{key:"_removeServiceInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bt;this._delegate.container.getProvider(e).clearInstance(t)}},{key:"_addComponent",value:function(e){Tt(this._delegate,e)}},{key:"_addOrOverwriteComponent",value:function(e){Et(this._delegate,e)}},{key:"toJSON",value:function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}]),t}(),on=(rn={},e(A)(rn,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),e(A)(rn,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),rn),un=new we("app-compat","Firebase",on);var sn=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function e(){var t=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){var t={},n={__esModule:!0,initializeApp:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Ve.initializeApp(r,i);if(Ie(t,a.name))return t[a.name];var o=new e(a,n);return t[a.name]=o,o},app:r,registerVersion:Ve.registerVersion,setLogLevel:Ve.setLogLevel,onLog:Ve.onLog,apps:null,SDK_VERSION:Ve.SDK_VERSION,INTERNAL:{registerComponent:function(t){var i=t.name,a=i.replace("-compat","");if(Ve._registerComponent(t)&&"PUBLIC"===t.type){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r();if("function"!=typeof e[a])throw un.create("invalid-app-argument",{appName:i});return e[a]()};void 0!==t.serviceProps&&oe(o,t.serviceProps),n[a]=o,e.prototype[a]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this._getService.bind(this,i).apply(this,t.multipleInstances?n:[])}}return"PUBLIC"===t.type?n[a]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:Ve}};function r(e){if(e=e||Ve._DEFAULT_ENTRY_NAME,!Ie(t,e))throw un.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),r.App=e,n}(an);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){oe(t,e)},createSubscribe:Ne,ErrorFactory:we,deepExtend:oe}),t}(),cn=new He("@firebase/app-compat");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){cn.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var ln=self.firebase.SDK_VERSION;ln&&ln.indexOf("LITE")>=0&&cn.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var hn=sn;!
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){qt("@firebase/app-compat","0.2.3",e)}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
hn.registerVersion("firebase","9.17.1","app-compat");u=o("eZ7d6"),E=o("ckB89"),S=o("4mzug"),s=o("2TvXO"),u=o("eZ7d6"),E=o("ckB89"),S=o("4mzug");var fn={};Object.defineProperty(fn,"__esModule",{value:!0}),fn.default=function(e,t,n){return vn(e,t,n)};var dn=function(e){return e&&e.__esModule?e:{default:e}}(o("lhF45"));function vn(e,t,n){return(vn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=dn.default(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}})(e,t,n)}var pn=o("eSWTR"),yn=(N=o("k8LMu"),{});Object.defineProperty(yn,"__esModule",{value:!0}),yn.default=function(e){return mn.default(e)||gn.default(e)||wn.default(e,i)||kn.default()};var mn=bn(o("ccXXu")),gn=bn(o("4LjYB")),kn=bn(o("aoAno")),wn=bn(o("gqnvV"));function bn(e){return e&&e.__esModule?e:{default:e}}G=o("brQQZ"),s=o("2TvXO"),C=o("7SURw"),u=o("eZ7d6"),E=o("ckB89"),S=o("4mzug"),A=o("ikNsj"),pn=o("eSWTR"),N=o("k8LMu"),D=o("8sKqN"),R=o("jiX0X"),G=o("brQQZ"),s=o("2TvXO");function xn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var In="facebook.com",_n="github.com",Tn="google.com",En="password",Sn="twitter.com",An="EMAIL_SIGNIN",Cn="PASSWORD_RESET",Nn="RECOVER_EMAIL",Dn="REVERT_SECOND_FACTOR_ADDITION",Rn="VERIFY_AND_CHANGE_EMAIL",On="VERIFY_EMAIL";function Pn(){return e(A)({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var Ln=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){var t;return t={},e(A)(t,"admin-restricted-operation","This operation is restricted to administrators only."),e(A)(t,"argument-error",""),e(A)(t,"app-not-authorized","This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console."),e(A)(t,"app-not-installed","The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device."),e(A)(t,"captcha-check-failed","The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains."),e(A)(t,"code-expired","The SMS code has expired. Please re-send the verification code to try again."),e(A)(t,"cordova-not-ready","Cordova framework is not ready."),e(A)(t,"cors-unsupported","This browser is not supported."),e(A)(t,"credential-already-in-use","This credential is already associated with a different user account."),e(A)(t,"custom-token-mismatch","The custom token corresponds to a different audience."),e(A)(t,"requires-recent-login","This operation is sensitive and requires recent authentication. Log in again before retrying this request."),e(A)(t,"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."),e(A)(t,"dynamic-link-not-activated","Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions."),e(A)(t,"email-change-needs-verification","Multi-factor users must always have a verified email."),e(A)(t,"email-already-in-use","The email address is already in use by another account."),e(A)(t,"emulator-config-failed",'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.'),e(A)(t,"expired-action-code","The action code has expired."),e(A)(t,"cancelled-popup-request","This operation has been cancelled due to another conflicting popup being opened."),e(A)(t,"internal-error","An internal AuthError has occurred."),e(A)(t,"invalid-app-credential","The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired."),e(A)(t,"invalid-app-id","The mobile app identifier is not registed for the current project."),e(A)(t,"invalid-user-token","This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key."),e(A)(t,"invalid-auth-event","An internal AuthError has occurred."),e(A)(t,"invalid-verification-code","The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user."),e(A)(t,"invalid-continue-uri","The continue URL provided in the request is invalid."),e(A)(t,"invalid-cordova-configuration","The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme."),e(A)(t,"invalid-custom-token","The custom token format is incorrect. Please check the documentation."),e(A)(t,"invalid-dynamic-link-domain","The provided dynamic link domain is not configured or authorized for the current project."),e(A)(t,"invalid-email","The email address is badly formatted."),e(A)(t,"invalid-emulator-scheme","Emulator URL must start with a valid scheme (http:// or https://)."),e(A)(t,"invalid-api-key","Your API key is invalid, please check you have copied it correctly."),e(A)(t,"invalid-cert-hash","The SHA-1 certificate hash provided is invalid."),e(A)(t,"invalid-credential","The supplied auth credential is malformed or has expired."),e(A)(t,"invalid-message-payload","The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console."),e(A)(t,"invalid-multi-factor-session","The request does not contain a valid proof of first factor successful sign-in."),e(A)(t,"invalid-oauth-provider","EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers."),e(A)(t,"invalid-oauth-client-id","The OAuth client ID provided is either invalid or does not match the specified API key."),e(A)(t,"unauthorized-domain","This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console."),e(A)(t,"invalid-action-code","The action code is invalid. This can happen if the code is malformed, expired, or has already been used."),e(A)(t,"wrong-password","The password is invalid or the user does not have a password."),e(A)(t,"invalid-persistence-type","The specified persistence type is invalid. It can only be local, session or none."),e(A)(t,"invalid-phone-number","The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code]."),e(A)(t,"invalid-provider-id","The specified provider ID is invalid."),e(A)(t,"invalid-recipient-email","The email corresponding to this action failed to send as the provided recipient email address is invalid."),e(A)(t,"invalid-sender","The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console."),e(A)(t,"invalid-verification-id","The verification ID used to create the phone auth credential is invalid."),e(A)(t,"invalid-tenant-id","The Auth instance's tenant ID is invalid."),e(A)(t,"login-blocked","Login blocked by user-provided method: {$originalMessage}"),e(A)(t,"missing-android-pkg-name","An Android Package Name must be provided if the Android App is required to be installed."),e(A)(t,"auth-domain-config-required","Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console."),e(A)(t,"missing-app-credential","The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided."),e(A)(t,"missing-verification-code","The phone auth credential was created with an empty SMS verification code."),e(A)(t,"missing-continue-uri","A continue URL must be provided in the request."),e(A)(t,"missing-iframe-start","An internal AuthError has occurred."),e(A)(t,"missing-ios-bundle-id","An iOS Bundle ID must be provided if an App Store ID is provided."),e(A)(t,"missing-or-invalid-nonce","The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload."),e(A)(t,"missing-multi-factor-info","No second factor identifier is provided."),e(A)(t,"missing-multi-factor-session","The request is missing proof of first factor successful sign-in."),e(A)(t,"missing-phone-number","To send verification codes, provide a phone number for the recipient."),e(A)(t,"missing-verification-id","The phone auth credential was created with an empty verification ID."),e(A)(t,"app-deleted","This instance of FirebaseApp has been deleted."),e(A)(t,"multi-factor-info-not-found","The user does not have a second factor matching the identifier provided."),e(A)(t,"multi-factor-auth-required","Proof of ownership of a second factor is required to complete sign-in."),e(A)(t,"account-exists-with-different-credential","An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address."),e(A)(t,"network-request-failed","A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred."),e(A)(t,"no-auth-event","An internal AuthError has occurred."),e(A)(t,"no-such-provider","User was not linked to an account with the given provider."),e(A)(t,"null-user","A null user object was provided as the argument for an operation which requires a non-null user object."),e(A)(t,"operation-not-allowed","The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section."),e(A)(t,"operation-not-supported-in-this-environment",'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.'),e(A)(t,"popup-blocked","Unable to establish a connection with the popup. It may have been blocked by the browser."),e(A)(t,"popup-closed-by-user","The popup has been closed by the user before finalizing the operation."),e(A)(t,"provider-already-linked","User can only be linked to one identity for the given provider."),e(A)(t,"quota-exceeded","The project's quota for this operation has been exceeded."),e(A)(t,"redirect-cancelled-by-user","The redirect operation has been cancelled by the user before finalizing."),e(A)(t,"redirect-operation-pending","A redirect sign-in operation is already pending."),e(A)(t,"rejected-credential","The request contains malformed or mismatching credentials."),e(A)(t,"second-factor-already-in-use","The second factor is already enrolled on this account."),e(A)(t,"maximum-second-factor-count-exceeded","The maximum allowed number of second factors on a user has been exceeded."),e(A)(t,"tenant-id-mismatch","The provided tenant ID does not match the Auth instance's tenant ID"),e(A)(t,"timeout","The operation has timed out."),e(A)(t,"user-token-expired","The user's credential is no longer valid. The user must sign in again."),e(A)(t,"too-many-requests","We have blocked all requests from this device due to unusual activity. Try again later."),e(A)(t,"unauthorized-continue-uri","The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console."),e(A)(t,"unsupported-first-factor","Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor."),e(A)(t,"unsupported-persistence-type","The current environment does not support the specified persistence type."),e(A)(t,"unsupported-tenant-operation","This operation is not supported in a multi-tenant context."),e(A)(t,"unverified-email","The operation requires a verified email."),e(A)(t,"user-cancelled","The user did not grant your application the permissions it requested."),e(A)(t,"user-not-found","There is no user record corresponding to this identifier. The user may have been deleted."),e(A)(t,"user-disabled","The user account has been disabled by an administrator."),e(A)(t,"user-mismatch","The supplied credentials do not correspond to the previously signed in user."),e(A)(t,"user-signed-out",""),e(A)(t,"weak-password","The password must be 6 characters long or more."),e(A)(t,"web-storage-unsupported","This browser is not supported or 3rd party cookies and data may be disabled."),e(A)(t,"already-initialized","initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."),t},Mn=Pn,Fn=new we("auth","Firebase",Pn()),Vn=new He("@firebase/auth");function Un(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a;Vn.logLevel<=Ue.ERROR&&(a=Vn).error.apply(a,["Auth (".concat(Pt,"): ").concat(t)].concat(e(R)(r)))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];throw Kn.apply(void 0,[t].concat(e(R)(r)))}function Bn(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Kn.apply(void 0,[t].concat(e(R)(r)))}function jn(t,n,r){var i=Object.assign(Object.assign({},Mn()),e(A)({},n,r));return new we("auth","Firebase",i).create(n,{appName:t.name})}function Gn(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&qn(e,"argument-error"),jn(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function Kn(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a;if("string"!=typeof t){var o,u=r[0],s=e(R)(r.slice(1));return s[0]&&(s[0].appName=t.name),(o=t._errorFactory).create.apply(o,[u].concat(e(R)(s)))}return(a=Fn).create.apply(a,[t].concat(e(R)(r)))}function zn(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(!t)throw Kn.apply(void 0,[n].concat(e(R)(i)))}function Wn(e){var t="INTERNAL ASSERTION FAILED: "+e;throw Un(t),new Error(t)}function Hn(e,t){e||Wn(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qn=new Map;function Yn(e){Hn(e instanceof Function,"Expected a class definition");var t=Qn.get(e);return t?(Hn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Qn.set(e,t),t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Xn(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Jn(){return"http:"===Zn()||"https:"===Zn()}function Zn(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var $n=function(){"use strict";function t(n,r){e(E)(this,t),this.shortDelay=n,this.longDelay=r,Hn(r>n,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(de())||ye()}return e(S)(t,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Jn()||pe()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(e,t){Hn(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tr,nr=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Wn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Wn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Wn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),t}(),rr=(tr={},e(A)(tr,"CREDENTIAL_MISMATCH","custom-token-mismatch"),e(A)(tr,"MISSING_CUSTOM_TOKEN","internal-error"),e(A)(tr,"INVALID_IDENTIFIER","invalid-email"),e(A)(tr,"MISSING_CONTINUE_URI","internal-error"),e(A)(tr,"INVALID_PASSWORD","wrong-password"),e(A)(tr,"MISSING_PASSWORD","internal-error"),e(A)(tr,"EMAIL_EXISTS","email-already-in-use"),e(A)(tr,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),e(A)(tr,"INVALID_IDP_RESPONSE","invalid-credential"),e(A)(tr,"INVALID_PENDING_TOKEN","invalid-credential"),e(A)(tr,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),e(A)(tr,"MISSING_REQ_TYPE","internal-error"),e(A)(tr,"EMAIL_NOT_FOUND","user-not-found"),e(A)(tr,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),e(A)(tr,"EXPIRED_OOB_CODE","expired-action-code"),e(A)(tr,"INVALID_OOB_CODE","invalid-action-code"),e(A)(tr,"MISSING_OOB_CODE","internal-error"),e(A)(tr,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),e(A)(tr,"INVALID_ID_TOKEN","invalid-user-token"),e(A)(tr,"TOKEN_EXPIRED","user-token-expired"),e(A)(tr,"USER_NOT_FOUND","user-token-expired"),e(A)(tr,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),e(A)(tr,"INVALID_CODE","invalid-verification-code"),e(A)(tr,"INVALID_SESSION_INFO","invalid-verification-id"),e(A)(tr,"INVALID_TEMPORARY_PROOF","invalid-credential"),e(A)(tr,"MISSING_SESSION_INFO","missing-verification-id"),e(A)(tr,"SESSION_EXPIRED","code-expired"),e(A)(tr,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),e(A)(tr,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),e(A)(tr,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),e(A)(tr,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),e(A)(tr,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),e(A)(tr,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),e(A)(tr,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),e(A)(tr,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),e(A)(tr,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),e(A)(tr,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),e(A)(tr,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),tr),ir=new $n(3e4,6e4);function ar(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function or(e,t,n,r){return ur.apply(this,arguments)}function ur(){return ur=e(u)(e(s).mark((function t(n,r,i,a){var o,c=arguments;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=c.length>4&&void 0!==c[4]?c[4]:{},t.abrupt("return",sr(n,o,e(u)(e(s).mark((function t(){var o,u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={},u={},a&&("GET"===r?u=a:o={body:JSON.stringify(a)}),c=Se(Object.assign({key:n.config.apiKey},u)).slice(1),e.next=6,n._getAdditionalHeaders();case 6:return(l=e.sent)["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode),e.abrupt("return",nr.fetch()(fr(n,n.config.apiHost,i,c),Object.assign({method:r,headers:l,referrerPolicy:"no-referrer"},o)));case 10:case"end":return e.stop()}}),t)})))));case 2:case"end":return t.stop()}}),t)}))),ur.apply(this,arguments)}function sr(e,t,n){return cr.apply(this,arguments)}function cr(){return(cr=e(u)(e(s).mark((function t(n,r,i){var a,o,u,c,l,h,f,d,v;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n._canInitEmulator=!1,a=Object.assign(Object.assign({},rr),r),t.prev=2,o=new dr(n),t.next=6,Promise.race([i(),o.promise]);case 6:return u=t.sent,o.clearNetworkTimeout(),t.next=10,u.json();case 10:if(!("needConfirmation"in(c=t.sent))){t.next=13;break}throw vr(n,"account-exists-with-different-credential",c);case 13:if(!u.ok||"errorMessage"in c){t.next=17;break}return t.abrupt("return",c);case 17:if(l=u.ok?c.errorMessage:c.error.message,h=e(D)(l.split(" : "),2),f=h[0],d=h[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){t.next=23;break}throw vr(n,"credential-already-in-use",c);case 23:if("EMAIL_EXISTS"!==f){t.next=27;break}throw vr(n,"email-already-in-use",c);case 27:if("USER_DISABLED"!==f){t.next=29;break}throw vr(n,"user-disabled",c);case 29:if(v=a[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!d){t.next=34;break}throw jn(n,v,d);case 34:qn(n,v);case 35:t.next=42;break;case 37:if(t.prev=37,t.t0=t.catch(2),!(t.t0 instanceof ke)){t.next=41;break}throw t.t0;case 41:qn(n,"network-request-failed");case 42:case"end":return t.stop()}}),t,null,[[2,37]])})))).apply(this,arguments)}function lr(e,t,n,r){return hr.apply(this,arguments)}function hr(){return hr=e(u)(e(s).mark((function t(n,r,i,a){var o,u,c=arguments;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=c.length>4&&void 0!==c[4]?c[4]:{},e.next=3,or(n,r,i,a,o);case 3:return"mfaPendingCredential"in(u=e.sent)&&qn(n,"multi-factor-auth-required",{_serverResponse:u}),e.abrupt("return",u);case 6:case"end":return e.stop()}}),t)}))),hr.apply(this,arguments)}function fr(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?er(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var dr=function(){"use strict";function t(n){var r=this;e(E)(this,t),this.auth=n,this.timer=null,this.promise=new Promise((function(e,t){var n=r;r.timer=setTimeout((function(){return t(Bn(n.auth,"network-request-failed"))}),ir.get())}))}return e(S)(t,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),t}();function vr(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=Bn(e,t,r);return i.customData._tokenResponse=n,i}function pr(e,t){return yr.apply(this,arguments)}function yr(){return(yr=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or(n,"POST","/v1/accounts:delete",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function mr(e,t){return gr.apply(this,arguments)}function gr(){return(gr=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or(n,"POST","/v1/accounts:update",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function kr(e,t){return wr.apply(this,arguments)}function wr(){return(wr=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or(n,"POST","/v1/accounts:lookup",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xr(){return xr=e(u)(e(s).mark((function t(n){var r,i,a,o,u,c,l=arguments;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>1&&void 0!==l[1]&&l[1],i=Oe(n),e.next=4,i.getIdToken(r);case 4:return a=e.sent,zn((o=_r(a))&&o.exp&&o.auth_time&&o.iat,i.auth,"internal-error"),u="object"==typeof o.firebase?o.firebase:void 0,c=null==u?void 0:u.sign_in_provider,e.abrupt("return",{claims:o,token:a,authTime:br(Ir(o.auth_time)),issuedAtTime:br(Ir(o.iat)),expirationTime:br(Ir(o.exp)),signInProvider:c||null,signInSecondFactor:(null==u?void 0:u.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),t)}))),xr.apply(this,arguments)}function Ir(e){return 1e3*Number(e)}function _r(t){var n=e(D)(t.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return Un("JWT malformed, contained fewer than 3 sections"),null;try{var o=ae(i);return o?JSON.parse(o):(Un("Failed to decode base64 JWT payload"),null)}catch(e){return Un("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function Tr(e,t){return Er.apply(this,arguments)}function Er(){return Er=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){var i=arguments;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.length>2&&void 0!==i[2]&&i[2])){e.next=3;break}return e.abrupt("return",r);case 3:return e.prev=3,e.next=6,r;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof ke&&Sr(e.t0))){e.next=15;break}if(n.auth.currentUser!==n){e.next=15;break}return e.next=15,n.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),t,null,[[3,9]])}))),Er.apply(this,arguments)}function Sr(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ar=function(){"use strict";function t(n){e(E)(this,t),this.user=n,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return e(S)(t,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t),r=this;this.timerId=setTimeout(e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.iteration();case 2:case"end":return e.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),"auth/network-request-failed"===(null===e.t0||void 0===e.t0?void 0:e.t0.code)&&t.schedule(!0),e.abrupt("return");case 9:t.schedule();case 10:case"end":return e.stop()}}),n,null,[[0,5]])})))()}}]),t}(),Cr=function(){"use strict";function t(n,r){e(E)(this,t),this.createdAt=n,this.lastLoginAt=r,this._initializeTime()}return e(S)(t,[{key:"_initializeTime",value:function(){this.lastSignInTime=br(this.lastLoginAt),this.creationTime=br(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(e){return Dr.apply(this,arguments)}function Dr(){return(Dr=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n){var r,i,a,o,u,c,l,h,f,d,v;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.auth,e.next=4,n.getIdToken();case 4:return a=e.sent,e.next=7,Tr(n,kr(i,{idToken:a}));case 7:zn(null==(o=e.sent)?void 0:o.users.length,i,"internal-error"),u=o.users[0],n._notifyReloadListener(u),c=(null===(r=u.providerUserInfo)||void 0===r?void 0:r.length)?Pr(u.providerUserInfo):[],l=Or(n.providerData,c),h=n.isAnonymous,f=!(n.email&&u.passwordHash||(null==l?void 0:l.length)),d=!!h&&f,v={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:l,metadata:new Cr(u.createdAt,u.lastLoginAt),isAnonymous:d},Object.assign(n,v);case 18:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Rr(){return(Rr=e(u)(e(s).mark((function t(n){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Oe(n),e.next=3,Nr(r);case 3:return e.next=5,r.auth._persistUserIfCurrent(r);case 5:r.auth._notifyListenersIfCurrent(r);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Or(t,n){var r=t.filter((function(e){return!n.some((function(t){return t.providerId===e.providerId}))}));return e(R)(r).concat(e(R)(n))}function Pr(e){return e.map((function(e){var t=e.providerId,n=xn(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}function Lr(e,t){return Mr.apply(this,arguments)}function Mr(){return(Mr=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){var i;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,sr(n,{},e(u)(e(s).mark((function t(){var i,a,o,u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Se({grant_type:"refresh_token",refresh_token:r}).slice(1),a=n.config,o=a.tokenApiHost,u=a.apiKey,c=fr(n,o,"/v1/token","key=".concat(u)),e.next=5,n._getAdditionalHeaders();case 5:return(l=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",nr.fetch()(c,{method:"POST",headers:l,body:i}));case 8:case"end":return e.stop()}}),t)}))));case 2:return i=t.sent,t.abrupt("return",{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token});case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fr=function(){"use strict";function t(){e(E)(this,t),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return e(S)(t,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){zn(e.idToken,"internal-error"),zn(void 0!==e.idToken,"internal-error"),zn(void 0!==e.refreshToken,"internal-error");var t,n,r="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):(t=e.idToken,zn(n=_r(t),"internal-error"),zn(void 0!==n.exp,"internal-error"),zn(void 0!==n.iat,"internal-error"),Number(n.exp)-Number(n.iat));this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}},{key:"getToken",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(u)(e(s).mark((function i(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zn(!r.accessToken||r.refreshToken,t,"user-token-expired"),n||!r.accessToken||r.isExpired){e.next=3;break}return e.abrupt("return",r.accessToken);case 3:if(!r.refreshToken){e.next=7;break}return e.next=6,r.refresh(t,r.refreshToken);case 6:return e.abrupt("return",r.accessToken);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),i)})))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(t,n){var r=this;return e(u)(e(s).mark((function i(){var a,o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lr(t,n);case 2:a=e.sent,o=a.accessToken,u=a.refreshToken,c=a.expiresIn,r.updateTokensAndExpiration(o,u,Number(c));case 7:case"end":return e.stop()}}),i)})))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new t,this.toJSON())}},{key:"_performRefresh",value:function(){return Wn("not implemented")}}],[{key:"fromJSON",value:function(e,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new t;return r&&(zn("string"==typeof r,"internal-error",{appName:e}),o.refreshToken=r),i&&(zn("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),a&&(zn("number"==typeof a,"internal-error",{appName:e}),o.expirationTime=a),o}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(e,t){zn("string"==typeof e||void 0===e,"internal-error",{appName:t})}var Ur=function(){"use strict";function t(n){e(E)(this,t);var r=n.uid,i=n.auth,a=n.stsTokenManager,o=xn(n,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ar(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=i,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?e(R)(o.providerData):[],this.metadata=new Cr(o.createdAt||void 0,o.lastLoginAt||void 0)}return e(S)(t,[{key:"getIdToken",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tr(n,n.stsTokenManager.getToken(n.auth,t));case 2:if(zn(i=e.sent,n.auth,"internal-error"),n.accessToken===i){e.next=9;break}return n.accessToken=i,e.next=8,n.auth._persistUserIfCurrent(n);case 8:n.auth._notifyListenersIfCurrent(n);case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),r)})))()}},{key:"getIdTokenResult",value:function(e){return function(e){return xr.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return Rr.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(zn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(e){return new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){zn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(u)(e(s).mark((function i(){var a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),a=!0),!n){e.next=5;break}return e.next=5,Nr(r);case 5:return e.next=7,r.auth._persistUserIfCurrent(r);case 7:a&&r.auth._notifyListenersIfCurrent(r);case 8:case"end":return e.stop()}}),i)})))()}},{key:"delete",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getIdToken();case 2:return r=e.sent,e.next=5,Tr(t,pr(t.auth,{idToken:r}));case 5:return t.stsTokenManager.clearRefreshToken(),e.abrupt("return",t.auth.signOut());case 7:case"end":return e.stop()}}),n)})))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(e,n){var r,i,a,o,u,s,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(u=n.tenantId)&&void 0!==u?u:void 0,y=null!==(s=n._redirectEventId)&&void 0!==s?s:void 0,m=null!==(c=n.createdAt)&&void 0!==c?c:void 0,g=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,w=n.emailVerified,b=n.isAnonymous,x=n.providerData,I=n.stsTokenManager;zn(k&&I,e,"internal-error");var _=Fr.fromJSON(this.name,I);zn("string"==typeof k,e,"internal-error"),Vr(h,e.name),Vr(f,e.name),zn("boolean"==typeof w,e,"internal-error"),zn("boolean"==typeof b,e,"internal-error"),Vr(d,e.name),Vr(v,e.name),Vr(p,e.name),Vr(y,e.name),Vr(m,e.name),Vr(g,e.name);var T=new t({uid:k,auth:e,email:f,emailVerified:w,displayName:h,isAnonymous:b,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:_,createdAt:m,lastLoginAt:g});return x&&Array.isArray(x)&&(T.providerData=x.map((function(e){return Object.assign({},e)}))),y&&(T._redirectEventId=y),T}},{key:"_fromIdTokenResponse",value:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(u)(e(s).mark((function a(){var o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new Fr).updateFromServerResponse(r),u=new t({uid:r.localId,auth:n,stsTokenManager:o,isAnonymous:i}),e.next=5,Nr(u);case 5:return e.abrupt("return",u);case 6:case"end":return e.stop()}}),a)})))()}}]),t}(),qr=function(){"use strict";function t(){e(E)(this,t),this.type="NONE",this.storage={}}return e(S)(t,[{key:"_isAvailable",value:function(){return e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),t)})))()}},{key:"_set",value:function(t,n){var r=this;return e(u)(e(s).mark((function i(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.storage[t]=n;case 1:case"end":return e.stop()}}),i)})))()}},{key:"_get",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.storage[t],e.abrupt("return",void 0===i?null:i);case 2:case"end":return e.stop()}}),r)})))()}},{key:"_remove",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete n.storage[t];case 1:case"end":return e.stop()}}),r)})))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qr.type="NONE";var Br=qr;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var Gr=function(){"use strict";function t(n,r,i){e(E)(this,t),this.persistence=n,this.auth=r,this.userKey=i;var a=this.auth,o=a.config,u=a.name;this.fullUserKey=jr(this.userKey,o.apiKey,u),this.fullPersistenceKey=jr("persistence",o.apiKey,u),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return e(S)(t,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.persistence._get(t.fullUserKey);case 2:return r=e.sent,e.abrupt("return",r?Ur._fromJSON(t.auth,r):null);case 4:case"end":return e.stop()}}),n)})))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.getCurrentUser();case 4:return i=e.sent,e.next=7,n.removeCurrentUser();case 7:if(n.persistence=t,!i){e.next=10;break}return e.abrupt("return",n.setCurrentUser(i));case 10:case"end":return e.stop()}}),r)})))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return e(u)(e(s).mark((function a(){var o,c,l,h,f,d,v,p,y,m,g,k,w;return e(s).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.length){a.next=2;break}return a.abrupt("return",new t(Yn(Br),n,i));case 2:return a.next=4,Promise.all(r.map(function(){var t=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",n);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 4:o=a.sent.filter((function(e){return e})),c=o[0]||Yn(Br),l=jr(i,n.config.apiKey,n.name),h=null,f=!0,d=!1,v=void 0,a.prev=9,p=r[Symbol.iterator]();case 11:if(f=(y=p.next()).done){a.next=29;break}return m=y.value,a.prev=13,a.next=16,m._get(l);case 16:if(!(g=a.sent)){a.next=22;break}return k=Ur._fromJSON(n,g),m!==c&&(h=k),c=m,a.abrupt("break",29);case 22:a.next=26;break;case 24:a.prev=24,a.t0=a.catch(13);case 26:f=!0,a.next=11;break;case 29:a.next=35;break;case 31:a.prev=31,a.t1=a.catch(9),d=!0,v=a.t1;case 35:a.prev=35,a.prev=36,f||null==p.return||p.return();case 38:if(a.prev=38,!d){a.next=41;break}throw v;case 41:return a.finish(38);case 42:return a.finish(35);case 43:if(w=o.filter((function(e){return e._shouldAllowMigration})),c._shouldAllowMigration&&w.length){a.next=46;break}return a.abrupt("return",new t(c,n,i));case 46:if(c=w[0],!h){a.next=50;break}return a.next=50,c._set(l,h.toJSON());case 50:return a.next=52,Promise.all(r.map(function(){var t=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n===c){e.next=8;break}return e.prev=1,e.next=4,n._remove(l);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),t,null,[[1,6]])})));return function(e){return t.apply(this,arguments)}}()));case 52:return a.abrupt("return",new t(c,n,i));case 53:case"end":return a.stop()}}),a,null,[[9,31,35,43],[13,24],[36,,38,42]])})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Qr(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(zr(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Xr(t))return"Blackberry";if(Jr(t))return"Webos";if(Wr(t))return"Safari";if((t.includes("chrome/")||Hr(t))&&!t.includes("edge/"))return"Chrome";if(Yr(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function zr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return/firefox\//i.test(e)}function Wr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Hr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return/crios\//i.test(e)}function Qr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return/iemobile/i.test(e)}function Yr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return/android/i.test(e)}function Xr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return/blackberry/i.test(e)}function Jr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return/webos/i.test(e)}function Zr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function $r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}function ei(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return Zr(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}function ti(){return me()&&10===document.documentMode}function ni(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return Zr(e)||Yr(e)||Jr(e)||Xr(e)||/windows phone/i.test(e)||Qr(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ri(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Kr(de());break;case"Worker":t="".concat(Kr(de()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Pt,"/").concat(r)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ii=function(){"use strict";function t(n){e(E)(this,t),this.auth=n,this.queue=[]}return e(S)(t,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(e){r(e)}}))};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a,o,u,c,l,h,f,d,v,p,y,m;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:i=[],e.prev=3,a=!0,o=!1,u=void 0,e.prev=5,c=n.queue[Symbol.iterator]();case 7:if(a=(l=c.next()).done){e.next=15;break}return h=l.value,e.next=11,h(t);case 11:h.onAbort&&i.push(h.onAbort);case 12:a=!0,e.next=7;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),o=!0,u=e.t0;case 21:e.prev=21,e.prev=22,a||null==c.return||c.return();case 24:if(e.prev=24,!o){e.next=27;break}throw u;case 27:return e.finish(24);case 28:return e.finish(21);case 29:e.next=52;break;case 31:for(e.prev=31,e.t1=e.catch(3),i.reverse(),f=!0,d=!1,v=void 0,e.prev=35,p=i[Symbol.iterator]();!(f=(y=p.next()).done);f=!0){m=y.value;try{m()}catch(e){}}e.next=43;break;case 39:e.prev=39,e.t2=e.catch(35),d=!0,v=e.t2;case 43:e.prev=43,e.prev=44,f||null==p.return||p.return();case 46:if(e.prev=46,!d){e.next=49;break}throw v;case 49:return e.finish(46);case 50:return e.finish(43);case 51:throw n.auth._errorFactory.create("login-blocked",{originalMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 52:case"end":return e.stop()}}),r,null,[[3,31],[5,17,21,29],[22,,24,28],[35,39,43,51],[44,,46,50]])})))()}}]),t}(),ai=function(){"use strict";function t(n,r,i){e(E)(this,t),this.app=n,this.heartbeatServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ui(this),this.idTokenSubscription=new ui(this),this.beforeStateQueue=new ii(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Fn,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=n.name,this.clientVersion=i.sdkClientVersion}return e(S)(t,[{key:"_initializeWithPersistence",value:function(t,n){n&&(this._popupRedirectResolver=Yn(n));var r=this;return this._initializationPromise=this.queue(e(u)(e(s).mark((function i(){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r._deleted){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Gr.create(r,t);case 5:if(r.persistenceManager=e.sent,!r._deleted){e.next=8;break}return e.abrupt("return");case 8:if(!(null===(a=r._popupRedirectResolver)||void 0===a?void 0:a._shouldInitProactively)){e.next=16;break}return e.prev=9,e.next=12,r._popupRedirectResolver._initialize(r);case 12:e.next=16;break;case 14:e.prev=14,e.t0=e.catch(9);case 16:return e.next=18,r.initializeCurrentUser(n);case 18:if(r.lastNotifiedUid=(null===(o=r.currentUser)||void 0===o?void 0:o.uid)||null,!r._deleted){e.next=21;break}return e.abrupt("return");case 21:r._isInitialized=!0;case 22:case"end":return e.stop()}}),i,null,[[9,14]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.assertedPersistence.getCurrentUser();case 4:if(r=e.sent,t.currentUser||r){e.next=7;break}return e.abrupt("return");case 7:if(!t.currentUser||!r||t.currentUser.uid!==r.uid){e.next=12;break}return t._currentUser._assign(r),e.next=11,t.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,t._updateCurrentUser(r,!0);case 14:case"end":return e.stop()}}),n)})))()}},{key:"initializeCurrentUser",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a,o,u,c,l,h;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,n.assertedPersistence.getCurrentUser();case 3:if(a=e.sent,o=a,u=!1,!t||!n.config.authDomain){e.next=15;break}return e.next=9,n.getOrInitRedirectPersistenceManager();case 9:return c=null===(i=n.redirectUser)||void 0===i?void 0:i._redirectEventId,l=null==o?void 0:o._redirectEventId,e.next=13,n.tryRedirectSignIn(t);case 13:h=e.sent,c&&c!==l||!(null==h?void 0:h.user)||(o=h.user,u=!0);case 15:if(o){e.next=17;break}return e.abrupt("return",n.directlySetCurrentUser(null));case 17:if(o._redirectEventId){e.next=33;break}if(!u){e.next=28;break}return e.prev=19,e.next=22,n.beforeStateQueue.runMiddleware(o);case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(19),o=a,n._popupRedirectResolver._overrideRedirectResult(n,(function(){return Promise.reject(e.t0)}));case 28:if(!o){e.next=32;break}return e.abrupt("return",n.reloadAndSetCurrentUserOrClear(o));case 32:return e.abrupt("return",n.directlySetCurrentUser(null));case 33:return zn(n._popupRedirectResolver,n,"argument-error"),e.next=36,n.getOrInitRedirectPersistenceManager();case 36:if(!n.redirectUser||n.redirectUser._redirectEventId!==o._redirectEventId){e.next=38;break}return e.abrupt("return",n.directlySetCurrentUser(o));case 38:return e.abrupt("return",n.reloadAndSetCurrentUserOrClear(o));case 39:case"end":return e.stop()}}),r,null,[[19,24]])})))()}},{key:"tryRedirectSignIn",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null,e.prev=1,e.next=4,n._popupRedirectResolver._completeRedirectFn(n,t,!0);case 4:i=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,n._setRedirectUser(null);case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),r,null,[[1,7]])})))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Nr(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),"auth/network-request-failed"===(null===e.t0||void 0===e.t0?void 0:e.t0.code)){e.next=9;break}return e.abrupt("return",n.directlySetCurrentUser(null));case 9:return e.abrupt("return",n.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),r,null,[[0,5]])})))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._deleted=!0;case 1:case"end":return e.stop()}}),n)})))()}},{key:"updateCurrentUser",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=t?Oe(t):null)&&zn(i.auth.config.apiKey===n.config.apiKey,n,"invalid-user-token"),e.abrupt("return",n._updateCurrentUser(i&&i._clone(n)));case 3:case"end":return e.stop()}}),r)})))()}},{key:"_updateCurrentUser",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(u)(e(s).mark((function i(){return e(s).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!r._deleted){i.next=2;break}return i.abrupt("return");case 2:if(t&&zn(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),n){i.next=6;break}return i.next=6,r.beforeStateQueue.runMiddleware(t);case 6:return i.abrupt("return",r.queue(e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),n)})))));case 7:case"end":return i.stop()}}),i)})))()}},{key:"signOut",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.beforeStateQueue.runMiddleware(null);case 2:if(!t.redirectPersistenceManager&&!t._popupRedirectResolver){e.next=5;break}return e.next=5,t._setRedirectUser(null);case 5:return e.abrupt("return",t._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),n)})))()}},{key:"setPersistence",value:function(t){var n=this;return this.queue(e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.assertedPersistence.setPersistence(Yn(t));case 2:case"end":return e.stop()}}),r)}))))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new we("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(t,n){var r=this;return e(u)(e(s).mark((function i(){var a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getOrInitRedirectPersistenceManager(n);case 2:return a=e.sent,e.abrupt("return",null===t?a.removeCurrentUser():a.setCurrentUser(t));case 4:case"end":return e.stop()}}),i)})))()}},{key:"getOrInitRedirectPersistenceManager",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.redirectPersistenceManager){e.next=9;break}return zn(i=t&&Yn(t)||n._popupRedirectResolver,n,"argument-error"),e.next=5,Gr.create(n,[Yn(i._redirectPersistence)],"redirectUser");case 5:return n.redirectPersistenceManager=e.sent,e.next=8,n.redirectPersistenceManager.getCurrentUser();case 8:n.redirectUser=e.sent;case 9:return e.abrupt("return",n.redirectPersistenceManager);case 10:case"end":return e.stop()}}),r)})))()}},{key:"_redirectUserForId",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a;return e(s).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._isInitialized){r.next=4;break}return r.next=4,n.queue(e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)}))));case 4:if((null===(i=n._currentUser)||void 0===i?void 0:i._redirectEventId)!==t){r.next=6;break}return r.abrupt("return",n._currentUser);case 6:if((null===(a=n.redirectUser)||void 0===a?void 0:a._redirectEventId)!==t){r.next=8;break}return r.abrupt("return",n.redirectUser);case 8:return r.abrupt("return",null);case 9:case"end":return r.stop()}}),r)})))()}},{key:"_persistUserIfCurrent",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t!==n.currentUser){r.next=2;break}return r.abrupt("return",n.queue(e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),r)})))));case 2:case"end":return r.stop()}}),r)})))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return zn(o,this,"internal-error"),o.then((function(){return a(i.currentUser)})),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.currentUser&&n.currentUser!==t&&n._currentUser._stopProactiveRefresh(),t&&n.isProactiveRefreshEnabled&&t._startProactiveRefresh(),n.currentUser=t,!t){e.next=8;break}return e.next=6,n.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,n.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),r)})))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return zn(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ri(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i,a;return e(s).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e(A)({},"X-Client-Version",t.clientVersion),t.app.options.appId&&(i["X-Firebase-gmpid"]=t.app.options.appId),n.next=5,null===(r=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===r?void 0:r.getHeartbeatsHeader();case 5:return(a=n.sent)&&(i["X-Firebase-Client"]=a),n.abrupt("return",i);case 8:case"end":return n.stop()}}),n)})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(e){return Oe(e)}var ui=function(){"use strict";function t(n){var r=this;e(E)(this,t),this.auth=n,this.observer=null,this.addObserver=Ne((function(e){return r.observer=e}))}return e(S)(t,[{key:"next",get:function(){return zn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),t}();function si(t,n,r){var i=oi(t);zn(i._canInitEmulator,i,"emulator-config-failed"),zn(/^https?:\/\//.test(n),i,"invalid-emulator-scheme");var a=!!(null==r?void 0:r.disableWarnings),o=ci(n),u=function(t){var n=ci(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(n.length));if(!r)return{host:"",port:null};var i=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){var o=a[1];return{host:o,port:li(i.substr(o.length+1))}}var u=e(D)(i.split(":"),2);return{host:u[0],port:li(u[1])}}(n),s=u.host,c=u.port,l=null===c?"":":".concat(c);i.config.emulator={url:"".concat(o,"//").concat(s).concat(l,"/")},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:s,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */()}function ci(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function li(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var hi=function(){"use strict";function t(n,r){e(E)(this,t),this.providerId=n,this.signInMethod=r}return e(S)(t,[{key:"toJSON",value:function(){return Wn("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return Wn("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return Wn("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return Wn("not implemented")}}]),t}();function fi(e,t){return di.apply(this,arguments)}function di(){return(di=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or(n,"POST","/v1/accounts:resetPassword",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function vi(e,t){return pi.apply(this,arguments)}function pi(){return(pi=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or(n,"POST","/v1/accounts:update",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function yi(e,t){return mi.apply(this,arguments)}function mi(){return(mi=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or(n,"POST","/v1/accounts:update",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function gi(e,t){return ki.apply(this,arguments)}function ki(){return(ki=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lr(n,"POST","/v1/accounts:signInWithPassword",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function wi(e,t){return bi.apply(this,arguments)}function bi(){return(bi=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or(n,"POST","/v1/accounts:sendOobCode",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function xi(e,t){return Ii.apply(this,arguments)}function Ii(){return(Ii=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",wi(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function _i(e,t){return Ti.apply(this,arguments)}function Ti(){return(Ti=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",wi(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ei(e,t){return Si.apply(this,arguments)}function Si(){return(Si=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",wi(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ai(e,t){return Ci.apply(this,arguments)}function Ci(){return(Ci=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",wi(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ni(e,t){return Di.apply(this,arguments)}function Di(){return(Di=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lr(n,"POST","/v1/accounts:signInWithEmailLink",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ri(e,t){return Oi.apply(this,arguments)}function Oi(){return(Oi=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lr(n,"POST","/v1/accounts:signInWithEmailLink",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pi=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return e(E)(this,r),(o=n.call(this,"password",a))._email=t,o._password=i,o._tenantId=u,o}return e(S)(r,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",gi(t,{returnSecureToken:!0,email:n._email,password:n._password}));case 4:return e.abrupt("return",Ni(t,{email:n._email,oobCode:n._password}));case 5:qn(t,"internal-error");case 6:case"end":return e.stop()}}),r)})))()}},{key:"_linkToIdToken",value:function(t,n){var r=this;return e(u)(e(s).mark((function i(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",vi(t,{idToken:n,returnSecureToken:!0,email:r._email,password:r._password}));case 4:return e.abrupt("return",Ri(t,{idToken:n,email:r._email,oobCode:r._password}));case 5:qn(t,"internal-error");case 6:case"end":return e.stop()}}),i)})))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new r(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new r(e,t,"emailLink",n)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),r}(hi);function Li(e,t){return Mi.apply(this,arguments)}function Mi(){return(Mi=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lr(n,"POST","/v1/accounts:signInWithIdp",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fi=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){var t;return e(E)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).pendingToken=null,t}return e(S)(r,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return Li(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,Li(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,Li(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Se(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new r(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qn("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,n=t.providerId,i=t.signInMethod,a=xn(t,["providerId","signInMethod"]);if(!n||!i)return null;var o=new r(n,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),r}(hi);function Vi(e,t){return Ui.apply(this,arguments)}function Ui(){return(Ui=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or(n,"POST","/v1/accounts:sendVerificationCode",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function qi(){return(qi=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lr(n,"POST","/v1/accounts:signInWithPhoneNumber",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Bi(){return(Bi=e(u)(e(s).mark((function t(n,r){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lr(n,"POST","/v1/accounts:signInWithPhoneNumber",ar(n,r));case 2:if(!(i=e.sent).temporaryProof){e.next=5;break}throw vr(n,"account-exists-with-different-credential",i);case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var ji=e(A)({},"USER_NOT_FOUND","user-not-found");function Gi(){return(Gi=e(u)(e(s).mark((function t(n,r){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object.assign(Object.assign({},r),{operation:"REAUTH"}),e.abrupt("return",lr(n,"POST","/v1/accounts:signInWithPhoneNumber",ar(n,i),ji));case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ki=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this,"phone","phone")).params=t,i}return e(S)(r,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return qi.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return Bi.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return Gi.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,i=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:i}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new r({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new r({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e.verificationId,n=e.verificationCode,i=e.phoneNumber,a=e.temporaryProof;return n||t||i||a?new r({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:a}):null}}]),r}(hi);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zi=function(){"use strict";function t(n){var r,i,a,o,u,s;e(E)(this,t);var c=Ae(Ce(n)),l=null!==(r=c.apiKey)&&void 0!==r?r:null,h=null!==(i=c.oobCode)&&void 0!==i?i:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(a=c.mode)&&void 0!==a?a:null);zn(l&&h&&f,"argument-error"),this.apiKey=l,this.operation=f,this.code=h,this.continueUrl=null!==(o=c.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(u=c.languageCode)&&void 0!==u?u:null,this.tenantId=null!==(s=c.tenantId)&&void 0!==s?s:null}return e(S)(t,null,[{key:"parseLink",value:function(e){var n=function(e){var t=Ae(Ce(e)).link,n=t?Ae(Ce(t)).deep_link_id:null,r=Ae(Ce(e)).deep_link_id;return(r?Ae(Ce(r)).link:null)||r||n||t||e}(e);try{return new t(n)}catch(e){return null}}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wi=function(){"use strict";function t(){e(E)(this,t),this.providerId=t.PROVIDER_ID}return e(S)(t,null,[{key:"credential",value:function(e,t){return Pi._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=zi.parseLink(t);return zn(n,"argument-error"),Pi._fromEmailAndCode(e,n.code,n.tenantId)}}]),t}();Wi.PROVIDER_ID="password",Wi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Wi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Hi=function(){"use strict";function t(n){e(E)(this,t),this.providerId=n,this.defaultLanguageCode=null,this.customParameters={}}return e(S)(t,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),t}(),Qi=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){var t;return e(E)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).scopes=[],t}return e(S)(r,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return e(R)(this.scopes)}}]),r}(Hi),Yi=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.apply(this,arguments)}return e(S)(r,[{key:"credential",value:function(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}},{key:"_credential",value:function(e){return zn(e.idToken||e.accessToken,"argument-error"),Fi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}}],[{key:"credentialFromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;return zn("providerId"in t&&"signInMethod"in t,"argument-error"),Fi._fromParams(t)}},{key:"credentialFromResult",value:function(e){return r.oauthCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.oauthCredentialFromTaggedObject(e.customData||{})}},{key:"oauthCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthIdToken,i=t.oauthAccessToken,a=t.oauthTokenSecret,o=t.pendingToken,u=t.nonce,s=t.providerId;if(!(i||a||n||o))return null;if(!s)return null;try{return new r(s)._credential({idToken:n,accessToken:i,nonce:u,pendingToken:o})}catch(e){return null}}}]),r}(Qi),Xi=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.call(this,"facebook.com")}return e(S)(r,null,[{key:"credential",value:function(e){return Fi._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return r.credential(t.oauthAccessToken)}catch(e){return null}}}]),r}(Qi);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xi.FACEBOOK_SIGN_IN_METHOD="facebook.com",Xi.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ji=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){var t;return e(E)(this,r),(t=n.call(this,"google.com")).addScope("profile"),t}return e(S)(r,null,[{key:"credential",value:function(e,t){return Fi._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthIdToken,i=t.oauthAccessToken;if(!n&&!i)return null;try{return r.credential(n,i)}catch(e){return null}}}]),r}(Qi);Ji.GOOGLE_SIGN_IN_METHOD="google.com",Ji.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Zi=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.call(this,"github.com")}return e(S)(r,null,[{key:"credential",value:function(e){return Fi._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return r.credential(t.oauthAccessToken)}catch(e){return null}}}]),r}(Qi);Zi.GITHUB_SIGN_IN_METHOD="github.com",Zi.PROVIDER_ID="github.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var $i=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,t,t)).pendingToken=i,a}return e(S)(r,[{key:"_getIdTokenResponse",value:function(e){return Li(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,Li(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,Li(e,t)}},{key:"toJSON",value:function(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}},{key:"buildRequest",value:function(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}],[{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,n=t.providerId,i=t.signInMethod,a=t.pendingToken;return n&&i&&a&&n===i?new r(n,a):null}},{key:"_create",value:function(e,t){return new r(e,t)}}]),r}(hi),ea=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){return e(E)(this,r),zn(t.startsWith("saml."),"argument-error"),n.call(this,t)}return e(S)(r,null,[{key:"credentialFromResult",value:function(e){return r.samlCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.samlCredentialFromTaggedObject(e.customData||{})}},{key:"credentialFromJSON",value:function(e){var t=$i.fromJSON(e);return zn(t,"argument-error"),t}},{key:"samlCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.pendingToken,r=t.providerId;if(!n||!r)return null;try{return $i._create(r,n)}catch(e){return null}}}]),r}(Hi),ta=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.call(this,"twitter.com")}return e(S)(r,null,[{key:"credential",value:function(e,t){return Fi._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthAccessToken,i=t.oauthTokenSecret;if(!n||!i)return null;try{return r.credential(n,i)}catch(e){return null}}}]),r}(Qi);function na(e,t){return ra.apply(this,arguments)}function ra(){return(ra=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lr(n,"POST","/v1/accounts:signUp",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ta.TWITTER_SIGN_IN_METHOD="twitter.com",ta.PROVIDER_ID="twitter.com";var ia=function(){"use strict";function t(n){e(E)(this,t),this.user=n.user,this.providerId=n.providerId,this._tokenResponse=n._tokenResponse,this.operationType=n.operationType}return e(S)(t,null,[{key:"_fromIdTokenResponse",value:function(n,r,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e(u)(e(s).mark((function o(){var u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ur._fromIdTokenResponse(n,i,a);case 2:return u=e.sent,c=aa(i),l=new t({user:u,providerId:c,_tokenResponse:i,operationType:r}),e.abrupt("return",l);case 6:case"end":return e.stop()}}),o)})))()}},{key:"_forOperation",value:function(n,r,i){return e(u)(e(s).mark((function a(){var o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._updateTokensIfNecessary(i,!0);case 2:return o=aa(i),e.abrupt("return",new t({user:n,providerId:o,_tokenResponse:i,operationType:r}));case 4:case"end":return e.stop()}}),a)})))()}}]),t}();function aa(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}function oa(){return(oa=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n){var r,i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=oi(n),e.next=4,i._initializationPromise;case 4:if(!(null===(r=i.currentUser)||void 0===r?void 0:r.isAnonymous)){e.next=6;break}return e.abrupt("return",new ia({user:i.currentUser,providerId:null,operationType:"signIn"}));case 6:return e.next=8,na(i,{returnSecureToken:!0});case 8:return a=e.sent,e.next=11,ia._fromIdTokenResponse(i,"signIn",a,!0);case 11:return o=e.sent,e.next=14,i._updateCurrentUser(o.user);case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ua=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a,o){var u,s;return e(E)(this,r),(u=n.call(this,i.code,i.message)).operationType=a,u.user=o,Object.setPrototypeOf(e(C)(u),r.prototype),u.customData={appName:t.name,tenantId:null!==(s=t.tenantId)&&void 0!==s?s:void 0,_serverResponse:i.customData._serverResponse,operationType:a},u}return e(S)(r,null,[{key:"_fromErrorAndOperation",value:function(e,t,n,i){return new r(e,t,n,i)}}]),r}(ke);function sa(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if("auth/multi-factor-auth-required"===n.code)throw ua._fromErrorAndOperation(e,n,t,r);throw n}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(e){return new Set(e.map((function(e){return e.providerId})).filter((function(e){return!!e})))}function la(e,t){return ha.apply(this,arguments)}function ha(){return(ha=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){var i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Oe(n),e.next=3,va(!0,i,r);case 3:return e.t0=mr,e.t1=i.auth,e.next=7,i.getIdToken();case 7:return e.t2=e.sent,e.t3=[r],e.t4={idToken:e.t2,deleteProvider:e.t3},e.next=12,(0,e.t0)(e.t1,e.t4);case 12:return a=e.sent.providerUserInfo,o=ca(a||[]),i.providerData=i.providerData.filter((function(e){return o.has(e.providerId)})),o.has("phone")||(i.phoneNumber=null),e.next=18,i.auth._persistUserIfCurrent(i);case 18:return e.abrupt("return",i);case 19:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function fa(e,t){return da.apply(this,arguments)}function da(){return da=e(u)(e(s).mark((function t(n,r){var i,a,o=arguments;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>2&&void 0!==o[2]&&o[2],e.t0=Tr,e.t1=n,e.t2=r,e.t3=n.auth,e.next=7,n.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=i,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return a=e.sent,e.abrupt("return",ia._forOperation(n,"link",a));case 14:case"end":return e.stop()}}),t)}))),da.apply(this,arguments)}function va(e,t,n){return pa.apply(this,arguments)}function pa(){return(pa=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nr(r);case 2:a=ca(r.providerData),o=!1===n?"provider-already-linked":"no-such-provider",zn(a.has(i)===n,r.auth,o);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ya(e,t){return ma.apply(this,arguments)}function ma(){return ma=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){var i,a,o,u,c,l,h=arguments;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=h.length>2&&void 0!==h[2]&&h[2],a=n.auth,o="reauthenticate",e.prev=3,e.next=6,Tr(n,sa(a,o,r,n),i);case 6:return zn((u=e.sent).idToken,a,"internal-error"),zn(c=_r(u.idToken),a,"internal-error"),l=c.sub,zn(n.uid===l,a,"user-mismatch"),e.abrupt("return",ia._forOperation(n,o,u));case 15:throw e.prev=15,e.t0=e.catch(3),"auth/user-not-found"===(null===e.t0||void 0===e.t0?void 0:e.t0.code)&&qn(a,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),t,null,[[3,15]])}))),ma.apply(this,arguments)}function ga(e,t){return ka.apply(this,arguments)}function ka(){return ka=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){var i,a,o,u,c=arguments;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>2&&void 0!==c[2]&&c[2],a="signIn",e.next=4,sa(n,a,r);case 4:return o=e.sent,e.next=7,ia._fromIdTokenResponse(n,a,o);case 7:if(u=e.sent,i){e.next=11;break}return e.next=11,n._updateCurrentUser(u.user);case 11:return e.abrupt("return",u);case 12:case"end":return e.stop()}}),t)}))),ka.apply(this,arguments)}function wa(e,t){return ba.apply(this,arguments)}function ba(){return(ba=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ga(oi(n),r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function xa(e,t){return Ia.apply(this,arguments)}function Ia(){return(Ia=e(u)(e(s).mark((function t(n,r){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Oe(n),e.next=3,va(!1,i,r.providerId);case 3:return e.abrupt("return",fa(i,r));case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function _a(e,t){return Ta.apply(this,arguments)}function Ta(){return(Ta=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ya(Oe(n),r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ea(e,t){return Sa.apply(this,arguments)}function Sa(){return(Sa=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lr(n,"POST","/v1/accounts:signInWithCustomToken",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Aa(){return(Aa=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){var i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=oi(n),e.next=3,Ea(i,{token:r,returnSecureToken:!0});case 3:return a=e.sent,e.next=6,ia._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ca=function(){"use strict";function t(n,r){e(E)(this,t),this.factorId=n,this.uid=r.mfaEnrollmentId,this.enrollmentTime=new Date(r.enrolledAt).toUTCString(),this.displayName=r.displayName}return e(S)(t,null,[{key:"_fromServerResponse",value:function(e,t){return"phoneInfo"in t?Na._fromServerResponse(e,t):qn(e,"internal-error")}}]),t}(),Na=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this,"phone",t)).phoneNumber=t.phoneInfo,i}return e(S)(r,null,[{key:"_fromServerResponse",value:function(e,t){return new r(t)}}]),r}(Ca);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Da(e,t,n){var r;zn((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),zn(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(zn(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(zn(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function Ra(){return(Ra=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Oe(n),o={requestType:"PASSWORD_RESET",email:r},i&&Da(a,o,i),e.next=5,_i(a,o);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Oa(){return(Oa=e(u)(e(s).mark((function t(n,r,i){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fi(Oe(n),{oobCode:r,newPassword:i});case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Pa(){return(Pa=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yi(Oe(n),{oobCode:r});case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function La(e,t){return Ma.apply(this,arguments)}function Ma(){return(Ma=e(u)(e(s).mark((function t(n,r){var i,a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Oe(n),e.next=3,fi(i,{oobCode:r});case 3:a=e.sent,zn(o=a.requestType,i,"internal-error"),e.t0=o,e.next="EMAIL_SIGNIN"===e.t0?9:"VERIFY_AND_CHANGE_EMAIL"===e.t0?10:"REVERT_SECOND_FACTOR_ADDITION"===e.t0?12:13;break;case 9:return e.abrupt("break",14);case 10:return zn(a.newEmail,i,"internal-error"),e.abrupt("break",14);case 12:zn(a.mfaInfo,i,"internal-error");case 13:zn(a.email,i,"internal-error");case 14:return u=null,a.mfaInfo&&(u=Ca._fromServerResponse(oi(i),a.mfaInfo)),e.abrupt("return",{data:{email:("VERIFY_AND_CHANGE_EMAIL"===a.requestType?a.newEmail:a.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===a.requestType?a.email:a.newEmail)||null,multiFactorInfo:u},operation:o});case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Fa(){return(Fa=e(u)(e(s).mark((function t(n,r){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,La(Oe(n),r);case 2:return i=e.sent.data,e.abrupt("return",i.email);case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Va(e,t,n){return Ua.apply(this,arguments)}function Ua(){return(Ua=e(u)(e(s).mark((function t(n,r,i){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=oi(n),e.next=3,na(a,{returnSecureToken:!0,email:r,password:i});case 3:return o=e.sent,e.next=6,ia._fromIdTokenResponse(a,"signIn",o);case 6:return u=e.sent,e.next=9,a._updateCurrentUser(u.user);case 9:return e.abrupt("return",u);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function qa(){return(qa=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Oe(n),o={requestType:"EMAIL_SIGNIN",email:r},zn(i.handleCodeInApp,a,"argument-error"),i&&Da(a,o,i),e.next=6,Ei(a,o);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ba(){return(Ba=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Oe(n),zn((o=Wi.credentialWithLink(r,i||Xn()))._tenantId===(a.tenantId||null),a,"tenant-id-mismatch"),e.abrupt("return",wa(a,o));case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ja(e,t){return Ga.apply(this,arguments)}function Ga(){return(Ga=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or(n,"POST","/v1/accounts:createAuthUri",ar(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ka(){return(Ka=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){var i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Jn()?Xn():"http://localhost",a={identifier:r,continueUri:i},e.next=4,ja(Oe(n),a);case 4:return o=e.sent.signinMethods,e.abrupt("return",o||[]);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function za(){return(za=e(u)(e(s).mark((function t(n,r){var i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Oe(n),e.next=3,n.getIdToken();case 3:return a=e.sent,o={requestType:"VERIFY_EMAIL",idToken:a},r&&Da(i.auth,o,r),e.next=8,xi(i.auth,o);case 8:if(e.sent.email===n.email){e.next=12;break}return e.next=12,n.reload();case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Wa(){return(Wa=e(u)(e(s).mark((function t(n,r,i){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Oe(n),e.next=3,n.getIdToken();case 3:return o=e.sent,u={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:o,newEmail:r},i&&Da(a.auth,u,i),e.next=8,Ai(a.auth,u);case 8:if(e.sent.email===n.email){e.next=12;break}return e.next=12,n.reload();case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ha(e,t){return Qa.apply(this,arguments)}function Qa(){return(Qa=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or(n,"POST","/v1/accounts:update",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ya(){return(Ya=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n,r){var i,a,o,u,c,l,h;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.displayName,a=r.photoURL,void 0!==i||void 0!==a){e.next=3;break}return e.abrupt("return");case 3:return o=Oe(n),e.next=6,o.getIdToken();case 6:return u=e.sent,c={idToken:u,displayName:i,photoUrl:a,returnSecureToken:!0},e.next=10,Tr(o,Ha(o.auth,c));case 10:return l=e.sent,o.displayName=l.displayName||null,o.photoURL=l.photoUrl||null,(h=o.providerData.find((function(e){return"password"===e.providerId})))&&(h.displayName=o.displayName,h.photoURL=o.photoURL),e.next=17,o._updateTokensIfNecessary(l);case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Xa(e,t,n){return Ja.apply(this,arguments)}function Ja(){return(Ja=e(u)(e(s).mark((function t(n,r,i){var a,o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.auth,e.next=3,n.getIdToken();case 3:return o=e.sent,u={idToken:o,returnSecureToken:!0},r&&(u.email=r),i&&(u.password=i),e.next=9,Tr(n,vi(a,u));case 9:return c=e.sent,e.next=12,n._updateTokensIfNecessary(c,!0);case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Za=function t(n,r){"use strict";var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e(E)(this,t),this.isNewUser=n,this.providerId=r,this.profile=i},$a=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a,o){var u;return e(E)(this,r),(u=n.call(this,t,i,a)).username=o,u}return r}(Za),eo=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){return e(E)(this,r),n.call(this,t,"facebook.com",i)}return r}(Za),to=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){return e(E)(this,r),n.call(this,t,"github.com",i,"string"==typeof(null==i?void 0:i.login)?null==i?void 0:i.login:null)}return r}($a),no=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){return e(E)(this,r),n.call(this,t,"google.com",i)}return r}(Za),ro=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){return e(E)(this,r),n.call(this,t,"twitter.com",i,a)}return r}($a);function io(e){var t=e.user,n=e._tokenResponse;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;var r=e.providerId,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},a=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){var o=null===(n=null===(t=_r(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(o)return new Za(a,"anonymous"!==o&&"custom"!==o?o:null)}if(!r)return null;switch(r){case"facebook.com":return new eo(a,i);case"github.com":return new to(a,i);case"google.com":return new no(a,i);case"twitter.com":return new ro(a,i,e.screenName||null);case"custom":case"anonymous":return new Za(a,null);default:return new Za(a,r,i)}}(n)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ao=function(){"use strict";function t(n,r,i){e(E)(this,t),this.type=n,this.credential=r,this.auth=i}return e(S)(t,[{key:"toJSON",value:function(){var t="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:e(A)({},t,this.credential)}}}],[{key:"_fromIdtoken",value:function(e,n){return new t("enroll",e,n)}},{key:"_fromMfaPendingCredential",value:function(e){return new t("signin",e)}},{key:"fromJSON",value:function(e){var n,r;if(null==e?void 0:e.multiFactorSession){if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.pendingCredential)return t._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(r=e.multiFactorSession)||void 0===r?void 0:r.idToken)return t._fromIdtoken(e.multiFactorSession.idToken)}return null}}]),t}(),oo=function(){"use strict";function t(n,r,i){e(E)(this,t),this.session=n,this.hints=r,this.signInResolver=i}return e(S)(t,[{key:"resolveSignIn",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t,e.abrupt("return",n.signInResolver(i));case 2:case"end":return e.stop()}}),r)})))()}}],[{key:"_fromError",value:function(n,r){var i=oi(n),a=r.customData._serverResponse,o=(a.mfaInfo||[]).map((function(e){return Ca._fromServerResponse(i,e)}));zn(a.mfaPendingCredential,i,"internal-error");var c,l=ao._fromMfaPendingCredential(a.mfaPendingCredential);return new t(l,o,(c=e(u)(e(s).mark((function t(n){var o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._process(i,l);case 2:o=e.sent,delete a.mfaInfo,delete a.mfaPendingCredential,u=Object.assign(Object.assign({},a),{idToken:o.idToken,refreshToken:o.refreshToken}),e.t0=r.operationType,e.next="signIn"===e.t0?9:"reauthenticate"===e.t0?15:17;break;case 9:return e.next=11,ia._fromIdTokenResponse(i,r.operationType,u);case 11:return c=e.sent,e.next=14,i._updateCurrentUser(c.user);case 14:return e.abrupt("return",c);case 15:return zn(r.user,i,"internal-error"),e.abrupt("return",ia._forOperation(r.user,r.operationType,u));case 17:qn(i,"internal-error");case 18:case"end":return e.stop()}}),t)}))),function(e){return c.apply(this,arguments)}))}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function uo(e,t){return or(e,"POST","/v2/accounts/mfaEnrollment:start",ar(e,t))}var so=function(){"use strict";function t(n){var r=this;e(E)(this,t),this.user=n,this.enrolledFactors=[],n._onReload((function(e){e.mfaInfo&&(r.enrolledFactors=e.mfaInfo.map((function(e){return Ca._fromServerResponse(n.auth,e)})))}))}return e(S)(t,[{key:"getSession",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=ao,e.next=3,t.user.getIdToken();case 3:return e.t1=e.sent,e.t2=t.user.auth,e.abrupt("return",e.t0._fromIdtoken.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}}),n)})))()}},{key:"enroll",value:function(t,n){var r=this;return e(u)(e(s).mark((function i(){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,e.next=3,r.getSession();case 3:return o=e.sent,e.next=6,Tr(r.user,a._process(r.user.auth,o,n));case 6:return u=e.sent,e.next=9,r.user._updateTokensIfNecessary(u);case 9:return e.abrupt("return",r.user.reload());case 10:case"end":return e.stop()}}),i)})))()}},{key:"unenroll",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="string"==typeof t?t:t.uid,e.next=3,n.user.getIdToken();case 3:return a=e.sent,e.prev=4,e.next=7,Tr(n.user,or(r=n.user.auth,"POST","/v2/accounts/mfaEnrollment:withdraw",ar(r,{idToken:a,mfaEnrollmentId:i})));case 7:return o=e.sent,n.enrolledFactors=n.enrolledFactors.filter((function(e){return e.uid!==i})),e.next=11,n.user._updateTokensIfNecessary(o);case 11:return e.next=13,n.user.reload();case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(4),e.t0;case 18:case"end":return e.stop()}var r}),r,null,[[4,15]])})))()}}],[{key:"_fromUser",value:function(e){return new t(e)}}]),t}(),co=new WeakMap;var lo="__sak",ho=function(){"use strict";function t(n,r){e(E)(this,t),this.storageRetriever=n,this.type=r}return e(S)(t,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(lo,"1"),this.storage.removeItem(lo),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fo=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){var t,i;return e(E)(this,r),(t=n.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(e,n){return t.onStorageEvent(e,n)},t.listeners={},t.localCache={},t.pollTimer=null,t.safariLocalStorageNotSynced=(Wr(i=de())||Zr(i))&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),t.fallbackToPolling=ni(),t._shouldAllowMigration=!0,t}return e(S)(r,[{key:"forAllChangedKeys",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=Object.keys(this.listeners)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=this.storage.getItem(o),s=this.localCache[o];u!==s&&e(o,s,u)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"onStorageEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;if(e.key){var r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}var a=function(){var e=n.storage.getItem(r);(t||n.localCache[r]!==e)&&n.notifyListeners(r,e)},o=this.storage.getItem(r);ti()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else{var u=this;this.forAllChangedKeys((function(e,t,n){u.notifyListeners(e,n)}))}}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e],r=!0,i=!1,a=void 0;if(n)try{for(var o,u=Array.from(n)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){(0,o.value)(t?JSON.parse(t):t)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){var t=e;e.forAllChangedKeys((function(e,n,r){t.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(t,n){var i=this,a=this;return e(u)(e(s).mark((function o(){return e(s).wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e(fn)(e(pn)(r.prototype),"_set",i).call(a,t,n);case 2:a.localCache[t]=JSON.stringify(n);case 3:case"end":return o.stop()}}),o)})))()}},{key:"_get",value:function(t){var n=this,i=this;return e(u)(e(s).mark((function a(){var o;return e(s).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(fn)(e(pn)(r.prototype),"_get",n).call(i,t);case 2:return o=a.sent,i.localCache[t]=JSON.stringify(o),a.abrupt("return",o);case 5:case"end":return a.stop()}}),a)})))()}},{key:"_remove",value:function(t){var n=this,i=this;return e(u)(e(s).mark((function a(){return e(s).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(fn)(e(pn)(r.prototype),"_remove",n).call(i,t);case 2:delete i.localCache[t];case 3:case"end":return a.stop()}}),a)})))()}}]),r}(ho);fo.type="LOCAL";var vo=fo,po=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.call(this,(function(){return window.sessionStorage}),"SESSION")}return e(S)(r,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),r}(ho);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */po.type="SESSION";var yo=po;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(t){return Promise.all(t.map((n=e(u)(e(s).mark((function t(n){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n;case 3:return r=e.sent,e.abrupt("return",{fulfilled:!0,value:r});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),t,null,[[0,7]])}))),function(e){return n.apply(this,arguments)})));var n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var go=function(){"use strict";function t(n){e(E)(this,t),this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return e(S)(t,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a,o,c,l,h,f,d;return e(s).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=(i=t).data,o=a.eventId,c=a.eventType,l=a.data,null==(h=n.handlersMap[c])?void 0:h.size){r.next=5;break}return r.abrupt("return");case 5:return i.ports[0].postMessage({status:"ack",eventId:o,eventType:c}),f=Array.from(h).map(function(){var t=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n(i.origin,l));case 1:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.next=9,mo(f);case 9:d=r.sent,i.ports[0].postMessage({status:"done",eventId:o,eventType:c,response:d});case 11:case"end":return r.stop()}}),r)})))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(e){var n=this.receivers.find((function(t){return t.isListeningto(e)}));if(n)return n;var r=new t(e);return this.receivers.push(r),r}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ko(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */go.receivers=[];var wo=function(){"use strict";function t(n){e(E)(this,t),this.target=n,this.handlers=new Set}return e(S)(t,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=this;return e(u)(e(s).mark((function a(){var o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="undefined"!=typeof MessageChannel?new MessageChannel:null){e.next=3;break}throw new Error("connection_unavailable");case 3:return e.abrupt("return",new Promise((function(e,a){var s=ko("",20);o.port1.start();var l=setTimeout((function(){a(new Error("unsupported_event"))}),r);c={messageChannel:o,onMessage:function(t){var n=t;if(n.data.eventId===s)switch(n.data.status){case"ack":clearTimeout(l),u=setTimeout((function(){a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(u),e(n.data.response);break;default:clearTimeout(l),clearTimeout(u),a(new Error("invalid_response"))}}},i.handlers.add(c),o.port1.addEventListener("message",c.onMessage),i.target.postMessage({eventType:t,eventId:s,data:n},[o.port2])})).finally((function(){c&&i.removeMessageHandler(c)})));case 6:case"end":return e.stop()}}),a)})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bo(){return window}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function xo(){return void 0!==bo().WorkerGlobalScope&&"function"==typeof bo().importScripts}function Io(){return _o.apply(this,arguments)}function _o(){return(_o=e(u)(e(s).mark((function t(){var n;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return n=e.sent,e.abrupt("return",n.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),t,null,[[2,9]])})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var To="firebaseLocalStorageDb",Eo="firebaseLocalStorage",So="fbase_key",Ao=function(){"use strict";function t(n){e(E)(this,t),this.request=n}return e(S)(t,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){var r=e;e.request.addEventListener("success",(function(){t(r.request.result)})),e.request.addEventListener("error",(function(){n(r.request.error)}))}))}}]),t}();function Co(e,t){return e.transaction([Eo],t?"readwrite":"readonly").objectStore(Eo)}function No(){var e=indexedDB.deleteDatabase(To);return new Ao(e).toPromise()}function Do(){var t=indexedDB.open(To,1);return new Promise((function(n,r){t.addEventListener("error",(function(){r(t.error)})),t.addEventListener("upgradeneeded",(function(){var e=t.result;try{e.createObjectStore(Eo,{keyPath:So})}catch(e){r(e)}})),t.addEventListener("success",e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=t.result).objectStoreNames.contains(Eo)){e.next=12;break}return i.close(),e.next=5,No();case 5:return e.t0=n,e.next=8,Do();case 8:e.t1=e.sent,(0,e.t0)(e.t1),e.next=13;break;case 12:n(i);case 13:case"end":return e.stop()}}),r)}))))}))}function Ro(e,t,n){return Oo.apply(this,arguments)}function Oo(){return(Oo=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=Co(n,!0).put((a={},e(A)(a,So,r),e(A)(a,"value",i),a)),t.abrupt("return",new Ao(o).toPromise());case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Po(e,t){return Lo.apply(this,arguments)}function Lo(){return(Lo=e(u)(e(s).mark((function t(n,r){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Co(n,!1).get(r),e.next=3,new Ao(i).toPromise();case 3:return a=e.sent,e.abrupt("return",void 0===a?null:a.value);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Mo(e,t){var n=Co(e,!0).delete(t);return new Ao(n).toPromise()}var Fo=function(){"use strict";function t(){e(E)(this,t),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return e(S)(t,[{key:"_openDb",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.db){e.next=2;break}return e.abrupt("return",t.db);case 2:return e.next=4,Do();case 4:return t.db=e.sent,e.abrupt("return",t.db);case 6:case"end":return e.stop()}}),n)})))()}},{key:"_withRetries",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:return e.prev=2,e.next=5,n._openDb();case 5:return a=e.sent,e.next=8,t(a);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(i++>3)){e.next=15;break}throw e.t0;case 15:n.db&&(n.db.close(),n.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),r,null,[[2,11]])})))()}},{key:"initializeServiceWorkerMessaging",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xo()?t.initializeReceiver():t.initializeSender());case 1:case"end":return e.stop()}}),n)})))()}},{key:"initializeReceiver",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.receiver=go._getInstance(xo()?self:null),t.receiver._subscribe("keyChanged",function(){var n=e(u)(e(s).mark((function n(r,i){var a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return a=e.sent,e.abrupt("return",{keyProcessed:a.includes(i.key)});case 4:case"end":return e.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var t=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return n.stop()}}),n)})))()}},{key:"initializeSender",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Io();case 3:if(t.activeServiceWorker=e.sent,t.activeServiceWorker){e.next=6;break}return e.abrupt("return");case 6:return t.sender=new wo(t.activeServiceWorker),e.next=9,t.sender._send("ping",{},800);case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return");case 12:(null===(r=a[0])||void 0===r?void 0:r.fulfilled)&&(null===(i=a[0])||void 0===i?void 0:i.value.includes("keyChanged"))&&(t.serviceWorkerReceiverAvailable=!0);case 13:case"end":return e.stop()}}),n)})))()}},{key:"notifyServiceWorker",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.sender&&n.activeServiceWorker&&(r=void 0,((null===(r=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===r?void 0:r.controller)||null)===n.activeServiceWorker)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}var r}),r,null,[[2,7]])})))()}},{key:"_isAvailable",value:function(){return e(u)(e(s).mark((function t(){var n;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,Do();case 5:return n=e.sent,e.next=8,Ro(n,lo,"1");case 8:return e.next=10,Mo(n,lo);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),t,null,[[0,13]])})))()}},{key:"_withPendingWrite",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,n.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),r,null,[[1,,4,7]])})))()}},{key:"_set",value:function(t,n){var r=this;return e(u)(e(s).mark((function i(){return e(s).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",r._withPendingWrite(e(u)(e(s).mark((function i(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return Ro(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),i)})))));case 1:case"end":return i.stop()}}),i)})))()}},{key:"_get",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return Po(e,t)}));case 2:return i=e.sent,n.localCache[t]=i,e.abrupt("return",i);case 5:case"end":return e.stop()}}),r)})))()}},{key:"_remove",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return Mo(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),r)})))));case 1:case"end":return r.stop()}}),r)})))()}},{key:"_poll",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i,a,o,u,c,l,h,f,d,v,p,y,m,g,k,w;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._withRetries((function(e){var t=Co(e,!1).getAll();return new Ao(t).toPromise()}));case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===t.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:for(i=[],a=new Set,o=!0,u=!1,c=void 0,e.prev=10,l=r[Symbol.iterator]();!(o=(h=l.next()).done);o=!0)f=h.value,d=f.fbase_key,v=f.value,a.add(d),JSON.stringify(t.localCache[d])!==JSON.stringify(v)&&(t.notifyListeners(d,v),i.push(d));e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),u=!0,c=e.t0;case 18:e.prev=18,e.prev=19,o||null==l.return||l.return();case 21:if(e.prev=21,!u){e.next=24;break}throw c;case 24:return e.finish(21);case 25:return e.finish(18);case 26:for(p=!0,y=!1,m=void 0,e.prev=27,g=Object.keys(t.localCache)[Symbol.iterator]();!(p=(k=g.next()).done);p=!0)w=k.value,t.localCache[w]&&!a.has(w)&&(t.notifyListeners(w,null),i.push(w));e.next=35;break;case 31:e.prev=31,e.t1=e.catch(27),y=!0,m=e.t1;case 35:e.prev=35,e.prev=36,p||null==g.return||g.return();case 38:if(e.prev=38,!y){e.next=41;break}throw m;case 41:return e.finish(38);case 42:return e.finish(35);case 43:return e.abrupt("return",i);case 44:case"end":return e.stop()}}),n,null,[[10,14,18,26],[19,,21,25],[27,31,35,43],[36,,38,42]])})))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e],r=!0,i=!1,a=void 0;if(n)try{for(var o,u=Array.from(n)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){(0,o.value)(t)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"startPolling",value:function(){this.stopPolling();var t=this;this.pollTimer=setInterval(e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t._poll());case 1:case"end":return e.stop()}}),n)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),t}();Fo.type="LOCAL";var Vo=Fo;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(e,t){return or(e,"POST","/v2/accounts/mfaSignIn:start",ar(e,t))}function qo(e){return Bo.apply(this,arguments)}function Bo(){return(Bo=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,or(n,"GET","/v1/recaptchaParams");case 2:if(e.t0=e.sent.recaptchaSiteKey,e.t0){e.next=5;break}e.t0="";case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jo(e){return new Promise((function(t,n){var r,i,a=document.createElement("script");a.setAttribute("src",e),a.onload=t,a.onerror=function(e){var t=Bn("internal-error");t.customData=e,n(t)},a.type="text/javascript",a.charset="UTF-8",(null!==(i=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==i?i:document).appendChild(a)}))}function Go(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ko=1e12,zo=function(){"use strict";function t(n){e(E)(this,t),this.auth=n,this.counter=Ko,this._widgets=new Map}return e(S)(t,[{key:"render",value:function(e,t){var n=this.counter;return this._widgets.set(n,new Wo(e,this.auth.name,t||{})),this.counter++,n}},{key:"reset",value:function(e){var t,n=e||Ko;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}},{key:"getResponse",value:function(e){var t,n=e||Ko;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}},{key:"execute",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t||Ko,null===(i=n._widgets.get(a))||void 0===i||i.execute(),e.abrupt("return","");case 4:case"end":return e.stop()}}),r)})))()}}]),t}(),Wo=function(){"use strict";function t(n,r,i){var a=this;e(E)(this,t),this.params=i,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=function(){a.execute()};var o="string"==typeof n?document.getElementById(n):n;zn(o,"argument-error",{appName:r}),this.container=o,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}return e(S)(t,[{key:"getResponse",value:function(){return this.checkIfDeleted(),this.responseToken}},{key:"delete",value:function(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}},{key:"execute",value:function(){var e=this;this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((function(){var t=e;e.responseToken=function(e){for(var t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(50);var n=e.params,r=n.callback,i=n["expired-callback"];if(r)try{r(e.responseToken)}catch(e){}e.timerId=window.setTimeout((function(){if(t.timerId=null,t.responseToken=null,i)try{i()}catch(e){}t.isVisible&&t.execute()}),6e4)}),500))}},{key:"checkIfDeleted",value:function(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}]),t}();var Ho=Go("rcb"),Qo=new $n(3e4,6e4),Yo="https://www.google.com/recaptcha/api.js?",Xo=function(){"use strict";function t(){var n;e(E)(this,t),this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(n=bo().grecaptcha)||void 0===n?void 0:n.render)}return e(S)(t,[{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this;return zn(Jo(t),e,"argument-error"),this.shouldResolveImmediately(t)?Promise.resolve(bo().grecaptcha):new Promise((function(r,i){var a=n,o=bo().setTimeout((function(){i(Bn(e,"network-request-failed"))}),Qo.get());bo()[Ho]=function(){var n=a;bo().clearTimeout(o),delete bo()[Ho];var u=bo().grecaptcha;if(u){var s=u.render;u.render=function(e,t){var r=s(e,t);return n.counter++,r},a.hostLanguage=t,r(u)}else i(Bn(e,"internal-error"))},jo("".concat(Yo,"?").concat(Se({onload:Ho,render:"explicit",hl:t}))).catch((function(){clearTimeout(o),i(Bn(e,"internal-error"))}))}))}},{key:"clearedOneInstance",value:function(){this.counter--}},{key:"shouldResolveImmediately",value:function(e){var t;return!!(null===(t=bo().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}]),t}();function Jo(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}var Zo=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,[{key:"load",value:function(t){return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new zo(t));case 1:case"end":return e.stop()}}),n)})))()}},{key:"clearedOneInstance",value:function(){}}]),t}(),$o="recaptcha",eu={theme:"light",type:"image"},tu=function(){"use strict";function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.assign({},eu),i=arguments.length>2?arguments[2]:void 0;e(E)(this,t),this.parameters=r,this.type=$o,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=oi(i),this.isInvisible="invisible"===this.parameters.size,zn("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");var a="string"==typeof n?document.getElementById(n):n;zn(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Zo:new Xo,this.validateStartingState()}return e(S)(t,[{key:"verify",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assertNotDestroyed(),e.next=3,t.render();case 3:if(r=e.sent,i=t.getAssertedRecaptcha(),!(a=i.getResponse(r))){e.next=8;break}return e.abrupt("return",a);case 8:return e.abrupt("return",new Promise((function(e){var n=function(r){r&&(t.tokenChangeListeners.delete(n),e(r))};t.tokenChangeListeners.add(n),t.isInvisible&&i.execute(r)})));case 9:case"end":return e.stop()}}),n)})))()}},{key:"render",value:function(){var e=this;try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((function(t){throw e.renderPromise=null,t}))),this.renderPromise}},{key:"_reset",value:function(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}},{key:"clear",value:function(){var e=this;this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((function(t){e.container.removeChild(t)}))}},{key:"validateStartingState",value:function(){zn(!this.parameters.sitekey,this.auth,"argument-error"),zn(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),zn("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}},{key:"makeTokenCallback",value:function(e){var t=this;return function(n){if(t.tokenChangeListeners.forEach((function(e){return e(n)})),"function"==typeof e)e(n);else if("string"==typeof e){var r=bo()[e];"function"==typeof r&&r(n)}}}},{key:"assertNotDestroyed",value:function(){zn(!this.destroyed,this.auth,"internal-error")}},{key:"makeRenderPromise",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:return t.widgetId||(r=t.container,t.isInvisible||(i=document.createElement("div"),r.appendChild(i),r=i),t.widgetId=t.getAssertedRecaptcha().render(r,t.parameters)),e.abrupt("return",t.widgetId);case 4:case"end":return e.stop()}}),n)})))()}},{key:"init",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return zn(Jn()&&!xo(),t.auth,"internal-error"),e.next=3,nu();case 3:return e.next=5,t._recaptchaLoader.load(t.auth,t.auth.languageCode||void 0);case 5:return t.recaptcha=e.sent,e.next=8,qo(t.auth);case 8:zn(r=e.sent,t.auth,"internal-error"),t.parameters.sitekey=r;case 11:case"end":return e.stop()}}),n)})))()}},{key:"getAssertedRecaptcha",value:function(){return zn(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(){var e=null;return new Promise((function(t){"complete"!==document.readyState?(e=function(){return t()},window.addEventListener("load",e)):t()})).catch((function(t){throw e&&window.removeEventListener("load",e),t}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ru=function(){"use strict";function t(n,r){e(E)(this,t),this.verificationId=n,this.onConfirmation=r}return e(S)(t,[{key:"confirm",value:function(e){var t=Ki._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}]),t}();function iu(){return(iu=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=oi(n),e.next=3,su(a,r,Oe(i));case 3:return o=e.sent,e.abrupt("return",new ru(o,(function(e){return wa(a,e)})));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function au(e,t,n){return ou.apply(this,arguments)}function ou(){return(ou=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Oe(n),e.next=3,va(!1,a,"phone");case 3:return e.next=5,su(a.auth,r,Oe(i));case 5:return o=e.sent,e.abrupt("return",new ru(o,(function(e){return xa(a,e)})));case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function uu(){return(uu=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Oe(n),e.next=3,su(a.auth,r,Oe(i));case 3:return o=e.sent,e.abrupt("return",new ru(o,(function(e){return _a(a,e)})));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function su(e,t,n){return cu.apply(this,arguments)}function cu(){return(cu=e(u)(e(s).mark((function t(n,r,i){var a,o,u,c,l,h,f,d;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,i.verify();case 3:if(o=e.sent,e.prev=4,zn("string"==typeof o,n,"argument-error"),zn(i.type===$o,n,"argument-error"),!("session"in(u="string"==typeof r?{phoneNumber:r}:r))){e.next=28;break}if(c=u.session,!("phoneNumber"in u)){e.next=19;break}return zn("enroll"===c.type,n,"internal-error"),e.next=15,uo(n,{idToken:c.credential,phoneEnrollmentInfo:{phoneNumber:u.phoneNumber,recaptchaToken:o}});case 15:return l=e.sent,e.abrupt("return",l.phoneSessionInfo.sessionInfo);case 19:return zn("signin"===c.type,n,"internal-error"),zn(h=(null===(a=u.multiFactorHint)||void 0===a?void 0:a.uid)||u.multiFactorUid,n,"missing-multi-factor-info"),e.next=24,Uo(n,{mfaPendingCredential:c.credential,mfaEnrollmentId:h,phoneSignInInfo:{recaptchaToken:o}});case 24:return f=e.sent,e.abrupt("return",f.phoneResponseInfo.sessionInfo);case 26:e.next=32;break;case 28:return e.next=30,Vi(n,{phoneNumber:u.phoneNumber,recaptchaToken:o});case 30:return d=e.sent.sessionInfo,e.abrupt("return",d);case 32:return e.prev=32,i._reset(),e.finish(32);case 35:case"end":return e.stop()}}),t,null,[[4,,32,35]])})))).apply(this,arguments)}function lu(){return(lu=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fa(Oe(n),r);case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hu=function(){"use strict";function t(n){e(E)(this,t),this.providerId=t.PROVIDER_ID,this.auth=oi(n)}return e(S)(t,[{key:"verifyPhoneNumber",value:function(e,t){return su(this.auth,e,Oe(t))}}],[{key:"credential",value:function(e,t){return Ki._fromVerification(e,t)}},{key:"credentialFromResult",value:function(e){var n=e;return t.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(e){return t.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?Ki._fromTokenResponse(n,r):null}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function fu(e,t){return t?Yn(t):(zn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hu.PROVIDER_ID="phone",hu.PHONE_SIGN_IN_METHOD="phone";var du=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this,"custom","custom")).params=t,i}return e(S)(r,[{key:"_getIdTokenResponse",value:function(e){return Li(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return Li(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return Li(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),r}(hi);function vu(e){return ga(e.auth,new du(e),e.bypassAuthState)}function pu(e){var t=e.auth,n=e.user;return zn(n,t,"internal-error"),ya(n,new du(e),e.bypassAuthState)}function yu(e){return mu.apply(this,arguments)}function mu(){return(mu=e(u)(e(s).mark((function t(n){var r,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.auth,zn(i=n.user,r,"internal-error"),e.abrupt("return",fa(i,new du(n),n.bypassAuthState));case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gu=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];e(E)(this,t),this.auth=n,this.resolver=i,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}return e(S)(t,[{key:"execute",value:function(){var t,n=this;return new Promise((t=e(u)(e(s).mark((function t(r,i){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.pendingPromise={resolve:r,reject:i},e.prev=1,e.next=4,n.resolver._initialize(n.auth);case 4:return n.eventManager=e.sent,e.next=7,n.onExecution();case 7:n.eventManager.registerConsumer(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),n.reject(e.t0);case 13:case"end":return e.stop()}}),t,null,[[1,10]])}))),function(e,n){return t.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a,o,u,c,l,h;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.urlResponse,a=t.sessionId,o=t.postBody,u=t.tenantId,c=t.error,l=t.type,!c){e.next=4;break}return n.reject(c),e.abrupt("return");case 4:return h={auth:n.auth,requestUri:i,sessionId:a,tenantId:u||void 0,postBody:o||void 0,user:n.user,bypassAuthState:n.bypassAuthState},e.prev=5,e.t0=n,e.next=9,n.getIdpTask(l)(h);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),n.reject(e.t2);case 16:case"end":return e.stop()}}),r,null,[[5,13]])})))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vu;case"linkViaPopup":case"linkViaRedirect":return yu;case"reauthViaPopup":case"reauthViaRedirect":return pu;default:qn(this.auth,"internal-error")}}},{key:"resolve",value:function(e){Hn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){Hn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),t}(),ku=new $n(2e3,1e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wu(e,t,n){return bu.apply(this,arguments)}function bu(){return(bu=e(u)(e(s).mark((function t(n,r,i){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=oi(n),Gn(n,r,Hi),o=fu(a,i),u=new Tu(a,"signInViaPopup",r,o),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function xu(){return(xu=e(u)(e(s).mark((function t(n,r,i){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Gn((a=Oe(n)).auth,r,Hi),o=fu(a.auth,i),u=new Tu(a.auth,"reauthViaPopup",r,o,a),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Iu(e,t,n){return _u.apply(this,arguments)}function _u(){return(_u=e(u)(e(s).mark((function t(n,r,i){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Gn((a=Oe(n)).auth,r,Hi),o=fu(a.auth,i),u=new Tu(a.auth,"linkViaPopup",r,o,a),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var Tu=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a,o,u){var s;return e(E)(this,r),(s=n.call(this,t,i,o,u)).provider=a,s.authWindow=null,s.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=e(C)(s),s}return e(S)(r,[{key:"executeNotNull",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.execute();case 2:return zn(r=e.sent,t.auth,"internal-error"),e.abrupt("return",r);case 5:case"end":return e.stop()}}),n)})))()}},{key:"onExecution",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Hn(1===t.filter.length,"Popup operations only handle one event"),r=ko(),e.next=4,t.resolver._openPopup(t.auth,t.provider,t.filter[0],r);case 4:t.authWindow=e.sent,t.authWindow.associatedEvent=r,t.resolver._originValidation(t.auth).catch((function(e){t.reject(e)})),t.resolver._isIframeWebStorageSupported(t.auth,(function(e){e||t.reject(Bn(t.auth,"web-storage-unsupported"))})),t.pollUserCancellation();case 9:case"end":return e.stop()}}),n)})))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(Bn(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this,t=function(){var n,r;if(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed){var i=e;e.pollId=window.setTimeout((function(){i.pollId=null,i.reject(Bn(i.auth,"popup-closed-by-user"))}),2e3)}else e.pollId=window.setTimeout(t,ku.get())};t()}}]),r}(gu);Tu.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Eu=new Map,Su=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(E)(this,r),(a=n.call(this,t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],i,void 0,o)).eventId=null,a}return e(S)(r,[{key:"execute",value:function(){var t=this,n=this;return e(u)(e(s).mark((function i(){var a,o;return e(s).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=Eu.get(n.auth._key())){i.next=21;break}return i.prev=2,i.next=5,Au(n.resolver,n.auth);case 5:if(!i.sent){i.next=12;break}return i.next=9,e(fn)(e(pn)(r.prototype),"execute",t).call(n);case 9:i.t0=i.sent,i.next=13;break;case 12:i.t0=null;case 13:o=i.t0,a=function(){return Promise.resolve(o)},i.next=20;break;case 17:i.prev=17,i.t1=i.catch(2),a=function(){return Promise.reject(i.t1)};case 20:Eu.set(n.auth._key(),a);case 21:return n.bypassAuthState||Eu.set(n.auth._key(),(function(){return Promise.resolve(null)})),i.abrupt("return",a());case 23:case"end":return i.stop()}}),i,null,[[2,17]])})))()}},{key:"onAuthEvent",value:function(t){var n=this,i=this,a=function(){return e(fn)(e(pn)(r.prototype),"onAuthEvent",n)};return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",a().call(i,t));case 4:if("unknown"!==t.type){e.next=7;break}return i.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,i.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return i.user=r,e.abrupt("return",a().call(i,t));case 16:i.resolve(null);case 17:case"end":return e.stop()}}),n)})))()}},{key:"onExecution",value:function(){return e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)})))()}},{key:"cleanUp",value:function(){}}]),r}(gu);function Au(e,t){return Cu.apply(this,arguments)}function Cu(){return(Cu=e(u)(e(s).mark((function t(n,r){var i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Pu(r),a=Ou(n),e.next=4,a._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,a._get(i);case 8:return e.t0=e.sent,o="true"===e.t0,e.next=12,a._remove(i);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Nu(e,t){return Du.apply(this,arguments)}function Du(){return(Du=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ou(n)._set(Pu(r),"true"));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ru(e,t){Eu.set(e._key(),t)}function Ou(e){return Yn(e._redirectPersistence)}function Pu(e){return jr("pendingRedirect",e.config.apiKey,e.name)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(e,t,n){return function(e,t,n){return Mu.apply(this,arguments)}(e,t,n)}function Mu(){return(Mu=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=oi(n),Gn(n,r,Hi),e.next=4,a._initializationPromise;case 4:return o=fu(a,i),e.next=7,Nu(o,a);case 7:return e.abrupt("return",o._openRedirect(a,r,"signInViaRedirect"));case 8:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Fu(e,t,n){return function(e,t,n){return Vu.apply(this,arguments)}(e,t,n)}function Vu(){return(Vu=e(u)(e(s).mark((function t(n,r,i){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Gn((a=Oe(n)).auth,r,Hi),e.next=4,a.auth._initializationPromise;case 4:return o=fu(a.auth,i),e.next=7,Nu(o,a.auth);case 7:return e.next=9,zu(a);case 9:return u=e.sent,e.abrupt("return",o._openRedirect(a.auth,r,"reauthViaRedirect",u));case 11:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Uu(e,t,n){return function(e,t,n){return qu.apply(this,arguments)}(e,t,n)}function qu(){return(qu=e(u)(e(s).mark((function t(n,r,i){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Gn((a=Oe(n)).auth,r,Hi),e.next=4,a.auth._initializationPromise;case 4:return o=fu(a.auth,i),e.next=7,va(!1,a,r.providerId);case 7:return e.next=9,Nu(o,a.auth);case 9:return e.next=11,zu(a);case 11:return u=e.sent,e.abrupt("return",o._openRedirect(a.auth,r,"linkViaRedirect",u));case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Bu(e,t){return ju.apply(this,arguments)}function ju(){return(ju=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oi(n)._initializationPromise;case 2:return e.abrupt("return",Gu(n,r,!1));case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Gu(e,t){return Ku.apply(this,arguments)}function Ku(){return Ku=e(u)(e(s).mark((function t(n,r){var i,a,o,u,c,l=arguments;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.length>2&&void 0!==l[2]&&l[2],a=oi(n),o=fu(a,r),u=new Su(a,o,i),e.next=6,u.execute();case 6:if(!(c=e.sent)||i){e.next=13;break}return delete c.user._redirectEventId,e.next=11,a._persistUserIfCurrent(c.user);case 11:return e.next=13,a._setRedirectUser(null,r);case 13:return e.abrupt("return",c);case 14:case"end":return e.stop()}}),t)}))),Ku.apply(this,arguments)}function zu(e){return Wu.apply(this,arguments)}function Wu(){return(Wu=e(u)(e(s).mark((function t(n){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ko("".concat(n.uid,":::")),n._redirectEventId=r,e.next=4,n.auth._setRedirectUser(n);case 4:return e.next=6,n.auth._persistUserIfCurrent(n);case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hu=function(){"use strict";function t(n){e(E)(this,t),this.auth=n,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return e(S)(t,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Yu(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!Yu(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Bn(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qu(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(Qu(e)),this.lastProcessedEventTime=Date.now()}}]),t}();function Qu(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function Yu(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function Xu(e){return Ju.apply(this,arguments)}function Ju(){return Ju=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n){var r,i=arguments;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.abrupt("return",or(n,"GET","/v1/projects",r));case 2:case"end":return e.stop()}}),t)}))),Ju.apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zu=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$u=/^https?/;function es(){return(es=e(u)(e(s).mark((function t(n){var r,i,a,o,u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Xu(n);case 4:r=e.sent.authorizedDomains,i=!0,a=!1,o=void 0,e.prev=6,u=r[Symbol.iterator]();case 8:if(i=(c=u.next()).done){e.next=20;break}if(l=c.value,e.prev=10,!ts(l)){e.next=13;break}return e.abrupt("return");case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(10);case 17:i=!0,e.next=8;break;case 20:e.next=26;break;case 22:e.prev=22,e.t1=e.catch(6),a=!0,o=e.t1;case 26:e.prev=26,e.prev=27,i||null==u.return||u.return();case 29:if(e.prev=29,!a){e.next=32;break}throw o;case 32:return e.finish(29);case 33:return e.finish(26);case 34:qn(n,"unauthorized-domain");case 35:case"end":return e.stop()}}),t,null,[[6,22,26,34],[10,15],[27,,29,33]])})))).apply(this,arguments)}function ts(e){var t=Xn(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!$u.test(r))return!1;if(Zu.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ns=new $n(3e4,6e4);function rs(){var t=bo().___jsl,n=!0,r=!1,i=void 0;if(null==t?void 0:t.H)try{for(var a,o=Object.keys(t.H)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(t.H[u].r=t.H[u].r||[],t.H[u].L=t.H[u].L||[],t.H[u].r=e(R)(t.H[u].L),t.CP)for(var s=0;s<t.CP.length;s++)t.CP[s]=null}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}var is=null;function as(e){return is=is||function(e){return new Promise((function(t,n){var r,i,a;function o(){rs(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){rs(),n(Bn(e,"network-request-failed"))},timeout:ns.get()})}if(null===(i=null===(r=bo().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=bo().gapi)||void 0===a?void 0:a.load)){var u=Go("iframefcb");return bo()[u]=function(){gapi.load?o():n(Bn(e,"network-request-failed"))},jo("https://apis.google.com/js/api.js?onload=".concat(u)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw is=null,e}))}(e),is}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var os=new $n(5e3,15e3),us={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ss=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function cs(e){var t=e.config;zn(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?er(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:Pt},i=ss.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(Se(r).slice(1))}function ls(e){return hs.apply(this,arguments)}function hs(){return hs=e(u)(e(s).mark((function t(n){var r,i;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,as(n);case 2:return r=t.sent,zn(i=bo().gapi,n,"internal-error"),t.abrupt("return",r.open({where:document.body,url:cs(n),messageHandlersFilter:i.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:us,dontclear:!0},(function(t){return new Promise((r=e(u)(e(s).mark((function r(i,a){var o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(){bo().clearTimeout(u),i(t)},e.next=3,t.restyle({setHideOnLeave:!1});case 3:o=Bn(n,"network-request-failed"),u=bo().setTimeout((function(){a(o)}),os.get()),t.ping(c).then(c,(function(){a(o)}));case 7:case"end":return e.stop()}}),r)}))),function(e,t){return r.apply(this,arguments)}));var r})));case 6:case"end":return t.stop()}}),t)}))),hs.apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fs={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ds="_blank",vs="http://localhost",ps=function(){"use strict";function t(n){e(E)(this,t),this.window=n,this.associatedEvent=null}return e(S)(t,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),t}();function ys(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,o=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString(),s="",c=Object.assign(Object.assign({},fs),{width:i.toString(),height:a.toString(),top:o,left:u}),l=de().toLowerCase();r&&(s=Hr(l)?ds:r),zr(l)&&(n=n||vs,c.scrollbars="yes");var h=Object.entries(c).reduce((function(t,n){var r=e(D)(n,2),i=r[0],a=r[1];return"".concat(t).concat(i,"=").concat(a,",")}),"");if(ei(l)&&"_self"!==s)return ms(n||"",s),new ps(null);var f=window.open(n||"",s,h);zn(f,t,"popup-blocked");try{f.focus()}catch(e){}return new ps(f)}function ms(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gs="__/auth/handler",ks="emulator/auth/handler";function ws(t,n,r,i,a,o){zn(t.config.authDomain,t,"auth-domain-config-required"),zn(t.config.apiKey,t,"invalid-api-key");var u={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:i,v:Pt,eventId:a};if(n instanceof Hi){n.setDefaultLanguage(t.languageCode),u.providerId=n.providerId||"",_e(n.getCustomParameters())||(u.customParameters=JSON.stringify(n.getCustomParameters()));var s=!0,c=!1,l=void 0;try{for(var h,f=Object.entries(o||{})[Symbol.iterator]();!(s=(h=f.next()).done);s=!0){var d=e(D)(h.value,2),v=d[0],p=d[1];u[v]=p}}catch(e){c=!0,l=e}finally{try{s||null==f.return||f.return()}finally{if(c)throw l}}}if(n instanceof Qi){var y=n.getScopes().filter((function(e){return""!==e}));y.length>0&&(u.scopes=y.join(","))}t.tenantId&&(u.tid=t.tenantId);var m,g,k=u,w=!0,b=!1,x=void 0;try{for(var I,_=Object.keys(k)[Symbol.iterator]();!(w=(I=_.next()).done);w=!0){var T=I.value;void 0===k[T]&&delete k[T]}}catch(e){b=!0,x=e}finally{try{w||null==_.return||_.return()}finally{if(b)throw x}}return"".concat((m=t,g=m.config,g.emulator?er(g,ks):"https://".concat(g.authDomain,"/").concat(gs)),"?").concat(Se(k).slice(1))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var bs="webStorageSupport",xs=function(){"use strict";function t(){e(E)(this,t),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yo,this._completeRedirectFn=Gu,this._overrideRedirectResult=Ru}return e(S)(t,[{key:"_openPopup",value:function(t,n,r,i){var a=this;return e(u)(e(s).mark((function o(){var u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Hn(null===(u=a.eventManagers[t._key()])||void 0===u?void 0:u.manager,"_initialize() not called before _openPopup()"),c=ws(t,n,r,Xn(),i),e.abrupt("return",ys(t,c,ko()));case 4:case"end":return e.stop()}}),o)})))()}},{key:"_openRedirect",value:function(t,n,r,i){var a=this;return e(u)(e(s).mark((function o(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a._originValidation(t);case 2:return o=ws(t,n,r,Xn(),i),bo().location.href=o,e.abrupt("return",new Promise((function(){})));case 4:case"end":return e.stop()}var o}),o)})))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(Hn(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ls(t);case 2:return i=e.sent,a=new Hu(t),i.register("authEvent",(function(e){return zn(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:a.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),n.eventManagers[t._key()]={manager:a},n.iframes[t._key()]=i,e.abrupt("return",a);case 8:case"end":return e.stop()}}),r)})))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(bs,{type:bs},(function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),qn(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return es.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return ni()||Wr()||Zr()}}]),t}(),Is=xs,_s=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this,"phone")).credential=t,i}return e(S)(r,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return or(e,"POST","/v2/accounts/mfaEnrollment:finalize",ar(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return or(e,"POST","/v2/accounts/mfaSignIn:finalize",ar(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new r(e)}}]),r}(function(){"use strict";function t(n){e(E)(this,t),this.factorId=n}return e(S)(t,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Wn("unexpected MultiFactorSessionType")}}}]),t}()),Ts=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,null,[{key:"assertion",value:function(e){return _s._fromCredential(e)}}]),t}();Ts.FACTOR_ID="phone";var Es="@firebase/auth",Ss="0.21.3",As=function(){"use strict";function t(n){e(E)(this,t),this.auth=n,this.internalListeners=new Map}return e(S)(t,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.assertAuthConfigured(),e.next=3,n.auth._initializationPromise;case 3:if(n.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,n.auth.currentUser.getIdToken(t);case 7:return i=e.sent,e.abrupt("return",{accessToken:i});case 9:case"end":return e.stop()}}),r)})))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){zn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Cs;le("authIdTokenMaxAge");
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ns(){return window}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cs="Browser",St(new Pe("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=r.options,o=a.apiKey,u=a.authDomain;return function(e,t){zn(o&&!o.includes(":"),"invalid-api-key",{appName:e.name}),zn(!(null==u?void 0:u.includes(":")),"argument-error",{appName:e.name});var r={apiKey:o,authDomain:u,clientPlatform:Cs,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ri(Cs)},i=new ai(e,t,r);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Yn);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(i,n),i}(r,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),St(new Pe("auth-internal",(function(e){var t=oi(e.getProvider("auth").getImmediate());return new As(t)}),"PRIVATE").setInstantiationMode("EXPLICIT")),qt(Es,Ss,
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Cs)),qt(Es,Ss,"esm2017");function Ds(e,t,n){return Rs.apply(this,arguments)}function Rs(){return(Rs=e(u)(e(s).mark((function t(n,r,i){var a,o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Ns().BuildInfo,Hn(r.sessionId,"AuthEvent did not contain a session ID"),e.next=5,Vs(r.sessionId);case 5:return u=e.sent,c={},Zr()?c.ibi=o.packageName:Yr()?c.apn=o.packageName:qn(n,"operation-not-supported-in-this-environment"),o.displayName&&(c.appDisplayName=o.displayName),c.sessionId=u,e.abrupt("return",ws(n,i,r.type,void 0,null!==(a=r.eventId)&&void 0!==a?a:void 0,c));case 11:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Os(){return(Os=e(u)(e(s).mark((function t(n){var r,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ns().BuildInfo,i={},Zr()?i.iosBundleId=r.packageName:Yr()?i.androidPackageName=r.packageName:qn(n,"operation-not-supported-in-this-environment"),e.next=5,Xu(n,i);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ps(e){var t=Ns().cordova;return new Promise((function(n){t.plugins.browsertab.isAvailable((function(r){var i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,$r()?"_blank":"_system","location=yes"),n(i)}))}))}function Ls(e,t,n){return Ms.apply(this,arguments)}function Ms(){return(Ms=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Ns().cordova,o=function(){},e.prev=2,e.next=5,new Promise((function(e,t){var u=null;function s(){var t;e();var n=null===(t=a.plugins.browsertab)||void 0===t?void 0:t.close;"function"==typeof n&&n(),"function"==typeof(null==i?void 0:i.close)&&i.close()}function c(){u||(u=window.setTimeout((function(){t(Bn(n,"redirect-cancelled-by-user"))}),2e3))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&c()}r.addPassiveListener(s),document.addEventListener("resume",c,!1),Yr()&&document.addEventListener("visibilitychange",l,!1),o=function(){r.removePassiveListener(s),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",l,!1),u&&window.clearTimeout(u)}}));case 5:return e.prev=5,o(),e.finish(5);case 8:case"end":return e.stop()}}),t,null,[[2,,5,8]])})))).apply(this,arguments)}function Fs(e){var t,n,r,i,a,o,u,s,c,l,h=Ns();zn("function"==typeof(null===(t=null==h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),zn(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),zn("function"==typeof(null===(a=null===(i=null===(r=null==h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===a?void 0:a.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),zn("function"==typeof(null===(s=null===(u=null===(o=null==h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===u?void 0:u.browsertab)||void 0===s?void 0:s.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),zn("function"==typeof(null===(l=null===(c=null==h?void 0:h.cordova)||void 0===c?void 0:c.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function Vs(e){return Us.apply(this,arguments)}function Us(){return(Us=e(u)(e(s).mark((function t(n){var r,i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=qs(n),e.next=3,crypto.subtle.digest("SHA-256",r);case 3:return i=e.sent,a=Array.from(new Uint8Array(i)),e.abrupt("return",a.map((function(e){return e.toString(16).padStart(2,"0")})).join(""));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function qs(e){if(Hn(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bs=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){var t;return e(E)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).passiveListeners=new Set,t.initPromise=new Promise((function(e){t.resolveInialized=e})),t}return e(S)(r,[{key:"addPassiveListener",value:function(e){this.passiveListeners.add(e)}},{key:"removePassiveListener",value:function(e){this.passiveListeners.delete(e)}},{key:"resetRedirect",value:function(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}},{key:"onEvent",value:function(t){return this.resolveInialized(),this.passiveListeners.forEach((function(e){return e(t)})),e(fn)(e(pn)(r.prototype),"onEvent",this).call(this,t)}},{key:"initialized",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initPromise;case 2:case"end":return e.stop()}}),n)})))()}}]),r}(Hu);function js(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:t,eventId:n,urlResponse:null,sessionId:Hs(),postBody:null,tenantId:e.tenantId,error:Bn(e,"no-auth-event")}}function Gs(e,t){return Qs()._set(Ys(e),t)}function Ks(e){return zs.apply(this,arguments)}function zs(){return(zs=e(u)(e(s).mark((function t(n){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qs()._get(Ys(n));case 2:if(!(r=e.sent)){e.next=6;break}return e.next=6,Qs()._remove(Ys(n));case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ws(e,t){var n,r,i=function(e){var t=Xs(e),n=t.link?decodeURIComponent(t.link):void 0,r=Xs(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return Xs(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){var a=Xs(i),o=a.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(a.firebaseError)):null,u=null===(r=null===(n=null==o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],s=u?Bn(u):null;return s?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:s,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function Hs(){for(var e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0;n<20;n++){var r=Math.floor(Math.random()*t.length);e.push(t.charAt(r))}return e.join("")}function Qs(){return Yn(vo)}function Ys(e){return jr("authEvent",e.config.apiKey,e.name)}function Xs(t){if(!(null==t?void 0:t.includes("?")))return{};var n=e(yn)(t.split("?"));n[0];return Ae(n.slice(1).join("?"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Js=function(){"use strict";function t(){e(E)(this,t),this._redirectPersistence=yo,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Gu,this._overrideRedirectResult=Ru}return e(S)(t,[{key:"_initialize",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t._key(),(a=n.eventManagers.get(i))||(a=new Bs(t),n.eventManagers.set(i,a),n.attachCallbackListeners(t,a)),e.abrupt("return",a);case 4:case"end":return e.stop()}}),r)})))()}},{key:"_openPopup",value:function(e){qn(e,"operation-not-supported-in-this-environment")}},{key:"_openRedirect",value:function(t,n,r,i){var a=this;return e(u)(e(s).mark((function o(){var u,c,l,h;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Fs(t),e.next=3,a._initialize(t);case 3:return u=e.sent,e.next=6,u.initialized();case 6:return u.resetRedirect(),Eu.clear(),e.next=10,a._originValidation(t);case 10:return c=js(t,r,i),e.next=13,Gs(t,c);case 13:return e.next=15,Ds(t,c,n);case 15:return l=e.sent,e.next=18,Ps(l);case 18:return h=e.sent,e.abrupt("return",Ls(t,u,h));case 20:case"end":return e.stop()}}),o)})))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){throw new Error("Method not implemented.")}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return Os.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"attachCallbackListeners",value:function(t,n){var r,i=Ns(),a=i.universalLinks,o=i.handleOpenURL,c=i.BuildInfo,l=setTimeout(e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ks(t);case 2:n.onEvent($s());case 3:case"end":return e.stop()}}),r)}))),500),h=(r=e(u)(e(s).mark((function r(i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(l),e.next=3,Ks(t);case 3:a=e.sent,o=null,a&&(null==i?void 0:i.url)&&(o=Ws(a,i.url)),n.onEvent(o||$s());case 7:case"end":return e.stop()}}),r)}))),function(e){return r.apply(this,arguments)});void 0!==a&&"function"==typeof a.subscribe&&a.subscribe(null,h);var f=o,d="".concat(c.packageName.toLowerCase(),"://");Ns().handleOpenURL=function(){var t=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.toLowerCase().startsWith(d)&&h({url:n}),"function"==typeof f)try{f(n)}catch(e){console.error(e)}case 2:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}]),t}(),Zs=Js;function $s(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Bn("no-auth-event")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function tc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return!("file:"!==ec()&&"ionic:"!==ec()&&"capacitor:"!==ec()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function nc(){return me()&&11===(null===document||void 0===document?void 0:document.documentMode)}function rc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return/Edge\/\d+/.test(e)}function ic(){try{var e=self.localStorage,t=ko();if(e)return e.setItem(t,"1"),e.removeItem(t),!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de();return nc()||rc(e)}()||ge()}catch(e){return ac()&&ge()}return!1}function ac(){return void 0!==t&&"WorkerGlobalScope"in t&&"importScripts"in t}function oc(){return("http:"===ec()||"https:"===ec()||pe()||tc())&&!(ye()||ve())&&ic()&&!ac()}function uc(){return tc()&&"undefined"!=typeof document}function sc(){return cc.apply(this,arguments)}function cc(){return(cc=e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(uc()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.abrupt("return",new Promise((function(e){var t=setTimeout((function(){e(!1)}),1e3);document.addEventListener("deviceready",(function(){clearTimeout(t),e(!0)}))})));case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var lc={LOCAL:"local",NONE:"none",SESSION:"session"},hc=zn,fc="persistence";function dc(e,t){hc(Object.values(lc).includes(t),e,"invalid-persistence-type"),ye()?hc(t!==lc.SESSION,e,"unsupported-persistence-type"):ve()?hc(t===lc.NONE,e,"unsupported-persistence-type"):ac()?hc(t===lc.NONE||t===lc.LOCAL&&ge(),e,"unsupported-persistence-type"):hc(t===lc.NONE||ic(),e,"unsupported-persistence-type")}function vc(e){return pc.apply(this,arguments)}function pc(){return(pc=e(u)(e(s).mark((function t(n){var r,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._initializationPromise;case 2:r=yc(),i=jr(fc,n.config.apiKey,n.name),r&&r.setItem(i,n._getPersistence());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function yc(){var e;try{return(null===(e="undefined"!=typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(e){return null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mc=zn,gc=function(){"use strict";function t(){e(E)(this,t),this.browserResolver=Yn(Is),this.cordovaResolver=Yn(Zs),this.underlyingResolver=null,this._redirectPersistence=yo,this._completeRedirectFn=Gu,this._overrideRedirectResult=Ru}return e(S)(t,[{key:"_initialize",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.selectUnderlyingResolver();case 2:return e.abrupt("return",n.assertedUnderlyingResolver._initialize(t));case 3:case"end":return e.stop()}}),r)})))()}},{key:"_openPopup",value:function(t,n,r,i){var a=this;return e(u)(e(s).mark((function o(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.selectUnderlyingResolver();case 2:return e.abrupt("return",a.assertedUnderlyingResolver._openPopup(t,n,r,i));case 3:case"end":return e.stop()}}),o)})))()}},{key:"_openRedirect",value:function(t,n,r,i){var a=this;return e(u)(e(s).mark((function o(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.selectUnderlyingResolver();case 2:return e.abrupt("return",a.assertedUnderlyingResolver._openRedirect(t,n,r,i));case 3:case"end":return e.stop()}}),o)})))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}},{key:"_originValidation",value:function(e){return this.assertedUnderlyingResolver._originValidation(e)}},{key:"_shouldInitProactively",get:function(){return uc()||this.browserResolver._shouldInitProactively}},{key:"assertedUnderlyingResolver",get:function(){return mc(this.underlyingResolver,"internal-error"),this.underlyingResolver}},{key:"selectUnderlyingResolver",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.underlyingResolver){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,sc();case 4:r=e.sent,t.underlyingResolver=r?t.cordovaResolver:t.browserResolver;case 6:case"end":return e.stop()}}),n)})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function kc(e){return e.unwrap()}function wc(e,t){var n,r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null==t?void 0:t.code))t.resolver=new Tc(e,function(e,t){var n,r=Oe(e),i=t;return zn(t.customData.operationType,r,"argument-error"),zn(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),oo._fromError(r,i)}(e,t));else if(r){var i=bc(t),a=t;i&&(a.credential=i,a.tenantId=r.tenantId||void 0,a.email=r.email||void 0,a.phoneNumber=r.phoneNumber||void 0)}}function bc(e){var t=(e instanceof ke?e.customData:e)._tokenResponse;if(!t)return null;if(!(e instanceof ke)&&"temporaryProof"in t&&"phoneNumber"in t)return hu.credentialFromResult(e);var n,r=t.providerId;if(!r||r===En)return null;switch(r){case Tn:n=Ji;break;case In:n=Xi;break;case _n:n=Zi;break;case Sn:n=ta;break;default:var i=t.oauthIdToken,a=t.oauthAccessToken,o=t.oauthTokenSecret,u=t.pendingToken,s=t.nonce;return a||o||i||u?u?r.startsWith("saml.")?$i._create(r,u):Fi._fromParams({providerId:r,signInMethod:r,pendingToken:u,idToken:i,accessToken:a}):new Yi(r).credential({idToken:i,accessToken:a,rawNonce:s}):null}return e instanceof ke?n.credentialFromError(e):n.credentialFromResult(e)}function xc(e,t){return t.catch((function(t){throw t instanceof ke&&wc(e,t),t})).then((function(e){var t,n=e.operationType,r=e.user;return{operationType:n,credential:(t=e,bc(t)),additionalUserInfo:io(e),user:Ec.getOrCreate(r)}}))}function Ic(e,t){return _c.apply(this,arguments)}function _c(){return(_c=e(u)(e(s).mark((function t(n,r){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r;case 2:return i=e.sent,e.abrupt("return",{verificationId:i.verificationId,confirm:function(e){return xc(n,i.confirm(e))}});case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var Tc=function(){"use strict";function t(n,r){e(E)(this,t),this.resolver=r,this.auth=n.wrapped()}return e(S)(t,[{key:"session",get:function(){return this.resolver.session}},{key:"hints",get:function(){return this.resolver.hints}},{key:"resolveSignIn",value:function(e){return xc(kc(this.auth),this.resolver.resolveSignIn(e))}}]),t}(),Ec=function(){"use strict";function t(n){var r;e(E)(this,t),this._delegate=n,this.multiFactor=(r=Oe(n),co.has(r)||co.set(r,so._fromUser(r)),co.get(r))}return e(S)(t,[{key:"delete",value:function(){return this._delegate.delete()}},{key:"reload",value:function(){return this._delegate.reload()}},{key:"toJSON",value:function(){return this._delegate.toJSON()}},{key:"getIdTokenResult",value:function(e){return this._delegate.getIdTokenResult(e)}},{key:"getIdToken",value:function(e){return this._delegate.getIdToken(e)}},{key:"linkAndRetrieveDataWithCredential",value:function(e){return this.linkWithCredential(e)}},{key:"linkWithCredential",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xc(n.auth,xa(n._delegate,t)));case 1:case"end":return e.stop()}}),r)})))()}},{key:"linkWithPhoneNumber",value:function(t,n){var r=this;return e(u)(e(s).mark((function i(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ic(r.auth,au(r._delegate,t,n)));case 1:case"end":return e.stop()}}),i)})))()}},{key:"linkWithPopup",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xc(n.auth,Iu(n._delegate,t,gc)));case 1:case"end":return e.stop()}}),r)})))()}},{key:"linkWithRedirect",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vc(oi(n.auth));case 2:return e.abrupt("return",Uu(n._delegate,t,gc));case 3:case"end":return e.stop()}}),r)})))()}},{key:"reauthenticateAndRetrieveDataWithCredential",value:function(e){return this.reauthenticateWithCredential(e)}},{key:"reauthenticateWithCredential",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xc(n.auth,_a(n._delegate,t)));case 1:case"end":return e.stop()}}),r)})))()}},{key:"reauthenticateWithPhoneNumber",value:function(e,t){return Ic(this.auth,function(e,t,n){return uu.apply(this,arguments)}(this._delegate,e,t))}},{key:"reauthenticateWithPopup",value:function(e){return xc(this.auth,function(e,t,n){return xu.apply(this,arguments)}(this._delegate,e,gc))}},{key:"reauthenticateWithRedirect",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vc(oi(n.auth));case 2:return e.abrupt("return",Fu(n._delegate,t,gc));case 3:case"end":return e.stop()}}),r)})))()}},{key:"sendEmailVerification",value:function(e){return function(e,t){return za.apply(this,arguments)}(this._delegate,e)}},{key:"unlink",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,la(n._delegate,t);case 2:return e.abrupt("return",n);case 3:case"end":return e.stop()}}),r)})))()}},{key:"updateEmail",value:function(e){return function(e,t){return Xa(Oe(e),t,null)}(this._delegate,e)}},{key:"updatePassword",value:function(e){return function(e,t){return Xa(Oe(e),null,t)}(this._delegate,e)}},{key:"updatePhoneNumber",value:function(e){return function(e,t){return lu.apply(this,arguments)}(this._delegate,e)}},{key:"updateProfile",value:function(e){return function(e,t){return Ya.apply(this,arguments)}(this._delegate,e)}},{key:"verifyBeforeUpdateEmail",value:function(e,t){return function(e,t,n){return Wa.apply(this,arguments)}(this._delegate,e,t)}},{key:"emailVerified",get:function(){return this._delegate.emailVerified}},{key:"isAnonymous",get:function(){return this._delegate.isAnonymous}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"phoneNumber",get:function(){return this._delegate.phoneNumber}},{key:"providerData",get:function(){return this._delegate.providerData}},{key:"refreshToken",get:function(){return this._delegate.refreshToken}},{key:"tenantId",get:function(){return this._delegate.tenantId}},{key:"displayName",get:function(){return this._delegate.displayName}},{key:"email",get:function(){return this._delegate.email}},{key:"photoURL",get:function(){return this._delegate.photoURL}},{key:"providerId",get:function(){return this._delegate.providerId}},{key:"uid",get:function(){return this._delegate.uid}},{key:"auth",get:function(){return this._delegate.auth}}],[{key:"getOrCreate",value:function(e){return t.USER_MAP.has(e)||t.USER_MAP.set(e,new t(e)),t.USER_MAP.get(e)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ec.USER_MAP=new WeakMap;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Sc=zn,Ac=function(){"use strict";function t(n,r){if(e(E)(this,t),this.app=n,r.isInitialized())return this._delegate=r.getImmediate(),void this.linkUnderlyingAuth();var i=n.options.apiKey;Sc(i,"invalid-api-key",{appName:n.name}),Sc(i,"invalid-api-key",{appName:n.name});var a="undefined"!=typeof window?gc:void 0;this._delegate=r.initialize({options:{persistence:Nc(i,n.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(Ln),this.linkUnderlyingAuth()}return e(S)(t,[{key:"emulatorConfig",get:function(){return this._delegate.emulatorConfig}},{key:"currentUser",get:function(){return this._delegate.currentUser?Ec.getOrCreate(this._delegate.currentUser):null}},{key:"languageCode",get:function(){return this._delegate.languageCode},set:function(e){this._delegate.languageCode=e}},{key:"settings",get:function(){return this._delegate.settings}},{key:"tenantId",get:function(){return this._delegate.tenantId},set:function(e){this._delegate.tenantId=e}},{key:"useDeviceLanguage",value:function(){this._delegate.useDeviceLanguage()}},{key:"signOut",value:function(){return this._delegate.signOut()}},{key:"useEmulator",value:function(e,t){si(this._delegate,e,t)}},{key:"applyActionCode",value:function(e){return function(e,t){return Pa.apply(this,arguments)}(this._delegate,e)}},{key:"checkActionCode",value:function(e){return La(this._delegate,e)}},{key:"confirmPasswordReset",value:function(e,t){return function(e,t,n){return Oa.apply(this,arguments)}(this._delegate,e,t)}},{key:"createUserWithEmailAndPassword",value:function(t,n){var r=this;return e(u)(e(s).mark((function i(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xc(r._delegate,Va(r._delegate,t,n)));case 1:case"end":return e.stop()}}),i)})))()}},{key:"fetchProvidersForEmail",value:function(e){return this.fetchSignInMethodsForEmail(e)}},{key:"fetchSignInMethodsForEmail",value:function(e){return function(e,t){return Ka.apply(this,arguments)}(this._delegate,e)}},{key:"isSignInWithEmailLink",value:function(e){return function(e,t){var n=zi.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}(this._delegate,e)}},{key:"getRedirectResult",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Sc(oc(),t._delegate,"operation-not-supported-in-this-environment"),e.next=3,Bu(t._delegate,gc);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return",{credential:null,user:null});case 6:return e.abrupt("return",xc(t._delegate,Promise.resolve(r)));case 7:case"end":return e.stop()}}),n)})))()}},{key:"addFrameworkForLogging",value:function(e){!function(e,t){oi(e)._logFramework(t)}(this._delegate,e)}},{key:"onAuthStateChanged",value:function(e,t,n){var r=Cc(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onAuthStateChanged(i,a,o)}},{key:"onIdTokenChanged",value:function(e,t,n){var r=Cc(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onIdTokenChanged(i,a,o)}},{key:"sendSignInLinkToEmail",value:function(e,t){return function(e,t,n){return qa.apply(this,arguments)}(this._delegate,e,t)}},{key:"sendPasswordResetEmail",value:function(e,t){return function(e,t,n){return Ra.apply(this,arguments)}(this._delegate,e,t||void 0)}},{key:"setPersistence",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:dc(n._delegate,t),e.t0=t,e.next=e.t0===lc.SESSION?5:e.t0===lc.LOCAL?7:e.t0===lc.NONE?12:14;break;case 5:return i=yo,e.abrupt("break",15);case 7:return e.next=9,Yn(Vo)._isAvailable();case 9:return a=e.sent,i=a?Vo:vo,e.abrupt("break",15);case 12:return i=Br,e.abrupt("break",15);case 14:return e.abrupt("return",qn("argument-error",{appName:n._delegate.name}));case 15:return e.abrupt("return",n._delegate.setPersistence(i));case 16:case"end":return e.stop()}}),r)})))()}},{key:"signInAndRetrieveDataWithCredential",value:function(e){return this.signInWithCredential(e)}},{key:"signInAnonymously",value:function(){return xc(this._delegate,function(e){return oa.apply(this,arguments)}(this._delegate))}},{key:"signInWithCredential",value:function(e){return xc(this._delegate,wa(this._delegate,e))}},{key:"signInWithCustomToken",value:function(e){return xc(this._delegate,function(e,t){return Aa.apply(this,arguments)}(this._delegate,e))}},{key:"signInWithEmailAndPassword",value:function(e,t){return xc(this._delegate,function(e,t,n){return wa(Oe(e),Wi.credential(t,n))}(this._delegate,e,t))}},{key:"signInWithEmailLink",value:function(e,t){return xc(this._delegate,function(e,t,n){return Ba.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPhoneNumber",value:function(e,t){return Ic(this._delegate,function(e,t,n){return iu.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPopup",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Sc(oc(),n._delegate,"operation-not-supported-in-this-environment"),e.abrupt("return",xc(n._delegate,wu(n._delegate,t,gc)));case 2:case"end":return e.stop()}}),r)})))()}},{key:"signInWithRedirect",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Sc(oc(),n._delegate,"operation-not-supported-in-this-environment"),e.next=3,vc(n._delegate);case 3:return e.abrupt("return",Lu(n._delegate,t,gc));case 4:case"end":return e.stop()}}),r)})))()}},{key:"updateCurrentUser",value:function(e){return this._delegate.updateCurrentUser(e)}},{key:"verifyPasswordResetCode",value:function(e){return function(e,t){return Fa.apply(this,arguments)}(this._delegate,e)}},{key:"unwrap",value:function(){return this._delegate}},{key:"_delete",value:function(){return this._delegate._delete()}},{key:"linkUnderlyingAuth",value:function(){var e=this;this._delegate.wrapped=function(){return e}}}]),t}();function Cc(e,t,n){var r,i=e;"function"!=typeof e&&(i=(r=e).next,t=r.error,n=r.complete);var a=i;return{next:function(e){return a(e&&Ec.getOrCreate(e))},error:t,complete:n}}function Nc(e,t){var n=function(e,t){var n=yc();if(!n)return[];var r=jr(fc,e,t);switch(n.getItem(r)){case lc.NONE:return[Br];case lc.LOCAL:return[Vo,yo];case lc.SESSION:return[yo];default:return[]}}(e,t);if("undefined"==typeof self||n.includes(Vo)||n.push(Vo),"undefined"!=typeof window){var r=!0,i=!1,a=void 0;try{for(var o,u=[vo,yo][Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n.includes(s)||n.push(s)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}return n.includes(Br)||n.push(Br),n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ac.Persistence=lc;var Dc=function(){"use strict";function t(){e(E)(this,t),this.providerId="phone",this._delegate=new hu(kc(hn.auth()))}return e(S)(t,[{key:"verifyPhoneNumber",value:function(e,t){return this._delegate.verifyPhoneNumber(e,t)}},{key:"unwrap",value:function(){return this._delegate}}],[{key:"credential",value:function(e,t){return hu.credential(e,t)}}]),t}();Dc.PHONE_SIGN_IN_METHOD=hu.PHONE_SIGN_IN_METHOD,Dc.PROVIDER_ID=hu.PROVIDER_ID;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Rc,Oc=zn,Pc=function(){"use strict";function t(n,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:hn.app();e(E)(this,t),Oc(null===(i=a.options)||void 0===i?void 0:i.apiKey,"invalid-api-key",{appName:a.name}),this._delegate=new tu(n,r,a.auth()),this.type=this._delegate.type}return e(S)(t,[{key:"clear",value:function(){this._delegate.clear()}},{key:"render",value:function(){return this._delegate.render()}},{key:"verify",value:function(){return this._delegate.verify()}}]),t}();(Rc=hn).INTERNAL.registerComponent(new Pe("auth-compat",(function(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new Ac(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:An,PASSWORD_RESET:Cn,RECOVER_EMAIL:Nn,REVERT_SECOND_FACTOR_ADDITION:Dn,VERIFY_AND_CHANGE_EMAIL:Rn,VERIFY_EMAIL:On}},EmailAuthProvider:Wi,FacebookAuthProvider:Xi,GithubAuthProvider:Zi,GoogleAuthProvider:Ji,OAuthProvider:Yi,SAMLAuthProvider:ea,PhoneAuthProvider:Dc,PhoneMultiFactorGenerator:Ts,RecaptchaVerifier:Pc,TwitterAuthProvider:ta,Auth:Ac,AuthCredential:hi,Error:ke}).setInstantiationMode("LAZY").setMultipleInstances(!1)),Rc.registerVersion("@firebase/auth-compat","0.3.3");E=o("ckB89");var Lc,Mc=o("8dTuY"),Fc=(S=o("4mzug"),N=o("k8LMu"),R=o("jiX0X"),G=o("brQQZ"),u=o("eZ7d6"),E=o("ckB89"),Mc=o("8dTuY"),S=o("4mzug"),pn=o("eSWTR"),N=o("k8LMu"),o("191pB")),Vc=(D=o("8sKqN"),R=o("jiX0X"),o("huWaY")),Uc=(G=o("brQQZ"),s=o("2TvXO"),E=o("ckB89"),S=o("4mzug"),pn=o("eSWTR"),N=o("k8LMu"),D=o("8sKqN"),Vc=o("huWaY"),G=o("brQQZ"),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}),qc={},Bc=Bc||{},jc=Uc||self;function Gc(){}function Kc(t){var n=void 0===t?"undefined":e(Vc)(t);return"array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length}function zc(t){var n=void 0===t?"undefined":e(Vc)(t);return"object"==n&&null!=t||"function"==n}var Wc="closure_uid_"+(1e9*Math.random()>>>0),Hc=0;function Qc(e,t,n){return e.call.apply(e.bind,arguments)}function Yc(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Xc(e,t,n){return(Xc=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Qc:Yc).apply(null,arguments)}function Jc(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Zc(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Wb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function $c(){this.s=this.s,this.o=this.o}$c.prototype.s=!1,$c.prototype.na=function(){var e;!this.s&&(this.s=!0,this.M(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Wc)&&e[Wc]||(e[Wc]=++Hc))},$c.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var el=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function tl(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function nl(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(Kc(r)){var i=e.length||0,a=r.length||0;e.length=i+a;for(var o=0;o<a;o++)e[i+o]=r[o]}else e.push(r)}}function rl(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}rl.prototype.h=function(){this.defaultPrevented=!0};var il=function(){if(!jc.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{jc.addEventListener("test",Gc,t),jc.removeEventListener("test",Gc,t)}catch(e){}return e}();function al(e){return/^[\s\xa0]*$/.test(e)}var ol=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function ul(e,t){return e<t?-1:e>t?1:0}function sl(){var e=jc.navigator;return e&&(e=e.userAgent)?e:""}function cl(e){return-1!=sl().indexOf(e)}function ll(e){return ll[" "](e),e}ll[" "]=Gc;var hl,fl,dl=cl("Opera"),vl=cl("Trident")||cl("MSIE"),pl=cl("Edge"),yl=pl||vl,ml=cl("Gecko")&&!(-1!=sl().toLowerCase().indexOf("webkit")&&!cl("Edge"))&&!(cl("Trident")||cl("MSIE"))&&!cl("Edge"),gl=-1!=sl().toLowerCase().indexOf("webkit")&&!cl("Edge");function kl(){var e=jc.document;return e?e.documentMode:void 0}e:{var wl="",bl=(fl=sl(),ml?/rv:([^\);]+)(\)|;)/.exec(fl):pl?/Edge\/([\d\.]+)/.exec(fl):vl?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(fl):gl?/WebKit\/(\S+)/.exec(fl):dl?/(?:Version)[ \/]?(\S+)/.exec(fl):void 0);if(bl&&(wl=bl?bl[1]:""),vl){var xl=kl();if(null!=xl&&xl>parseFloat(wl)){hl=String(xl);break e}}hl=wl}var Il,_l={};function Tl(){return function(e){var t=_l;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=ol(String(hl)).split("."),n=ol("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=ul(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||ul(0==a[2].length,0==o[2].length)||ul(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}))}if(jc.document&&vl){var El=kl();Il=El||(parseInt(hl,10)||void 0)}else Il=void 0;var Sl=Il;function Al(e,t){if(rl.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(ml){e:{try{ll(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Cl[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Al.X.h.call(this)}}Zc(Al,rl);var Cl={2:"touch",3:"pen",4:"mouse"};Al.prototype.h=function(){Al.X.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Nl="closure_listenable_"+(1e6*Math.random()|0),Dl=0;function Rl(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++Dl,this.ba=this.ea=!1}function Ol(e){e.ba=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function Pl(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Ll(e){var t={};for(var n in e)t[n]=e[n];return t}var Ml="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Fl(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<Ml.length;a++)n=Ml[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Vl(e){this.src=e,this.g={},this.h=0}function Ul(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=el(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(Ol(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function ql(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ba&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}Vl.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=ql(e,t,r,i);return-1<o?(t=e[o],n||(t.ea=!1)):((t=new Rl(t,this.src,a,!!r,i)).ea=n,e.push(t)),t};var Bl="closure_lm_"+(1e6*Math.random()|0),jl={};function Gl(e,t,n,r,i){if(r&&r.once)return zl(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)Gl(e,t[a],n,r,i);return null}return n=Zl(n),e&&e[Nl]?e.N(t,n,zc(r)?!!r.capture:!!r,i):Kl(e,t,n,!1,r,i)}function Kl(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=zc(i)?!!i.capture:!!i,u=Xl(e);if(u||(e[Bl]=u=new Vl(e)),(n=u.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Yl;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)il||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Ql(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function zl(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)zl(e,t[a],n,r,i);return null}return n=Zl(n),e&&e[Nl]?e.O(t,n,zc(r)?!!r.capture:!!r,i):Kl(e,t,n,!0,r,i)}function Wl(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Wl(e,t[a],n,r,i);else r=zc(r)?!!r.capture:!!r,n=Zl(n),e&&e[Nl]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=ql(a=e.g[t],n,r,i))&&(Ol(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=Xl(e))&&(t=e.g[t.toString()],e=-1,t&&(e=ql(t,n,r,i)),(n=-1<e?t[e]:null)&&Hl(n))}function Hl(e){if("number"!=typeof e&&e&&!e.ba){var t=e.src;if(t&&t[Nl])Ul(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Ql(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Xl(t))?(Ul(n,e),0==n.h&&(n.src=null,t[Bl]=null)):Ol(e)}}}function Ql(e){return e in jl?jl[e]:jl[e]="on"+e}function Yl(e,t){if(e.ba)e=!0;else{t=new Al(t,this);var n=e.listener,r=e.ha||e.src;e.ea&&Hl(e),e=n.call(r,t)}return e}function Xl(e){return(e=e[Bl])instanceof Vl?e:null}var Jl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zl(e){return"function"==typeof e?e:(e[Jl]||(e[Jl]=function(t){return e.handleEvent(t)}),e[Jl])}function $l(){$c.call(this),this.i=new Vl(this),this.P=this,this.I=null}function eh(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new rl(t,e);else if(t instanceof rl)t.target=t.target||e;else{var i=t;Fl(t=new rl(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=th(o,r,!0,t)&&i}if(i=th(o=t.g=e,r,!0,t)&&i,i=th(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=th(o=t.g=n[a],r,!1,t)&&i}function th(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ba&&o.capture==n){var u=o.listener,s=o.ha||o.src;o.ea&&Ul(e.i,o),i=!1!==u.call(s,r)&&i}}return i&&!r.defaultPrevented}Zc($l,$c),$l.prototype[Nl]=!0,$l.prototype.removeEventListener=function(e,t,n,r){Wl(this,e,t,n,r)},$l.prototype.M=function(){if($l.X.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ol(n[r]);delete t.g[e],t.h--}}this.I=null},$l.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},$l.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var nh=jc.JSON.stringify;function rh(){var e=hh,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var ih,ah=function(){"use strict";function t(){e(E)(this,t),this.h=this.g=null}return e(S)(t,[{key:"add",value:function(e,t){var n=oh.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),t}(),oh=new(function(){"use strict";function t(n,r){e(E)(this,t),this.i=n,this.j=r,this.h=0,this.g=null}return e(S)(t,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),t}())((function(){return new uh}),(function(e){return e.reset()})),uh=function(){"use strict";function t(){e(E)(this,t),this.next=this.g=this.h=null}return e(S)(t,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),t}();function sh(e){jc.setTimeout((function(){throw e}),0)}function ch(e,t){ih||function(){var e=jc.Promise.resolve(void 0);ih=function(){e.then(fh)}}(),lh||(ih(),lh=!0),hh.add(e,t)}var lh=!1,hh=new ah;function fh(){for(var e;e=rh();){try{e.h.call(e.g)}catch(e){sh(e)}var t=oh;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}lh=!1}function dh(e,t){$l.call(this),this.h=e||1,this.g=t||jc,this.j=Xc(this.lb,this),this.l=Date.now()}function vh(e){e.ca=!1,e.R&&(e.g.clearTimeout(e.R),e.R=null)}function ph(e,t,n){if("function"==typeof e)n&&(e=Xc(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Xc(e.handleEvent,e)}return 2147483647<Number(t)?-1:jc.setTimeout(e,t||0)}function yh(e){e.g=ph((function(){e.g=null,e.i&&(e.i=!1,yh(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}Zc(dh,$l),(Lc=dh.prototype).ca=!1,Lc.R=null,Lc.lb=function(){if(this.ca){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-e):(this.R&&(this.g.clearTimeout(this.R),this.R=null),eh(this,"tick"),this.ca&&(vh(this),this.start()))}},Lc.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Lc.M=function(){dh.X.M.call(this),vh(this),delete this.g};var mh=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this)).m=t,a.j=i,a.h=null,a.i=!1,a.g=null,a}return e(S)(r,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:yh(this)}},{key:"M",value:function(){e(fn)(e(pn)(r.prototype),"M",this).call(this),this.g&&(jc.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),r}($c);function gh(e){$c.call(this),this.h=e,this.g={}}Zc(gh,$c);var kh=[];function wh(e,t,n,r){Array.isArray(n)||(n&&(kh[0]=n.toString()),n=kh);for(var i=0;i<n.length;i++){var a=Gl(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function bh(e){Pl(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Hl(e)}),e),e.g={}}function xh(){this.g=!0}function Ih(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return nh(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}gh.prototype.M=function(){gh.X.M.call(this),bh(this)},gh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},xh.prototype.Aa=function(){this.g=!1},xh.prototype.info=function(){};var _h={},Th=null;function Eh(){return Th=Th||new $l}function Sh(e){rl.call(this,_h.Pa,e)}function Ah(e){var t=Eh();eh(t,new Sh(t))}function Ch(e,t){rl.call(this,_h.STAT_EVENT,e),this.stat=t}function Nh(e){var t=Eh();eh(t,new Ch(t,e))}function Dh(e,t){rl.call(this,_h.Qa,e),this.size=t}function Rh(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return jc.setTimeout((function(){e()}),t)}_h.Pa="serverreachability",Zc(Sh,rl),_h.STAT_EVENT="statevent",Zc(Ch,rl),_h.Qa="timingevent",Zc(Dh,rl);var Oh={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Ph={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function Lh(){}function Mh(e){return e.h||(e.h=e.i())}function Fh(){}Lh.prototype.h=null;var Vh,Uh={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function qh(){rl.call(this,"d")}function Bh(){rl.call(this,"c")}function jh(){}function Gh(e,t,n,r){this.l=e,this.j=t,this.m=n,this.U=r||1,this.S=new gh(this),this.O=zh,e=yl?125:void 0,this.T=new dh(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Kh}function Kh(){this.i=null,this.g="",this.h=!1}Zc(qh,rl),Zc(Bh,rl),Zc(jh,Lh),jh.prototype.g=function(){return new XMLHttpRequest},jh.prototype.i=function(){return{}},Vh=new jh;var zh=45e3,Wh={},Hh={};function Qh(e,t,n){e.K=1,e.v=vf(cf(t)),e.s=n,e.P=!0,Yh(e,null)}function Yh(e,t){e.F=Date.now(),$h(e),e.A=cf(e.v);var n=e.A,r=e.U;Array.isArray(r)||(r=[String(r)]),Sf(n.i,"t",r),e.C=0,n=e.l.H,e.h=new Kh,e.g=Sd(e.l,n?t:null,!e.s),0<e.N&&(e.L=new mh(Xc(e.La,e,e.g),e.N)),wh(e.S,e.g,"readystatechange",e.ib),t=e.H?Ll(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.da(e.A,e.u,e.s,t)):(e.u="GET",e.g.da(e.A,e.u,null,t)),Ah(),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var o="",u=a.split("&"),s=0;s<u.length;s++){var c=u[s].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.U,e.s)}function Xh(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Da)}function Jh(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=Zh(e,n))==Hh){4==t&&(e.o=4,Nh(14),i=!1),Ih(e.j,e.m,null,"[Incomplete Response]");break}if(r==Wh){e.o=4,Nh(15),Ih(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ih(e.j,e.m,r,null),af(e,r)}Xh(e)&&r!=Hh&&r!=Wh&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Nh(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.$&&(e.$=!0,(t=e.l).g==e&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),kd(t),t.K=!0,Nh(11))):(Ih(e.j,e.m,n,"[Invalid Chunked Response]"),rf(e),nf(e))}function Zh(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Hh:(n=Number(t.substring(n,r)),isNaN(n)?Wh:(r+=1)+n>t.length?Hh:(t=t.substr(r,n),e.C=r+n,t))}function $h(e){e.V=Date.now()+e.O,ef(e,e.O)}function ef(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Rh(Xc(e.gb,e),t)}function tf(e){e.B&&(jc.clearTimeout(e.B),e.B=null)}function nf(e){0==e.l.G||e.I||xd(e.l,e)}function rf(e){tf(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,vh(e.T),bh(e.S),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function af(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||Pf(n.h,e)))if(!e.J&&Pf(n.h,e)&&3==n.G){try{var r=n.Fa.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;bd(n),hd(n)}gd(n),Nh(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=Rh(Xc(n.cb,n),6e3));if(1>=Of(n.h)&&n.ja){try{n.ja()}catch(a){}n.ja=void 0}}else _d(n,11)}else if((e.J||n.g==e)&&bd(n),!al(t))for(i=n.Fa.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.T=a[0],a=a[1],2==n.G)if("c"==a[0]){n.I=a[1],n.ka=a[2];var o=a[3];null!=o&&(n.ma=o,n.j.info("VER="+n.ma));var u=a[4];null!=u&&(n.Ca=u,n.j.info("SVER="+n.Ca));var s=a[5];null!=s&&"number"==typeof s&&0<s&&(r=1.5*s,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.h;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(Lf(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.za=f,df(r.F,r.D,f))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-e.F,n.j.info("Handshake RTT: "+n.P+"ms"));var d=e;if((r=n).sa=Ed(r,r.H?r.ka:null,r.V),d.J){Mf(r.h,d);var v=d,p=r.J;p&&v.setTimeout(p),v.B&&(tf(v),$h(v)),r.g=d}else md(r);0<n.i.length&&dd(n)}else"stop"!=a[0]&&"close"!=a[0]||_d(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?_d(n,7):ld(n):"noop"!=a[0]&&n.l&&n.l.wa(a),n.A=0)}Ah()}catch(a){}}function of(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Kc(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.oa&&"function"==typeof e.oa)return e.oa();if(!e.W||"function"!=typeof e.W){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(Kc(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.W&&"function"==typeof e.W)return e.W();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(Kc(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}(Lc=Gh.prototype).setTimeout=function(e){this.O=e},Lc.ib=function(e){e=e.target;var t=this.L;t&&3==id(e)?t.l():this.La(e)},Lc.La=function(e){try{if(e==this.g)e:{var t=id(this.g),n=this.g.Ea();this.g.aa();if(!(3>t)&&(3!=t||yl||this.g&&(this.h.h||this.g.fa()||ad(this.g)))){this.I||4!=t||7==n||Ah(),tf(this);var r=this.g.aa();this.Y=r;t:if(Xh(this)){var i=ad(this.g);e="";var a=i.length,o=4==id(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){rf(this),nf(this);var u="";break t}this.h.i=new jc.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,e+=this.h.i.decode(i[n],{stream:o&&n==a-1});i.splice(0,a),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.fa();if(this.i=200==r,function(e,t,n,r,i,a,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.U,t,r),this.i){if(this.Z&&!this.J){t:{if(this.g){var s,c=this.g;if((s=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!al(s)){var l=s;break t}}l=null}if(!(r=l)){this.i=!1,this.o=3,Nh(12),rf(this),nf(this);break e}Ih(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,af(this,r)}this.P?(Jh(this,t,u),yl&&this.i&&3==t&&(wh(this.S,this.T,"tick",this.hb),this.T.start())):(Ih(this.j,this.m,u,null),af(this,u)),4==t&&rf(this),this.i&&!this.I&&(4==t?xd(this.l,this):(this.i=!1,$h(this)))}else 400==r&&0<u.indexOf("Unknown SID")?(this.o=3,Nh(12)):(this.o=0,Nh(13)),rf(this),nf(this)}}}catch(t){}},Lc.hb=function(){if(this.g){var e=id(this.g),t=this.g.fa();this.C<t.length&&(tf(this),Jh(this,e,t),this.i&&4!=e&&$h(this))}},Lc.cancel=function(){this.I=!0,rf(this)},Lc.gb=function(){this.B=null;var e=Date.now();0<=e-this.V?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(Ah(),Nh(17)),rf(this),this.o=2,nf(this)):ef(this,this.V-e)};var uf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sf(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof sf){this.h=void 0!==t?t:e.h,lf(this,e.j),this.s=e.s,this.g=e.g,hf(this,e.m),this.l=e.l,t=e.i;var n=new If;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ff(this,n),this.o=e.o}else e&&(n=String(e).match(uf))?(this.h=!!t,lf(this,n[1]||"",!0),this.s=pf(n[2]||""),this.g=pf(n[3]||"",!0),hf(this,n[4]),this.l=pf(n[5]||"",!0),ff(this,n[6]||"",!0),this.o=pf(n[7]||"")):(this.h=!!t,this.i=new If(null,this.h))}function cf(e){return new sf(e)}function lf(e,t,n){e.j=n?pf(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function hf(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function ff(e,t,n){t instanceof If?(e.i=t,function(e,t){t&&!e.j&&(_f(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Tf(this,t),Sf(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=yf(t,bf)),e.i=new If(t,e.h))}function df(e,t,n){e.i.set(t,n)}function vf(e){return df(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function pf(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function yf(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,mf),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function mf(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}sf.prototype.toString=function(){var e=[],t=this.j;t&&e.push(yf(t,gf,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(yf(t,gf,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(yf(n,"/"==n.charAt(0)?wf:kf,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",yf(n,xf)),e.join("")};var gf=/[#\/\?@]/g,kf=/[#\?:]/g,wf=/[#\?]/g,bf=/[#\?@]/g,xf=/#/g;function If(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function _f(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Tf(e,t){_f(e),t=Af(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ef(e,t){return _f(e),t=Af(e,t),e.g.has(t)}function Sf(e,t,n){Tf(e,t),0<n.length&&(e.i=null,e.g.set(Af(e,t),tl(n)),e.h+=n.length)}function Af(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Lc=If.prototype).add=function(e,t){_f(this),this.i=null,e=Af(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Lc.forEach=function(e,t){_f(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},Lc.oa=function(){_f(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},Lc.W=function(e){_f(this);var t=[];if("string"==typeof e)Ef(this,e)&&(t=t.concat(this.g.get(Af(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},Lc.set=function(e,t){return _f(this),this.i=null,Ef(this,e=Af(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Lc.get=function(e,t){return e&&0<(e=this.W(e)).length?String(e[0]):t},Lc.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r)),a=this.W(r);for(r=0;r<a.length;r++){var o=i;""!==a[r]&&(o+="="+encodeURIComponent(String(a[r]))),e.push(o)}}return this.i=e.join("&")};var Cf=function t(n,r){"use strict";e(E)(this,t),this.h=n,this.g=r};function Nf(e){this.l=e||Df,jc.PerformanceNavigationTiming?e=0<(e=jc.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(jc.g&&jc.g.Ga&&jc.g.Ga()&&jc.g.Ga().$b),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Df=10;function Rf(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Of(e){return e.h?1:e.g?e.g.size:0}function Pf(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Lf(e,t){e.g?e.g.add(t):e.h=t}function Mf(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Ff(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t=e.i,n=!0,r=!1,i=void 0;try{for(var a,o=e.g.values()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;t=t.concat(u.D)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}return tl(e.i)}function Vf(){}function Uf(){this.g=new Vf}function qf(e,t,n){var r=n||"";try{of(e,(function(e,n){var i=e;zc(e)&&(i=nh(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function Bf(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function jf(e){this.l=e.ac||null,this.j=e.jb||!1}function Gf(e,t){$l.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Kf,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Nf.prototype.cancel=function(){if(this.i=Ff(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e=!0,t=!1,n=void 0;try{for(var r,i=this.g.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.cancel()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.g.clear()}},Vf.prototype.stringify=function(e){return jc.JSON.stringify(e,void 0)},Vf.prototype.parse=function(e){return jc.JSON.parse(e,void 0)},Zc(jf,Lh),jf.prototype.g=function(){return new Gf(this.l,this.j)},jf.prototype.i=function(e){return function(){return e}}({}),Zc(Gf,$l);var Kf=0;function zf(e){e.j.read().then(e.Ta.bind(e)).catch(e.ga.bind(e))}function Wf(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Hf(e)}function Hf(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Lc=Gf.prototype).open=function(e,t){if(this.readyState!=Kf)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Hf(this)},Lc.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||jc).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},Lc.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Wf(this)),this.readyState=Kf},Lc.Wa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Hf(this)),this.g&&(this.readyState=3,Hf(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==jc.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;zf(this)}else e.text().then(this.Va.bind(this),this.ga.bind(this))},Lc.Ta=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Wf(this):Hf(this),3==this.readyState&&zf(this)}},Lc.Va=function(e){this.g&&(this.response=this.responseText=e,Wf(this))},Lc.Ua=function(e){this.g&&(this.response=e,Wf(this))},Lc.ga=function(){this.g&&Wf(this)},Lc.setRequestHeader=function(e,t){this.v.append(e,t)},Lc.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Lc.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Gf.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Qf=jc.JSON.parse;function Yf(e){$l.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Xf,this.K=this.L=!1}Zc(Yf,$l);var Xf="",Jf=/^https?$/i,Zf=["POST","PUT"];function $f(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,ed(e),nd(e)}function ed(e){e.D||(e.D=!0,eh(e,"complete"),eh(e,"error"))}function td(e){if(e.h&&void 0!==Bc&&(!e.C[1]||4!=id(e)||2!=e.aa()))if(e.v&&4==id(e))ph(e.Ha,0,e);else if(eh(e,"readystatechange"),4==id(e)){e.h=!1;try{var t,n=e.aa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(uf)[1]||null;if(!a&&jc.self&&jc.self.location){var o=jc.self.location.protocol;a=o.substr(0,o.length-1)}i=!Jf.test(a?a.toLowerCase():"")}t=i}if(t)eh(e,"complete"),eh(e,"success");else{e.m=6;try{var u=2<id(e)?e.g.statusText:""}catch(e){u=""}e.j=u+" ["+e.aa()+"]",ed(e)}}finally{nd(e)}}}function nd(e,t){if(e.g){rd(e);var n=e.g,r=e.C[0]?Gc:null;e.g=null,e.C=null,t||eh(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function rd(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(jc.clearTimeout(e.A),e.A=null)}function id(e){return e.g?e.g.readyState:0}function ad(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Xf:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function od(e){var t="";return Pl(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function ud(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=od(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):df(e,t,n))}function sd(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function cd(e){this.Ca=0,this.i=[],this.j=new xh,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=sd("failFast",!1,e),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=sd("baseRetryDelayMs",5e3,e),this.bb=sd("retryDelaySeedMs",1e4,e),this.$a=sd("forwardChannelMaxRetries",2,e),this.ta=sd("forwardChannelRequestTimeoutMs",2e4,e),this.ra=e&&e.xmlHttpFactory||void 0,this.Da=e&&e.Zb||!1,this.J=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.I="",this.h=new Nf(e&&e.concurrentRequestLimit),this.Fa=new Uf,this.O=e&&e.fastHandshake||!1,this.N=e&&e.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=e&&e.Xb||!1,e&&e.Aa&&this.j.Aa(),e&&e.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&e&&e.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function ld(e){if(fd(e),3==e.G){var t=e.U++,n=cf(e.F);df(n,"SID",e.I),df(n,"RID",t),df(n,"TYPE","terminate"),pd(e,n),(t=new Gh(e,e.j,t,void 0)).K=2,t.v=vf(cf(n)),n=!1,jc.navigator&&jc.navigator.sendBeacon&&(n=jc.navigator.sendBeacon(t.v.toString(),"")),!n&&jc.Image&&((new Image).src=t.v,n=!0),n||(t.g=Sd(t.l,null),t.g.da(t.v)),t.F=Date.now(),$h(t)}Td(e)}function hd(e){e.g&&(kd(e),e.g.cancel(),e.g=null)}function fd(e){hd(e),e.u&&(jc.clearTimeout(e.u),e.u=null),bd(e),e.h.cancel(),e.m&&("number"==typeof e.m&&jc.clearTimeout(e.m),e.m=null)}function dd(e){Rf(e.h)||e.m||(e.m=!0,ch(e.Ja,e),e.C=0)}function vd(e,t){var n;n=t?t.m:e.U++;var r=cf(e.F);df(r,"SID",e.I),df(r,"RID",n),df(r,"AID",e.T),pd(e,r),e.o&&e.s&&ud(r,e.o,e.s),n=new Gh(e,e.j,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.i=t.D.concat(e.i)),t=yd(e,n,1e3),n.setTimeout(Math.round(.5*e.ta)+Math.round(.5*e.ta*Math.random())),Lf(e.h,n),Qh(n,r,t)}function pd(e,t){e.ia&&Pl(e.ia,(function(e,n){df(t,n,e)})),e.l&&of({},(function(e,n){df(t,n,e)}))}function yd(e,t,n){n=Math.min(e.i.length,n);var r=e.l?Xc(e.l.Ra,e.l,e):null;e:for(var i=e.i,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var u=!0,s=0;s<n;s++){var c=i[s].h,l=i[s].g;if(0>(c-=a))a=Math.max(0,i[s].h-100),u=!1;else try{qf(l,o,"req"+c+"_")}catch(e){r&&r(l)}}if(u){r=o.join("&");break e}}return e=e.i.splice(0,n),t.D=e,r}function md(e){e.g||e.u||(e.Z=1,ch(e.Ia,e),e.A=0)}function gd(e){return!(e.g||e.u||3<=e.A)&&(e.Z++,e.u=Rh(Xc(e.Ia,e),Id(e,e.A)),e.A++,!0)}function kd(e){null!=e.B&&(jc.clearTimeout(e.B),e.B=null)}function wd(e){e.g=new Gh(e,e.j,"rpc",e.Z),null===e.o&&(e.g.H=e.s),e.g.N=0;var t=cf(e.sa);df(t,"RID","rpc"),df(t,"SID",e.I),df(t,"CI",e.L?"0":"1"),df(t,"AID",e.T),df(t,"TYPE","xmlhttp"),pd(e,t),e.o&&e.s&&ud(t,e.o,e.s),e.J&&e.g.setTimeout(e.J);var n=e.g;e=e.ka,n.K=1,n.v=vf(cf(t)),n.s=null,n.P=!0,Yh(n,e)}function bd(e){null!=e.v&&(jc.clearTimeout(e.v),e.v=null)}function xd(e,t){var n=null;if(e.g==t){bd(e),kd(e),e.g=null;var r=2}else{if(!Pf(e.h,t))return;n=t.D,Mf(e.h,t),r=1}if(0!=e.G)if(e.pa=t.Y,t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;eh(r=Eh(),new Dh(r,n)),dd(e)}else md(e);else if(3==(i=t.o)||0==i&&0<e.pa||!(1==r&&function(e,t){return!(Of(e.h)>=e.h.j-(e.m?1:0)||(e.m?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.C>=(e.Za?0:e.$a)||(e.m=Rh(Xc(e.Ja,e,t),Id(e,e.C)),e.C++,0)))}(e,t)||2==r&&gd(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:_d(e,5);break;case 4:_d(e,10);break;case 3:_d(e,6);break;default:_d(e,2)}}function Id(e,t){var n=e.Xa+Math.floor(Math.random()*e.bb);return e.l||(n*=2),n*t}function _d(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var r=Xc(e.kb,e);n||(n=new sf("//www.google.com/images/cleardot.gif"),jc.location&&"http"==jc.location.protocol||lf(n,"https"),vf(n)),function(e,t){var n=new xh;if(jc.Image){var r=new Image;r.onload=Jc(Bf,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Jc(Bf,n,r,"TestLoadImage: error",!1,t),r.onabort=Jc(Bf,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Jc(Bf,n,r,"TestLoadImage: timeout",!1,t),jc.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Nh(2);e.G=0,e.l&&e.l.va(t),Td(e),fd(e)}function Td(e){if(e.G=0,e.la=[],e.l){var t=Ff(e.h);0==t.length&&0==e.i.length||(nl(e.la,t),nl(e.la,e.i),e.h.i.length=0,tl(e.i),e.i.length=0),e.l.ua()}}function Ed(e,t,n){var r=n instanceof sf?cf(n):new sf(n,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),hf(r,r.m);else{var i=jc.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new sf(null,void 0);r&&lf(a,r),t&&(a.g=t),i&&hf(a,i),n&&(a.l=n),r=a}return n=e.D,t=e.za,n&&t&&df(r,n,t),df(r,"VER",e.ma),pd(e,r),r}function Sd(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Da&&!e.ra?new Yf(new jf({jb:!0})):new Yf(e.ra)).Ka(e.H),t}function Ad(){}function Cd(){if(vl&&!(10<=Number(Sl)))throw Error("Environmental error: no available transport.")}function Nd(e,t){$l.call(this),this.g=new cd(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.S=e,(e=t&&t.Yb)&&!al(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!al(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Od(this)}function Dd(e){qh.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Rd(){Bh.call(this),this.status=1}function Od(e){this.g=e}(Lc=Yf.prototype).Ka=function(e){this.L=e},Lc.da=function(t,n,r,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);n=n?n.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Vh.g(),this.C=this.u?Mh(this.u):Mh(Vh),this.g.onreadystatechange=Xc(this.Ha,this);try{this.F=!0,this.g.open(n,String(t),!0),this.F=!1}catch(e){return void $f(this,e)}if(t=r||"",r=new Map(this.headers),i){var a=!0,o=!1,u=void 0;if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)r.set(s,i[s]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));try{for(var c,l=i.keys()[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var h=c.value;r.set(h,i.get(h))}}catch(e){o=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}}}i=Array.from(r.keys()).find((function(e){return"content-type"==e.toLowerCase()})),s=jc.FormData&&t instanceof jc.FormData,!(0<=el(Zf,n))||i||s||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var f=!0,d=!1,v=void 0;try{for(var p,y=r[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){var m=e(D)(p.value,2),g=m[0],k=m[1];this.g.setRequestHeader(g,k)}}catch(e){d=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw v}}this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{rd(this),0<this.B&&((this.K=function(e){return vl&&Tl()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Xc(this.qa,this)):this.A=ph(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(e){$f(this,e)}},Lc.qa=function(){void 0!==Bc&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,eh(this,"timeout"),this.abort(8))},Lc.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,eh(this,"complete"),eh(this,"abort"),nd(this))},Lc.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),nd(this,!0)),Yf.X.M.call(this)},Lc.Ha=function(){this.s||(this.F||this.v||this.l?td(this):this.fb())},Lc.fb=function(){td(this)},Lc.aa=function(){try{return 2<id(this)?this.g.status:-1}catch(e){return-1}},Lc.fa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},Lc.Sa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Qf(t)}},Lc.Ea=function(){return this.m},Lc.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Lc=cd.prototype).ma=8,Lc.G=1,Lc.Ja=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;var t=new Gh(this,this.j,e,void 0),n=this.s;if(this.S&&(n?Fl(n=Ll(n),this.S):n=this.S),null!==this.o||this.N||(t.H=n,n=null),this.O)e:{for(var r=0,i=0;i<this.i.length;i++){var a=this.i[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.i.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=yd(this,t,r),df(i=cf(this.F),"RID",e),df(i,"CVER",22),this.D&&df(i,"X-HTTP-Session-Id",this.D),pd(this,i),n&&(this.N?r="headers="+encodeURIComponent(String(od(n)))+"&"+r:this.o&&ud(i,this.o,n)),Lf(this.h,t),this.Ya&&df(i,"TYPE","init"),this.O?(df(i,"$req",r),df(i,"SID","null"),t.Z=!0,Qh(t,i,null)):Qh(t,i,r),this.G=2}}else 3==this.G&&(e?vd(this,e):0==this.i.length||Rf(this.h)||vd(this))},Lc.Ia=function(){if(this.u=null,wd(this),this.$&&!(this.K||null==this.g||0>=this.P)){var e=2*this.P;this.j.info("BP detection timer enabled: "+e),this.B=Rh(Xc(this.eb,this),e)}},Lc.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Nh(10),hd(this),wd(this))},Lc.cb=function(){null!=this.v&&(this.v=null,hd(this),gd(this),Nh(19))},Lc.kb=function(e){e?(this.j.info("Successfully pinged google.com"),Nh(2)):(this.j.info("Failed to ping google.com"),Nh(1))},(Lc=Ad.prototype).xa=function(){},Lc.wa=function(){},Lc.va=function(){},Lc.ua=function(){},Lc.Ra=function(){},Cd.prototype.g=function(e,t){return new Nd(e,t)},Zc(Nd,$l),Nd.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;Nh(0),e.V=t,e.ia=n||{},e.L=e.Y,e.F=Ed(e,null,e.V),dd(e)},Nd.prototype.close=function(){ld(this.g)},Nd.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=nh(e),e=n);t.i.push(new Cf(t.ab++,e)),3==t.G&&dd(t)},Nd.prototype.M=function(){this.g.l=null,delete this.j,ld(this.g),delete this.g,Nd.X.M.call(this)},Zc(Dd,qh),Zc(Rd,Bh),Zc(Od,Ad),Od.prototype.xa=function(){eh(this.g,"a")},Od.prototype.wa=function(e){eh(this.g,new Dd(e))},Od.prototype.va=function(e){eh(this.g,new Rd)},Od.prototype.ua=function(){eh(this.g,"b")},Cd.prototype.createWebChannel=Cd.prototype.g,Nd.prototype.send=Nd.prototype.u,Nd.prototype.open=Nd.prototype.m,Nd.prototype.close=Nd.prototype.close,Oh.NO_ERROR=0,Oh.TIMEOUT=8,Oh.HTTP_ERROR=6,Ph.COMPLETE="complete",Fh.EventType=Uh,Uh.OPEN="a",Uh.CLOSE="b",Uh.ERROR="c",Uh.MESSAGE="d",$l.prototype.listen=$l.prototype.N,Yf.prototype.listenOnce=Yf.prototype.O,Yf.prototype.getLastError=Yf.prototype.Oa,Yf.prototype.getLastErrorCode=Yf.prototype.Ea,Yf.prototype.getStatus=Yf.prototype.aa,Yf.prototype.getResponseJson=Yf.prototype.Sa,Yf.prototype.getResponseText=Yf.prototype.fa,Yf.prototype.send=Yf.prototype.da,Yf.prototype.setWithCredentials=Yf.prototype.Ka;var Pd=qc.createWebChannelTransport=function(){return new Cd},Ld=qc.getStatEventTarget=function(){return Eh()},Md=qc.ErrorCode=Oh,Fd=qc.EventType=Ph,Vd=qc.Event=_h,Ud=qc.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},qd=qc.FetchXmlHttpFactory=jf,Bd=qc.WebChannel=Fh,jd=qc.XhrIo=Yf,Gd="@firebase/firestore",Kd=function(){"use strict";function t(n){e(E)(this,t),this.uid=n}return e(S)(t,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),t}();Kd.UNAUTHENTICATED=new Kd(null),Kd.GOOGLE_CREDENTIALS=new Kd("google-credentials-uid"),Kd.FIRST_PARTY=new Kd("first-party-uid"),Kd.MOCK_USER=new Kd("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var zd="9.17.1",Wd=new He("@firebase/firestore");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(){return Wd.logLevel}function Qd(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(Wd.logLevel<=Ue.DEBUG){var a,o=r.map(Jd);(a=Wd).debug.apply(a,["Firestore (".concat(zd,"): ").concat(t)].concat(e(R)(o)))}}function Yd(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(Wd.logLevel<=Ue.ERROR){var a,o=r.map(Jd);(a=Wd).error.apply(a,["Firestore (".concat(zd,"): ").concat(t)].concat(e(R)(o)))}}function Xd(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(Wd.logLevel<=Ue.WARN){var a,o=r.map(Jd);(a=Wd).warn.apply(a,["Firestore (".concat(zd,"): ").concat(t)].concat(e(R)(o)))}}function Jd(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zd(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(zd,") INTERNAL ASSERTION FAILED: ")+e;throw Yd(t),new Error(t)}function $d(e,t){e||Zd()}function ev(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tv={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},nv=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,t,i)).code=t,a.message=i,a.toString=function(){return"".concat(a.name,": [code=").concat(a.code,"]: ").concat(a.message)},e(Fc)(a)}return r}(ke),rv=function t(){"use strict";var n=this;e(E)(this,t),this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))},iv=function t(n,r){"use strict";e(E)(this,t),this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(n))},av=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Kd.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),t}(),ov=function(){"use strict";function t(n){e(E)(this,t),this.token=n,this.changeListener=null}return e(S)(t,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),t}(),uv=function(){"use strict";function t(n){e(E)(this,t),this.t=n,this.currentUser=Kd.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return e(S)(t,[{key:"start",value:function(t,n){var r=this,i=this.i,a=function(e){return r.i!==i?(i=r.i,n(e)):Promise.resolve()},o=new rv;this.o=function(){var e=r;r.i++,r.currentUser=r.u(),o.resolve(),o=new rv,t.enqueueRetryable((function(){return a(e.currentUser)}))};var c=function(){var n=o,i=r;t.enqueueRetryable(e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.promise;case 2:return e.next=4,a(i.currentUser);case 4:case"end":return e.stop()}}),t)}))))},l=function(e){Qd("FirebaseAuthCredentialsProvider","Auth detected"),r.auth=e,r.auth.addAuthTokenListener(r.o),c()};this.t.onInit((function(e){return l(e)})),setTimeout((function(){if(!r.auth){var e=r.t.getImmediate({optional:!0});e?l(e):(Qd("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new rv)}}),0),c()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(Qd("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?($d("string"==typeof n.accessToken),new iv(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return $d(null===e||"string"==typeof e),new Kd(e)}}]),t}(),sv=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.h=n,this.l=r,this.m=i,this.g=a,this.type="FirstParty",this.user=Kd.FIRST_PARTY,this.p=new Map}return e(S)(t,[{key:"I",value:function(){return this.g?this.g():($d(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}},{key:"headers",get:function(){this.p.set("X-Goog-AuthUser",this.l);var e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}]),t}(),cv=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.h=n,this.l=r,this.m=i,this.g=a}return e(S)(t,[{key:"getToken",value:function(){return Promise.resolve(new sv(this.h,this.l,this.m,this.g))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Kd.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),t}(),lv=function t(n){"use strict";e(E)(this,t),this.value=n,this.type="AppCheck",this.headers=new Map,n&&n.length>0&&this.headers.set("x-firebase-appcheck",this.value)},hv=function(){"use strict";function t(n){e(E)(this,t),this.T=n,this.forceRefresh=!1,this.appCheck=null,this.A=null}return e(S)(t,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable((function(){return function(e){null!=e.error&&Qd("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.A;return n.A=e.token,Qd("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)}))};var r=function(e){Qd("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.T.onInit((function(e){return r(e)})),setTimeout((function(){if(!n.appCheck){var e=n.T.getImmediate({optional:!0});e?r(e):Qd("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?($d("string"==typeof t.token),e.A=t.token,new lv(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function fv(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dv=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,null,[{key:"R",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=fv(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),t}();function vv(e,t){return e<t?-1:e>t?1:0}function pv(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function yv(e){return e+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mv=function(){"use strict";function t(n,r){if(e(E)(this,t),this.seconds=n,this.nanoseconds=r,r<0)throw new nv(tv.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new nv(tv.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(n<-62135596800)throw new nv(tv.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n);if(n>=253402300800)throw new nv(tv.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n)}return e(S)(t,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?vv(this.nanoseconds,e.nanoseconds):vv(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return t.fromMillis(Date.now())}},{key:"fromDate",value:function(e){return t.fromMillis(e.getTime())}},{key:"fromMillis",value:function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))}}]),t}(),gv=function(){"use strict";function t(n){e(E)(this,t),this.timestamp=n}return e(S)(t,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(e){return new t(e)}},{key:"min",value:function(){return new t(new mv(0,0))}},{key:"max",value:function(){return new t(new mv(253402300799,999999999))}}]),t}(),kv=function(){"use strict";function t(n,r,i){e(E)(this,t),void 0===r?r=0:r>n.length&&Zd(),void 0===i?i=n.length-r:i>n.length-r&&Zd(),this.segments=n,this.offset=r,this.len=i}return e(S)(t,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(e){return 0===t.comparator(this,e)}},{key:"child",value:function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(e){n.push(e)})):n.push(e),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),t}(),wv=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.apply(this,arguments)}return e(S)(r,[{key:"construct",value:function(e,t,n){return new r(e,t,n)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=[],o=!0,u=!1,s=void 0;try{for(var c,l=n[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h,f=c.value;if(f.indexOf("//")>=0)throw new nv(tv.INVALID_ARGUMENT,"Invalid segment (".concat(f,"). Paths must not contain // in them."));(h=a).push.apply(h,e(R)(f.split("/").filter((function(e){return e.length>0}))))}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return new r(a)}},{key:"emptyPath",value:function(){return new r([])}}]),r}(kv),bv=/^[_a-zA-Z][_a-zA-Z0-9]*$/,xv=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.apply(this,arguments)}return e(S)(r,[{key:"construct",value:function(e,t,n){return new r(e,t,n)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return bv.test(e)}},{key:"keyField",value:function(){return new r(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],n="",i=0,a=function(){if(0===n.length)throw new nv(tv.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""},o=!1;i<e.length;){var u=e[i];if("\\"===u){if(i+1===e.length)throw new nv(tv.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new nv(tv.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=s,i+=2}else"`"===u?(o=!o,i++):"."!==u||o?(n+=u,i++):(a(),i++)}if(a(),o)throw new nv(tv.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new r(t)}},{key:"emptyPath",value:function(){return new r([])}}]),r}(kv),Iv=function(){"use strict";function t(n){e(E)(this,t),this.path=n}return e(S)(t,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===wv.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(e){return new t(wv.fromString(e))}},{key:"fromName",value:function(e){return new t(wv.fromString(e).popFirst(5))}},{key:"empty",value:function(){return new t(wv.emptyPath())}},{key:"comparator",value:function(e,t){return wv.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(e){return new t(new wv(e.slice()))}}]),t}(),_v=function t(n,r,i,a){"use strict";e(E)(this,t),this.indexId=n,this.collectionGroup=r,this.fields=i,this.indexState=a};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(e){return e.fields.find((function(e){return 2===e.kind}))}function Ev(e){return e.fields.filter((function(e){return 2!==e.kind}))}_v.UNKNOWN_ID=-1;var Sv=function t(n,r){"use strict";e(E)(this,t),this.fieldPath=n,this.kind=r};var Av=function(){"use strict";function t(n,r){e(E)(this,t),this.sequenceNumber=n,this.offset=r}return e(S)(t,null,[{key:"empty",value:function(){return new t(0,Dv.min())}}]),t}();function Cv(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=gv.fromTimestamp(1e9===r?new mv(n+1,0):new mv(n,r));return new Dv(i,Iv.empty(),t)}function Nv(e){return new Dv(e.readTime,e.key,-1)}var Dv=function(){"use strict";function t(n,r,i){e(E)(this,t),this.readTime=n,this.documentKey=r,this.largestBatchId=i}return e(S)(t,null,[{key:"min",value:function(){return new t(gv.min(),Iv.empty(),-1)}},{key:"max",value:function(){return new t(gv.max(),Iv.empty(),-1)}}]),t}();function Rv(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=Iv.comparator(e.documentKey,t.documentKey))?n:vv(e.largestBatchId,t.largestBatchId)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ov="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Pv=function(){"use strict";function t(){e(E)(this,t),this.onCommittedListeners=[]}return e(S)(t,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),t}();function Lv(e){return Mv.apply(this,arguments)}function Mv(){return(Mv=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.code===tv.FAILED_PRECONDITION&&n.message===Ov){e.next=2;break}throw n;case 2:Qd("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fv=function(){"use strict";function t(n){var r=this;e(E)(this,t),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,n((function(e){r.isDone=!0,r.result=e,r.nextCallback&&r.nextCallback(e)}),(function(e){r.isDone=!0,r.error=e,r.catchCallback&&r.catchCallback(e)}))}return e(S)(t,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(e,n){var r=this;return this.callbackAttached&&Zd(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){var a=r;r.nextCallback=function(n){a.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){a.wrapFailure(n,e).next(t,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}}},{key:"wrapSuccess",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)}},{key:"wrapFailure",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)}}],[{key:"resolve",value:function(e){return new t((function(t,n){t(e)}))}},{key:"reject",value:function(e){return new t((function(t,n){n(e)}))}},{key:"waitFor",value:function(e){return new t((function(t,n){var r=0,i=0,a=!1;e.forEach((function(e){++r,e.next((function(){++i,a&&i===r&&t()}),(function(e){return n(e)}))})),a=!0,i===r&&t()}))}},{key:"or",value:function(e){var n=t.resolve(!1),r=!0,i=!1,a=void 0;try{for(var o,u=function(e,r){var i=r.value;n=n.next((function(e){return e?t.resolve(e):i()}))},s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u(0,o)}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}},{key:"mapArray",value:function(e,n){return new t((function(t,r){for(var i=function(i){var s=i;n(e[s]).next((function(e){o[s]=e,++u===a&&t(o)}),(function(e){return r(e)}))},a=e.length,o=new Array(a),u=0,s=0;s<a;s++)i(s)}))}},{key:"doWhile",value:function(e,n){return new t((function(t,r){var i=function(){!0===e()?n().next((function(){i()}),r):t()};i()}))}}]),t}(),Vv=function(){"use strict";function t(n,r){var i=this;e(E)(this,t),this.action=n,this.transaction=r,this.aborted=!1,this.P=new rv,this.transaction.oncomplete=function(){i.P.resolve()},this.transaction.onabort=function(){r.error?i.P.reject(new Bv(n,r.error)):i.P.resolve()},this.transaction.onerror=function(e){var t=Wv(e.target.error);i.P.reject(new Bv(n,t))}}return e(S)(t,[{key:"v",get:function(){return this.P.promise}},{key:"abort",value:function(e){e&&this.P.reject(e),this.aborted||(Qd("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"V",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new Gv(t)}}],[{key:"open",value:function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Bv(n,e)}}}]),t}(),Uv=function(){"use strict";function t(n,r,i){e(E)(this,t),this.name=n,this.version=r,this.S=i,12.2===t.D(de())&&Yd("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e(S)(t,[{key:"F",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.db,e.t0){e.next=6;break}return Qd("SimpleDb","Opening database:",n.name),e.next=5,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Bv(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new nv(tv.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new nv(tv.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new Bv(t,n))},i.onupgradeneeded=function(e){Qd("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.S.$(t,i.transaction,e.oldVersion,n.version).next((function(){Qd("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:n.db=e.sent;case 6:return n.B&&(n.db.onversionchange=function(e){return n.B(e)}),e.abrupt("return",(e.t0,n.db));case 8:case"end":return e.stop()}}),r)})))()}},{key:"L",value:function(e){this.B=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(t,n,r,i){var a=this;return e(u)(e(s).mark((function o(){var u,c,l,h,f,d;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u="readonly"===n,c=0;case 2:return++c,e.prev=3,e.next=6,a.F(t);case 6:return a.db=e.sent,l=Vv.open(a.db,t,u?"readonly":"readwrite",r),(h=i(l).next((function(e){return l.V(),e})).catch((function(e){return l.abort(e),Fv.reject(e)})).toPromise()).catch((function(){})),e.next=11,l.v;case 11:return e.abrupt("return",(e.sent,h));case 14:if(e.prev=14,e.t0=e.catch(3),f=e.t0,d="FirebaseError"!==f.name&&c<3,Qd("SimpleDb","Transaction failed with error:",f.message,"Retrying:",d),a.close(),d){e.next=19;break}return e.abrupt("return",Promise.reject(f));case 19:e.next=2;break;case 21:case"end":return e.stop()}}),o,null,[[3,14]])})))()}},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return Qd("SimpleDb","Removing database:",e),Kv(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"C",value:function(){if(!ge())return!1;if(t.N())return!0;var e=de(),n=t.D(e),r=0<n&&n<10,i=t.k(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}},{key:"N",value:function(){var e;return void 0!==q&&"YES"===(void 0===(e={})?void 0:e.O)}},{key:"M",value:function(e,t){return e.store(t)}},{key:"D",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"k",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),t}(),qv=function(){"use strict";function t(n){e(E)(this,t),this.q=n,this.U=!1,this.K=null}return e(S)(t,[{key:"isDone",get:function(){return this.U}},{key:"G",get:function(){return this.K}},{key:"cursor",set:function(e){this.q=e}},{key:"done",value:function(){this.U=!0}},{key:"j",value:function(e){this.K=e}},{key:"delete",value:function(){return Kv(this.q.delete())}}]),t}(),Bv=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,tv.UNAVAILABLE,"IndexedDB transaction '".concat(t,"' failed: ").concat(i))).name="IndexedDbTransactionError",e(Fc)(a)}return r}(nv);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jv(e){return"IndexedDbTransactionError"===e.name}var Gv=function(){"use strict";function t(n){e(E)(this,t),this.store=n}return e(S)(t,[{key:"put",value:function(e,t){var n;return void 0!==t?(Qd("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Qd("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Kv(n)}},{key:"add",value:function(e){return Qd("SimpleDb","ADD",this.store.name,e,e),Kv(this.store.add(e))}},{key:"get",value:function(e){var t=this;return Kv(this.store.get(e)).next((function(n){return void 0===n&&(n=null),Qd("SimpleDb","GET",t.store.name,e,n),n}))}},{key:"delete",value:function(e){return Qd("SimpleDb","DELETE",this.store.name,e),Kv(this.store.delete(e))}},{key:"count",value:function(){return Qd("SimpleDb","COUNT",this.store.name),Kv(this.store.count())}},{key:"W",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),i=[];return this.H(r,(function(e,t){i.push(t)})).next((function(){return i}))}var a=this.store.getAll(n.range);return new Fv((function(e,t){a.onerror=function(e){t(e.target.error)},a.onsuccess=function(t){e(t.target.result)}}))}},{key:"J",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new Fv((function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}}))}},{key:"Y",value:function(e,t){Qd("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.X=!1;var r=this.cursor(n);return this.H(r,(function(e,t,n){return n.delete()}))}},{key:"Z",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.H(r,t)}},{key:"tt",value:function(e){var t=this.cursor({});return new Fv((function(n,r){t.onerror=function(e){var t=Wv(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))}},{key:"H",value:function(e,t){var n=[];return new Fv((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new qv(i),o=t(i.primaryKey,i.value,a);if(o instanceof Fv){var u=o.catch((function(e){return a.done(),Fv.reject(e)}));n.push(u)}a.isDone?r():null===a.G?i.continue():i.continue(a.G)}else r()}})).next((function(){return Fv.waitFor(n)}))}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),t}();function Kv(e){return new Fv((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=Wv(e.target.error);n(t)}}))}var zv=!1;function Wv(e){var t=Uv.D(de());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new nv("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return zv||(zv=!0,setTimeout((function(){throw r}),0)),r}}return e}var Hv=function(){"use strict";function t(n,r){e(E)(this,t),this.asyncQueue=n,this.et=r,this.task=null}return e(S)(t,[{key:"start",value:function(){this.nt(15e3)}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"nt",value:function(t){var n=this;Qd("IndexBackiller","Scheduled in ".concat(t,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.task=null,e.prev=1,e.t0=Qd,e.t1="Documents written: ",e.next=6,n.et.st();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!jv(e.t4)){e.next=17;break}Qd("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,Lv(e.t4);case 19:return e.next=21,n.nt(6e4);case 21:case"end":return e.stop()}}),t,null,[[1,11]])}))))}}]),t}(),Qv=function(){"use strict";function t(n,r){e(E)(this,t),this.localStore=n,this.persistence=r}return e(S)(t,[{key:"st",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.persistence.runTransaction("Backfill Indexes","readwrite-primary",(function(e){return n.it(e,t)})));case 1:case"end":return e.stop()}}),r)})))()}},{key:"it",value:function(e,t){var n=this,r=new Set,i=t,a=!0;return Fv.doWhile((function(){return!0===a&&i>0}),(function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((function(t){if(null!==t&&!r.has(t))return Qd("IndexBackiller","Processing collection: ".concat(t)),n.rt(e,t,i).next((function(e){i-=e,r.add(t)}));a=!1}))})).next((function(){return t-i}))}},{key:"rt",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((function(i){return r.localStore.localDocuments.getNextDocuments(e,t,i,n).next((function(n){var a=r,o=n.changes;return r.localStore.indexManager.updateIndexEntries(e,o).next((function(){return a.ot(i,n)})).next((function(n){return Qd("IndexBackiller","Updating offset: ".concat(n)),a.localStore.indexManager.updateCollectionGroup(e,t,n)})).next((function(){return o.size}))}))}))}},{key:"ot",value:function(e,t){var n=e;return t.changes.forEach((function(e,t){var r=Nv(t);Rv(r,n)>0&&(n=r)})),new Dv(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}]),t}(),Yv=function(){"use strict";function t(n,r){var i=this;e(E)(this,t),this.previousValue=n,r&&(r.sequenceNumberHandler=function(e){return i.ut(e)},this.ct=function(e){return r.writeSequenceNumber(e)})}return e(S)(t,[{key:"ut",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.ct&&this.ct(e),e}}]),t}();Yv.at=-1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Xv=function t(n,r,i,a,o,u,s,c){"use strict";e(E)(this,t),this.databaseId=n,this.appId=r,this.persistenceKey=i,this.host=a,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=s,this.useFetchStreams=c},Jv=function(){"use strict";function t(n,r){e(E)(this,t),this.projectId=n,this.database=r||"(default)"}return e(S)(t,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}}],[{key:"empty",value:function(){return new t("","")}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Zv(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function $v(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ep(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tp(e){return null==e}function np(e){return 0===e&&1/e==-1/0}function rp(e){return"number"==typeof e&&Number.isInteger(e)&&!np(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ip=Symbol.iterator,ap=function(){"use strict";function t(n){e(E)(this,t),this.binaryString=n}return e(S)(t,[{key:ip,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){var e;return e=this.binaryString,btoa(e)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return vv(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ap.EMPTY_BYTE_STRING=new ap("");var op=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function up(e){if($d(!!e),"string"==typeof e){var t=0,n=op.exec(e);if($d(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:sp(e.seconds),nanos:sp(e.nanos)}}function sp(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function cp(e){return"string"==typeof e?ap.fromBase64String(e):ap.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function hp(e){var t=e.mapValue.fields.__previous_value__;return lp(t)?hp(t):t}function fp(e){var t=up(e.mapValue.fields.__local_write_time__.timestampValue);return new mv(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dp={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},vp={nullValue:"NULL_VALUE"};function pp(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?lp(e)?4:Cp(e)?9007199254740991:10:Zd()}function yp(e,t){if(e===t)return!0;var n,r=pp(e);if(r!==pp(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return fp(e).isEqual(fp(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=up(e.timestampValue),r=up(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,cp(e.bytesValue).isEqual(cp(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return sp(e.geoPointValue.latitude)===sp(t.geoPointValue.latitude)&&sp(e.geoPointValue.longitude)===sp(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return sp(e.integerValue)===sp(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=sp(e.doubleValue),r=sp(t.doubleValue);return n===r?np(n)===np(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return pv(e.arrayValue.values||[],t.arrayValue.values||[],yp);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Zv(n)!==Zv(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!yp(n[i],r[i])))return!1;return!0}(e,t);default:return Zd()}}function mp(e,t){return void 0!==(e.values||[]).find((function(e){return yp(e,t)}))}function gp(e,t){if(e===t)return 0;var n,r,i,a,o=pp(e),u=pp(t);if(o!==u)return vv(o,u);switch(o){case 0:case 9007199254740991:return 0;case 1:return vv(e.booleanValue,t.booleanValue);case 2:return r=t,i=sp((n=e).integerValue||n.doubleValue),a=sp(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return kp(e.timestampValue,t.timestampValue);case 4:return kp(fp(e),fp(t));case 5:return vv(e.stringValue,t.stringValue);case 6:return function(e,t){var n=cp(e),r=cp(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=vv(n[i],r[i]);if(0!==a)return a}return vv(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=vv(sp(e.latitude),sp(t.latitude));return 0!==n?n:vv(sp(e.longitude),sp(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=gp(n[i],r[i]);if(a)return a}return vv(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===dp.mapValue&&t===dp.mapValue)return 0;if(e===dp.mapValue)return 1;if(t===dp.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var u=vv(r[o],a[o]);if(0!==u)return u;var s=gp(n[r[o]],i[a[o]]);if(0!==s)return s}return vv(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Zd()}}function kp(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return vv(e,t);var n=up(e),r=up(t),i=vv(n.seconds,r.seconds);return 0!==i?i:vv(n.nanos,r.nanos)}function wp(e){return bp(e)}function bp(e){var t,n,r,i;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(r=e.timestampValue,i=up(r),"time(".concat(i.seconds,",").concat(i.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?cp(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Iv.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t="[",n=!0,r=!0,i=!1,a=void 0;try{for(var o,u=(e.values||[])[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n?n=!1:t+=",",t+=bp(s)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return t+"]"}(e.arrayValue):"mapValue"in e?function(e){var t=Object.keys(e.fields||{}).sort(),n="{",r=!0,i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;r?r=!1:n+=",",n+="".concat(c,":").concat(bp(e.fields[c]))}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return n+"}"}(e.mapValue):Zd()}function xp(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Ip(e){return!!e&&"integerValue"in e}function _p(e){return!!e&&"arrayValue"in e}function Tp(e){return!!e&&"nullValue"in e}function Ep(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Sp(e){return!!e&&"mapValue"in e}function Ap(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return $v(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=Ap(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Ap(e.arrayValue.values[r]);return n}return Object.assign({},e)}function Cp(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Np(e){return"nullValue"in e?vp:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?xp(Jv.empty(),Iv.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:Zd()}function Dp(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?xp(Jv.empty(),Iv.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?dp:Zd()}function Rp(e,t){var n=gp(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Op(e,t){var n=gp(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pp=function t(n,r){"use strict";e(E)(this,t),this.position=n,this.inclusive=r};function Lp(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?Iv.comparator(Iv.fromName(o.referenceValue),n.key):gp(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function Mp(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!yp(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fp=function t(){"use strict";e(E)(this,t)},Vp=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o;return e(E)(this,r),(o=n.call(this)).field=t,o.op=i,o.value=a,e(Fc)(o)}return e(S)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(gp(t,this.value)):null!==t&&pp(this.value)===pp(t)&&this.matchesComparison(gp(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Zd()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}},{key:"getFirstInequalityField",value:function(){return this.isInequality()?this.field:null}}],[{key:"create",value:function(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Qp(e,t,n):"array-contains"===t?new Zp(e,n):"in"===t?new $p(e,n):"not-in"===t?new ey(e,n):"array-contains-any"===t?new ty(e,n):new r(e,t,n)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new Yp(e,n):new Xp(e,n)}}]),r}(Fp),Up=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this)).filters=t,a.op=i,a.ht=null,e(Fc)(a)}return e(S)(r,[{key:"matches",value:function(e){return qp(this)?void 0===this.filters.find((function(t){return!t.matches(e)})):void 0!==this.filters.find((function(t){return t.matches(e)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.ht||(this.ht=this.filters.reduce((function(e,t){return e.concat(t.getFlattenedFilters())}),[])),this.ht}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}},{key:"getFirstInequalityField",value:function(){var e=this.lt((function(e){return e.isInequality()}));return null!==e?e.field:null}},{key:"lt",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.getFlattenedFilters()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(e(o))return o}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}}],[{key:"create",value:function(e,t){return new r(e,t)}}]),r}(Fp);function qp(e){return"and"===e.op}function Bp(e){return"or"===e.op}function jp(e){return Gp(e)&&qp(e)}function Gp(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.filters[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value instanceof Up)return!1}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!0}function Kp(e){if(e instanceof Vp)return e.field.canonicalString()+e.op.toString()+wp(e.value);if(jp(e))return e.filters.map((function(e){return Kp(e)})).join(",");var t=e.filters.map((function(e){return Kp(e)})).join(",");return"".concat(e.op,"(").concat(t,")")}function zp(e,t){return e instanceof Vp?(n=e,(r=t)instanceof Vp&&n.op===r.op&&n.field.isEqual(r.field)&&yp(n.value,r.value)):e instanceof Up?function(e,t){return t instanceof Up&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((function(e,n,r){return e&&zp(n,t.filters[r])}),!0)}(e,t):void Zd();var n,r}function Wp(e,t){var n=e.filters.concat(t);return Up.create(n,e.op)}function Hp(e){return e instanceof Vp?"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(wp(t.value)):e instanceof Up?function(e){return e.op.toString()+" {"+e.getFilters().map(Hp).join(" ,")+"}"}(e):"Filter";var t}var Qp=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o;return e(E)(this,r),(o=n.call(this,t,i,a)).key=Iv.fromName(a.referenceValue),e(Fc)(o)}return e(S)(r,[{key:"matches",value:function(e){var t=Iv.comparator(e.key,this.key);return this.matchesComparison(t)}}]),r}(Vp),Yp=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,t,"in",i)).keys=Jp("in",i),e(Fc)(a)}return e(S)(r,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),r}(Vp),Xp=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,t,"not-in",i)).keys=Jp("not-in",i),e(Fc)(a)}return e(S)(r,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),r}(Vp);function Jp(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return Iv.fromName(e.referenceValue)}))}var Zp=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){return e(E)(this,r),n.call(this,t,"array-contains",i)}return e(S)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return _p(t)&&mp(t.arrayValue,this.value)}}]),r}(Vp),$p=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){return e(E)(this,r),n.call(this,t,"in",i)}return e(S)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&mp(this.value.arrayValue,t)}}]),r}(Vp),ey=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){return e(E)(this,r),n.call(this,t,"not-in",i)}return e(S)(r,[{key:"matches",value:function(e){if(mp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!mp(this.value.arrayValue,t)}}]),r}(Vp),ty=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){return e(E)(this,r),n.call(this,t,"array-contains-any",i)}return e(S)(r,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!_p(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return mp(t.value.arrayValue,e)}))}}]),r}(Vp),ny=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";e(E)(this,t),this.field=n,this.dir=r};function ry(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var iy=function(){"use strict";function t(n,r){e(E)(this,t),this.comparator=n,this.root=r||oy.EMPTY}return e(S)(t,[{key:"insert",value:function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,oy.BLACK,null,null))}},{key:"remove",value:function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,oy.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new ay(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new ay(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new ay(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new ay(this.root,e,this.comparator,!0)}}]),t}(),ay=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.isReverse=a,this.nodeStack=[];for(var o=1;!n.isEmpty();)if(o=r?i(n.key,r):1,r&&a&&(o*=-1),o<0)n=this.isReverse?n.left:n.right;else{if(0===o){this.nodeStack.push(n);break}this.nodeStack.push(n),n=this.isReverse?n.right:n.left}}return e(S)(t,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),t}(),oy=function(){"use strict";function t(n,r,i,a,o){e(E)(this,t),this.key=n,this.value=r,this.color=null!=i?i:t.RED,this.left=null!=a?a:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return e(S)(t,[{key:"copy",value:function(e,n,r,i,a){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}},{key:"rotateRight",value:function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw Zd();if(this.right.isRed())throw Zd();var e=this.left.check();if(e!==this.right.check())throw Zd();return e+(this.isRed()?0:1)}}]),t}();oy.EMPTY=null,oy.RED=!0,oy.BLACK=!1,oy.EMPTY=new(function(){"use strict";function t(){e(E)(this,t),this.size=0}return e(S)(t,[{key:"key",get:function(){throw Zd()}},{key:"value",get:function(){throw Zd()}},{key:"color",get:function(){throw Zd()}},{key:"left",get:function(){throw Zd()}},{key:"right",get:function(){throw Zd()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new oy(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var uy=function(){"use strict";function t(n){e(E)(this,t),this.comparator=n,this.data=new iy(this.comparator)}return e(S)(t,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new sy(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new sy(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(e){var n=new t(this.comparator);return n.data=e,n}}]),t}(),sy=function(){"use strict";function t(n){e(E)(this,t),this.iter=n}return e(S)(t,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),t}();function cy(e){return e.hasNext()?e.getNext():void 0}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ly=function(){"use strict";function t(n){e(E)(this,t),this.fields=n,n.sort(xv.comparator)}return e(S)(t,[{key:"unionWith",value:function(e){var n=new uy(xv.comparator),r=!0,i=!1,a=void 0;try{for(var o,u=this.fields[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n=n.add(s)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}var c=!0,l=!1,h=void 0;try{for(var f,d=e[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value;n=n.add(v)}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return new t(n.toArray())}},{key:"covers",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.fields[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.isPrefixOf(e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"isEqual",value:function(e){return pv(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new t([])}}]),t}(),hy=function(){"use strict";function t(n){e(E)(this,t),this.value=n}return e(S)(t,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!Sp(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ap(t)}},{key:"setAll",value:function(e){var t=this,n=xv.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=Ap(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());Sp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return yp(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];Sp(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){$v(t,(function(t,n){return e[t]=n}));var r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;delete e[s]}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"clone",value:function(){return new t(Ap(this.value))}}],[{key:"empty",value:function(){return new t({mapValue:{}})}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fy(e){var t=[];return $v(e.fields,(function(e,n){var r=new xv([e]);if(Sp(n)){var i=fy(n.mapValue).fields,a=!0,o=!1,u=void 0;if(0===i.length)t.push(r);else try{for(var s,c=i[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;t.push(r.child(l))}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}}else t.push(r)})),new ly(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var dy=function(){"use strict";function t(n,r,i,a,o,u,s){e(E)(this,t),this.key=n,this.documentType=r,this.version=i,this.readTime=a,this.createTime=o,this.data=u,this.documentState=s}return e(S)(t,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual(gv.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=hy.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=hy.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=gv.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}},{key:"mutableCopy",value:function(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(e){return new t(e,0,gv.min(),gv.min(),gv.min(),hy.empty(),0)}},{key:"newFoundDocument",value:function(e,n,r,i){return new t(e,1,n,gv.min(),r,i,0)}},{key:"newNoDocument",value:function(e,n){return new t(e,2,n,gv.min(),gv.min(),hy.empty(),0)}},{key:"newUnknownDocument",value:function(e,n){return new t(e,3,n,gv.min(),gv.min(),hy.empty(),2)}}]),t}(),vy=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;e(E)(this,t),this.path=n,this.collectionGroup=r,this.orderBy=i,this.filters=a,this.limit=o,this.startAt=u,this.endAt=s,this.ft=null};
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new vy(e,t,n,r,i,a,o)}function yy(e){var t=ev(e);if(null===t.ft){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return Kp(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return(t=e).field.canonicalString()+t.dir;var t})).join(","),tp(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return wp(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return wp(e)})).join(",")),t.ft=n}return t.ft}function my(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!ry(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!zp(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Mp(e.startAt,t.startAt)&&Mp(e.endAt,t.endAt)}function gy(e){return Iv.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function ky(e,t){return e.filters.filter((function(e){return e instanceof Vp&&e.field.isEqual(t)}))}function wy(e,t,n){var r=vp,i=!0,a=!0,o=!1,u=void 0;try{for(var s,c=ky(e,t)[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,h=vp,f=!0;switch(l.op){case"<":case"<=":h=Np(l.value);break;case"==":case"in":case">=":h=l.value;break;case">":h=l.value,f=!1;break;case"!=":case"not-in":h=vp}Rp({value:r,inclusive:i},{value:h,inclusive:f})<0&&(r=h,i=f)}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}if(null!==n)for(var d=0;d<e.orderBy.length;++d)if(e.orderBy[d].field.isEqual(t)){var v=n.position[d];Rp({value:r,inclusive:i},{value:v,inclusive:n.inclusive})<0&&(r=v,i=n.inclusive);break}return{value:r,inclusive:i}}function by(e,t,n){var r=dp,i=!0,a=!0,o=!1,u=void 0;try{for(var s,c=ky(e,t)[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,h=dp,f=!0;switch(l.op){case">=":case">":h=Dp(l.value),f=!1;break;case"==":case"in":case"<=":h=l.value;break;case"<":h=l.value,f=!1;break;case"!=":case"not-in":h=dp}Op({value:r,inclusive:i},{value:h,inclusive:f})>0&&(r=h,i=f)}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}if(null!==n)for(var d=0;d<e.orderBy.length;++d)if(e.orderBy[d].field.isEqual(t)){var v=n.position[d];Op({value:r,inclusive:i},{value:v,inclusive:n.inclusive})>0&&(r=v,i=n.inclusive);break}return{value:r,inclusive:i}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xy=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;e(E)(this,t),this.path=n,this.collectionGroup=r,this.explicitOrderBy=i,this.filters=a,this.limit=o,this.limitType=u,this.startAt=s,this.endAt=c,this.dt=null,this._t=null,this.startAt,this.endAt};function Iy(e,t,n,r,i,a,o,u){return new xy(e,t,n,r,i,a,o,u)}function _y(e){return new xy(e)}function Ty(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Ey(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Sy(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.filters[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value.getFirstInequalityField();if(null!==o)return o}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}function Ay(e){return null!==e.collectionGroup}function Cy(e){var t=ev(e);if(null===t.dt){t.dt=[];var n=Sy(t),r=Ey(t);if(null!==n&&null===r)n.isKeyField()||t.dt.push(new ny(n)),t.dt.push(new ny(xv.keyField(),"asc"));else{var i=!1,a=!0,o=!1,u=void 0;try{for(var s,c=t.explicitOrderBy[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;t.dt.push(l),l.field.isKeyField()&&(i=!0)}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}if(!i){var h=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.dt.push(new ny(xv.keyField(),h))}}}return t.dt}function Ny(e){var t=ev(e);if(!t._t)if("F"===t.limitType)t._t=py(t.path,t.collectionGroup,Cy(t),t.filters,t.limit,t.startAt,t.endAt);else{var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=Cy(t)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c="desc"===s.dir?"asc":"desc";n.push(new ny(s.field,c))}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}var l=t.endAt?new Pp(t.endAt.position,t.endAt.inclusive):null,h=t.startAt?new Pp(t.startAt.position,t.startAt.inclusive):null;t._t=py(t.path,t.collectionGroup,n,t.filters,t.limit,l,h)}return t._t}function Dy(e,t){t.getFirstInequalityField(),Sy(e);var n=e.filters.concat([t]);return new xy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Ry(e,t,n){return new xy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Oy(e,t){return my(Ny(e),Ny(t))&&e.limitType===t.limitType}function Py(e){return"".concat(yy(Ny(e)),"|lt:").concat(e.limitType)}function Ly(e){return"Query(target=".concat((t=Ny(e),n=t.path.canonicalString(),null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=", filters: [".concat(t.filters.map((function(e){return Hp(e)})).join(", "),"]")),tp(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=", orderBy: [".concat(t.orderBy.map((function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t})).join(", "),"]")),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return wp(e)})).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return wp(e)})).join(",")),"Target(".concat(n,")")),"; limitType=").concat(e.limitType,")");var t,n}function My(e,t){return t.isFoundDocument()&&(i=e,o=(a=t).key.path,null!==i.collectionGroup?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Iv.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o))&&function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=Cy(e)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(!u.field.isKeyField()&&null===t.data.field(u.field))return!1}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(e,t)&&function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=e.filters[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){if(!a.value.matches(t))return!1}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){var r=Lp(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,Cy(n),r)||n.endAt&&!function(e,t,n){var r=Lp(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,Cy(n),r)));var n,r,i,a,o}function Fy(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Vy(e){return function(t,n){var r=!1,i=!0,a=!1,o=void 0;try{for(var u,s=Cy(e)[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=Uy(c,t,n);if(0!==l)return l;r=r||c.field.isKeyField()}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return 0}}function Uy(e,t,n){var r=e.field.isKeyField()?Iv.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?gp(r,i):Zd()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Zd()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qy(e,t){if(e.wt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:np(t)?"-0":t}}function By(e){return{integerValue:""+e}}function jy(e,t){return rp(t)?By(t):qy(e,t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gy=function t(){"use strict";e(E)(this,t),this._=void 0};function Ky(e,t,n){return e instanceof Hy?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof Qy?Yy(e,t):e instanceof Xy?Jy(e,t):function(e,t){var n=Wy(e,t),r=$y(n)+$y(e.gt);return Ip(n)&&Ip(e.gt)?By(r):qy(e.yt,r)}(e,t);var r,i,a}function zy(e,t,n){return e instanceof Qy?Yy(e,t):e instanceof Xy?Jy(e,t):n}function Wy(e,t){var n,r;return e instanceof Zy?Ip(n=t)||(r=n)&&"doubleValue"in r?t:{integerValue:0}:null}var Hy=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.apply(this,arguments)}return r}(Gy),Qy=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this)).elements=t,e(Fc)(i)}return r}(Gy);function Yy(e,t){var n=em(t),r=!0,i=!1,a=void 0;try{for(var o,u=function(e,t){var r=t.value;n.some((function(e){return yp(e,r)}))||n.push(r)},s=e.elements[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u(0,o)}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var Xy=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this)).elements=t,e(Fc)(i)}return r}(Gy);function Jy(e,t){var n=em(t),r=!0,i=!1,a=void 0;try{for(var o,u=function(e,t){var r=t.value;n=n.filter((function(e){return!yp(e,r)}))},s=e.elements[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u(0,o)}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var Zy=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this)).yt=t,a.gt=i,e(Fc)(a)}return r}(Gy);function $y(e){return sp(e.integerValue||e.doubleValue)}function em(e){return _p(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tm=function t(n,r){"use strict";e(E)(this,t),this.field=n,this.transform=r};var nm=function t(n,r){"use strict";e(E)(this,t),this.version=n,this.transformResults=r},rm=function(){"use strict";function t(n,r){e(E)(this,t),this.updateTime=n,this.exists=r}return e(S)(t,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new t}},{key:"exists",value:function(e){return new t(void 0,e)}},{key:"updateTime",value:function(e){return new t(e)}}]),t}();function im(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var am=function t(){"use strict";e(E)(this,t)};function om(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new gm(e.key,rm.none()):new hm(e.key,e.data,rm.none());var n=e.data,r=hy.empty(),i=new uy(xv.comparator),a=!0,o=!1,u=void 0;try{for(var s,c=t.fields[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;if(!i.has(l)){var h=n.field(l);null===h&&l.length>1&&(l=l.popLast(),h=n.field(l)),null===h?r.delete(l):r.set(l,h),i=i.add(l)}}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return new fm(e.key,r,new ly(i.toArray()),rm.none())}function um(e,t,n){var r;e instanceof hm?function(e,t,n){var r=e.value.clone(),i=vm(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof fm?function(e,t,n){if(im(e.precondition,t)){var r=vm(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(dm(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):(r=n,t.convertToNoDocument(r.version).setHasCommittedMutations())}function sm(e,t,n,r){return e instanceof hm?function(e,t,n,r){if(!im(e.precondition,t))return n;var i=e.value.clone(),a=pm(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof fm?function(e,t,n,r){if(!im(e.precondition,t))return n;var i=pm(e.fieldTransforms,r,t),a=t.data;return a.setAll(dm(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):(i=t,a=n,im(e.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function cm(e,t){var n=null,r=!0,i=!1,a=void 0;try{for(var o,u=e.fieldTransforms[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c=t.data.field(s.field),l=Wy(s.transform,c||null);null!=l&&(null===n&&(n=hy.empty()),n.set(s.field,l))}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n||null}function lm(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&pv(n,r,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof Qy&&r instanceof Qy||n instanceof Xy&&r instanceof Xy?pv(n.elements,r.elements,yp):n instanceof Zy&&r instanceof Zy?yp(n.gt,r.gt):n instanceof Hy&&r instanceof Hy);var n,r}(e,t)}))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var hm=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return e(E)(this,r),(o=n.call(this)).key=t,o.value=i,o.precondition=a,o.fieldTransforms=u,o.type=0,e(Fc)(o)}return e(S)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(am),fm=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a,o){var u,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return e(E)(this,r),(u=n.call(this)).key=t,u.data=i,u.fieldMask=a,u.precondition=o,u.fieldTransforms=s,u.type=1,e(Fc)(u)}return e(S)(r,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),r}(am);function dm(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function vm(e,t,n){var r=new Map;$d(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,u=t.data.field(a.field);r.set(a.field,zy(o,u,n[i]))}return r}function pm(e,t,n){var r=new Map,i=!0,a=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=c.transform,h=n.data.field(c.field);r.set(c.field,Ky(l,h,t))}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r}var ym,mm,gm=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this)).key=t,a.precondition=i,a.type=2,a.fieldTransforms=[],e(Fc)(a)}return e(S)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(am),km=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this)).key=t,a.precondition=i,a.type=3,a.fieldTransforms=[],e(Fc)(a)}return e(S)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(am),wm=function t(n){"use strict";e(E)(this,t),this.count=n};function bm(e){switch(e){default:return Zd();case tv.CANCELLED:case tv.UNKNOWN:case tv.DEADLINE_EXCEEDED:case tv.RESOURCE_EXHAUSTED:case tv.INTERNAL:case tv.UNAVAILABLE:case tv.UNAUTHENTICATED:return!1;case tv.INVALID_ARGUMENT:case tv.NOT_FOUND:case tv.ALREADY_EXISTS:case tv.PERMISSION_DENIED:case tv.FAILED_PRECONDITION:case tv.ABORTED:case tv.OUT_OF_RANGE:case tv.UNIMPLEMENTED:case tv.DATA_LOSS:return!0}}function xm(e){if(void 0===e)return Yd("GRPC error has no .code"),tv.UNKNOWN;switch(e){case ym.OK:return tv.OK;case ym.CANCELLED:return tv.CANCELLED;case ym.UNKNOWN:return tv.UNKNOWN;case ym.DEADLINE_EXCEEDED:return tv.DEADLINE_EXCEEDED;case ym.RESOURCE_EXHAUSTED:return tv.RESOURCE_EXHAUSTED;case ym.INTERNAL:return tv.INTERNAL;case ym.UNAVAILABLE:return tv.UNAVAILABLE;case ym.UNAUTHENTICATED:return tv.UNAUTHENTICATED;case ym.INVALID_ARGUMENT:return tv.INVALID_ARGUMENT;case ym.NOT_FOUND:return tv.NOT_FOUND;case ym.ALREADY_EXISTS:return tv.ALREADY_EXISTS;case ym.PERMISSION_DENIED:return tv.PERMISSION_DENIED;case ym.FAILED_PRECONDITION:return tv.FAILED_PRECONDITION;case ym.ABORTED:return tv.ABORTED;case ym.OUT_OF_RANGE:return tv.OUT_OF_RANGE;case ym.UNIMPLEMENTED:return tv.UNIMPLEMENTED;case ym.DATA_LOSS:return tv.DATA_LOSS;default:return Zd()}}(mm=ym||(ym={}))[mm.OK=0]="OK",mm[mm.CANCELLED=1]="CANCELLED",mm[mm.UNKNOWN=2]="UNKNOWN",mm[mm.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mm[mm.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mm[mm.NOT_FOUND=5]="NOT_FOUND",mm[mm.ALREADY_EXISTS=6]="ALREADY_EXISTS",mm[mm.PERMISSION_DENIED=7]="PERMISSION_DENIED",mm[mm.UNAUTHENTICATED=16]="UNAUTHENTICATED",mm[mm.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mm[mm.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mm[mm.ABORTED=10]="ABORTED",mm[mm.OUT_OF_RANGE=11]="OUT_OF_RANGE",mm[mm.UNIMPLEMENTED=12]="UNIMPLEMENTED",mm[mm.INTERNAL=13]="INTERNAL",mm[mm.UNAVAILABLE=14]="UNAVAILABLE",mm[mm.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Im=function(){"use strict";function t(n,r){e(E)(this,t),this.mapKeyFn=n,this.equalsFn=r,this.inner={},this.innerSize=0}return e(S)(t,[{key:"get",value:function(t){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){var i=!0,a=!1,o=void 0;try{for(var u,s=r[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=e(D)(u.value,2),l=c[0],h=c[1];if(this.equalsFn(l,t))return h}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(t){$v(this.inner,(function(n,r){var i=!0,a=!1,o=void 0;try{for(var u,s=r[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=e(D)(u.value,2),l=c[0],h=c[1];t(l,h)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}))}},{key:"isEmpty",value:function(){return ep(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),t}(),_m=new iy(Iv.comparator);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(){return _m}var Em=new iy(Iv.comparator);function Sm(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Em,i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;r=r.insert(c.key,c)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r}function Am(e){var t=Em;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function Cm(){return Dm()}function Nm(){return Dm()}function Dm(){return new Im((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var Rm=new iy(Iv.comparator),Om=new uy(Iv.comparator);function Pm(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Om,i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;r=r.add(c)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r}var Lm=new uy(vv);function Mm(){return Lm}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fm=function(){"use strict";function t(n,r,i,a,o){e(E)(this,t),this.snapshotVersion=n,this.targetChanges=r,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=o}return e(S)(t,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(e,n,r){var i=new Map;return i.set(e,Vm.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(gv.min(),i,Mm(),Tm(),Pm())}}]),t}(),Vm=function(){"use strict";function t(n,r,i,a,o){e(E)(this,t),this.resumeToken=n,this.current=r,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=o}return e(S)(t,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(e,n,r){return new t(r,n,Pm(),Pm(),Pm())}}]),t}(),Um=function t(n,r,i,a){"use strict";e(E)(this,t),this.It=n,this.removedTargetIds=r,this.key=i,this.Tt=a},qm=function t(n,r){"use strict";e(E)(this,t),this.targetId=n,this.Et=r},Bm=function t(n,r){"use strict";var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ap.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e(E)(this,t),this.state=n,this.targetIds=r,this.resumeToken=i,this.cause=a},jm=function(){"use strict";function t(){e(E)(this,t),this.At=0,this.Rt=zm(),this.bt=ap.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}return e(S)(t,[{key:"current",get:function(){return this.Pt}},{key:"resumeToken",get:function(){return this.bt}},{key:"Vt",get:function(){return 0!==this.At}},{key:"St",get:function(){return this.vt}},{key:"Dt",value:function(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}},{key:"Ct",value:function(){var e=Pm(),t=Pm(),n=Pm();return this.Rt.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Zd()}})),new Vm(this.bt,this.Pt,e,t,n)}},{key:"xt",value:function(){this.vt=!1,this.Rt=zm()}},{key:"Nt",value:function(e,t){this.vt=!0,this.Rt=this.Rt.insert(e,t)}},{key:"kt",value:function(e){this.vt=!0,this.Rt=this.Rt.remove(e)}},{key:"Ot",value:function(){this.At+=1}},{key:"Mt",value:function(){this.At-=1}},{key:"Ft",value:function(){this.vt=!0,this.Pt=!0}}]),t}(),Gm=function(){"use strict";function t(n){e(E)(this,t),this.$t=n,this.Bt=new Map,this.Lt=Tm(),this.qt=Km(),this.Ut=new uy(vv)}return e(S)(t,[{key:"Kt",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.It[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;e.Tt&&e.Tt.isFoundDocument()?this.Gt(o,e.Tt):this.Qt(o,e.key,e.Tt)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var u=!0,s=!1,c=void 0;try{for(var l,h=e.removedTargetIds[Symbol.iterator]();!(u=(l=h.next()).done);u=!0){var f=l.value;this.Qt(f,e.key,e.Tt)}}catch(e){s=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(s)throw c}}}},{key:"jt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.Wt(n);switch(e.state){case 0:t.zt(n)&&r.Dt(e.resumeToken);break;case 1:r.Mt(),r.Vt||r.xt(),r.Dt(e.resumeToken);break;case 2:r.Mt(),r.Vt||t.removeTarget(n);break;case 3:t.zt(n)&&(r.Ft(),r.Dt(e.resumeToken));break;case 4:t.zt(n)&&(t.Ht(n),r.Dt(e.resumeToken));break;default:Zd()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach((function(e,r){n.zt(r)&&t(r)}))}},{key:"Jt",value:function(e){var t=e.targetId,n=e.Et.count,r=this.Yt(t);if(r){var i=r.target;if(gy(i))if(0===n){var a=new Iv(i.path);this.Qt(t,a,dy.newNoDocument(a,gv.min()))}else $d(1===n);else this.Xt(t)!==n&&(this.Ht(t),this.Ut=this.Ut.add(t))}}},{key:"Zt",value:function(e){var t=this,n=new Map;this.Bt.forEach((function(r,i){var a=t.Yt(i);if(a){if(r.current&&gy(a.target)){var o=new Iv(a.target.path);null!==t.Lt.get(o)||t.te(i,o)||t.Qt(i,o,dy.newNoDocument(o,e))}r.St&&(n.set(i,r.Ct()),r.xt())}}));var r=Pm();this.qt.forEach((function(e,n){var i=t,a=!0;n.forEachWhile((function(e){var t=i.Yt(e);return!t||2===t.purpose||(a=!1,!1)})),a&&(r=r.add(e))})),this.Lt.forEach((function(t,n){return n.setReadTime(e)}));var i=new Fm(e,n,this.Ut,this.Lt,r);return this.Lt=Tm(),this.qt=Km(),this.Ut=new uy(vv),i}},{key:"Gt",value:function(e,t){if(this.zt(e)){var n=this.te(e,t.key)?2:0;this.Wt(e).Nt(t.key,n),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}}},{key:"Qt",value:function(e,t,n){if(this.zt(e)){var r=this.Wt(e);this.te(e,t)?r.Nt(t,1):r.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),n&&(this.Lt=this.Lt.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Bt.delete(e)}},{key:"Xt",value:function(e){var t=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Ot",value:function(e){this.Wt(e).Ot()}},{key:"Wt",value:function(e){var t=this.Bt.get(e);return t||(t=new jm,this.Bt.set(e,t)),t}},{key:"ee",value:function(e){var t=this.qt.get(e);return t||(t=new uy(vv),this.qt=this.qt.insert(e,t)),t}},{key:"zt",value:function(e){var t=null!==this.Yt(e);return t||Qd("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Yt",value:function(e){var t=this.Bt.get(e);return t&&t.Vt?null:this.$t.ne(e)}},{key:"Ht",value:function(e){var t=this;this.Bt.set(e,new jm),this.$t.getRemoteKeysForTarget(e).forEach((function(n){t.Qt(e,n,null)}))}},{key:"te",value:function(e,t){return this.$t.getRemoteKeysForTarget(e).has(t)}}]),t}();function Km(){return new iy(Iv.comparator)}function zm(){return new iy(Iv.comparator)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wm={asc:"ASCENDING",desc:"DESCENDING"},Hm={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Qm={and:"AND",or:"OR"},Ym=function t(n,r){"use strict";e(E)(this,t),this.databaseId=n,this.wt=r};function Xm(e,t){return e.wt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Jm(e,t){return e.wt?t.toBase64():t.toUint8Array()}function Zm(e,t){return Xm(e,t.toTimestamp())}function $m(e){return $d(!!e),gv.fromTimestamp((t=up(e),new mv(t.seconds,t.nanos)));var t}function eg(e,t){return(n=e,new wv(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function tg(e){var t=wv.fromString(e);return $d(bg(t)),t}function ng(e,t){return eg(e.databaseId,t.path)}function rg(e,t){var n=tg(t);if(n.get(1)!==e.databaseId.projectId)throw new nv(tv.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new nv(tv.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Iv(ug(n))}function ig(e,t){return eg(e.databaseId,t)}function ag(e){var t=tg(e);return 4===t.length?wv.emptyPath():ug(t)}function og(e){return new wv(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ug(e){return $d(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function sg(e,t,n){return{name:ng(e,t),fields:n.value.mapValue.fields}}function cg(e,t,n){var r=rg(e,t.name),i=$m(t.updateTime),a=t.createTime?$m(t.createTime):gv.min(),o=new hy({mapValue:{fields:t.fields}}),u=dy.newFoundDocument(r,i,a,o);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function lg(e,t){var n,r,i;if(t instanceof hm)n={update:sg(e,t.key,t.value)};else if(t instanceof gm)n={delete:ng(e,t.key)};else if(t instanceof fm)n={update:sg(e,t.key,t.data),updateMask:(r=t.fieldMask,i=[],r.fields.forEach((function(e){return i.push(e.canonicalString())})),{fieldPaths:i})};else{if(!(t instanceof km))return Zd();n={verify:ng(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof Hy)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Qy)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Xy)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Zy)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw Zd()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Zm(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Zd()}(e,t.precondition)),n}function hg(e,t){var n,r,i,a=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?rm.updateTime($m(n.updateTime)):void 0!==n.exists?rm.exists(n.exists):rm.none():rm.none(),o=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)$d("REQUEST_TIME"===t.setToServerValue),n=new Hy;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Qy(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new Xy(i)}else"increment"in t?n=new Zy(e,t.increment):Zd();var a=xv.fromServerFormat(t.fieldPath);return new tm(a,n)}(e,t)})):[];if(t.update){t.update.name;var u=rg(e,t.update.name),s=new hy({mapValue:{fields:t.update.fields}});if(t.updateMask){var c=(r=t.updateMask,i=r.fieldPaths||[],new ly(i.map((function(e){return xv.fromServerFormat(e)}))));return new fm(u,s,c,a,o)}return new hm(u,s,a,o)}if(t.delete){var l=rg(e,t.delete);return new gm(l,a)}if(t.verify){var h=rg(e,t.verify);return new km(h,a)}return Zd()}function fg(e,t){return{documents:[ig(e,t.path)]}}function dg(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=ig(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=ig(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length)return wg(Up.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return{field:gg((t=e).field),direction:yg(t.dir)};var t}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,u,s,c=(o=e,u=t.limit,o.wt||tp(u)?u:{value:u});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(s=t.startAt).inclusive,values:s.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function vg(e){var t=ag(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){$d(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o,u,s=[];n.where&&(o=n.where,s=(u=pg(o))instanceof Up&&jp(u)?u.getFilters():[u]);var c=[];n.orderBy&&(c=n.orderBy.map((function(e){return new ny(kg((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t})));var l=null;n.limit&&(l=function(e){var t;return tp(t="object"==typeof e?e.value:e)?null:t}(n.limit));var h=null;n.startAt&&(h=function(e){var t=!!e.before,n=e.values||[];return new Pp(n,t)}(n.startAt));var f=null;return n.endAt&&(f=function(e){var t=!e.before,n=e.values||[];return new Pp(n,t)}(n.endAt)),Iy(t,i,c,s,l,"F",h,f)}function pg(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=kg(e.unaryFilter.field);return Vp.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=kg(e.unaryFilter.field);return Vp.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=kg(e.unaryFilter.field);return Vp.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=kg(e.unaryFilter.field);return Vp.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Zd()}}(e):void 0!==e.fieldFilter?(n=e,Vp.create(kg(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Zd()}}(n.fieldFilter.op),n.fieldFilter.value)):void 0!==e.compositeFilter?(t=e,Up.create(t.compositeFilter.filters.map((function(e){return pg(e)})),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Zd()}}(t.compositeFilter.op))):Zd();var t,n}function yg(e){return Wm[e]}function mg(e){return Hm[e]}function gg(e){return{fieldPath:e.canonicalString()}}function kg(e){return xv.fromServerFormat(e.fieldPath)}function wg(e){return e instanceof Vp?function(e){if("=="===e.op){if(Ep(e.value))return{unaryFilter:{field:gg(e.field),op:"IS_NAN"}};if(Tp(e.value))return{unaryFilter:{field:gg(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ep(e.value))return{unaryFilter:{field:gg(e.field),op:"IS_NOT_NAN"}};if(Tp(e.value))return{unaryFilter:{field:gg(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gg(e.field),op:mg(e.op),value:e.value}}}(e):e instanceof Up?(r=(t=e).getFilters().map((function(e){return wg(e)})),1===r.length?r[0]:{compositeFilter:{op:(n=t.op,Qm[n]),filters:r}}):Zd();var t,n,r}function bg(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xg(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=_g(t)),t=Ig(e.get(n),t);return _g(t)}function Ig(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="";break;case"":n+="";break;default:n+=a}}return n}function _g(e){return e+""}function Tg(e){var t=e.length;if($d(t>=2),2===t)return $d(""===e.charAt(0)&&""===e.charAt(1)),wv.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var o=e.indexOf("",a);switch((o<0||o>n)&&Zd(),e.charAt(o+1)){case"":var u=e.substring(a,o),s=void 0;0===i.length?s=u:(s=i+=u,i=""),r.push(s);break;case"":i+=e.substring(a,o),i+="\0";break;case"":i+=e.substring(a,o+1);break;default:Zd()}a=o+2}return new wv(r)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Eg=["userId","batchId"];
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sg(e,t){return[e,xg(t)]}function Ag(e,t,n){return[e,xg(t),n]}var Cg={},Ng=["prefixPath","collectionGroup","readTime","documentId"],Dg=["prefixPath","collectionGroup","documentId"],Rg=["collectionGroup","readTime","prefixPath","documentId"],Og=["canonicalId","targetId"],Pg=["targetId","path"],Lg=["path","targetId"],Mg=["collectionId","parent"],Fg=["indexId","uid"],Vg=["uid","sequenceNumber"],Ug=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],qg=["indexId","uid","orderedDocumentKey"],Bg=["userId","collectionPath","documentId"],jg=["userId","collectionPath","largestBatchId"],Gg=["userId","collectionGroup","largestBatchId"],Kg=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],zg=e(R)(Kg).concat(["documentOverlays"]),Wg=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Hg=Wg,Qg=e(R)(Hg).concat(["indexConfiguration","indexState","indexEntries"]),Yg=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this)).se=t,a.currentSequenceNumber=i,e(Fc)(a)}return r}(Pv);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(e,t){var n=ev(e);return Uv.M(n.se,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jg=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.batchId=n,this.localWriteTime=r,this.baseMutations=i,this.mutations=a}return e(S)(t,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&um(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=this.baseMutations[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;u.key.isEqual(e.key)&&(t=sm(u,e,t,this.localWriteTime))}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var s=!0,c=!1,l=void 0;try{for(var h,f=this.mutations[Symbol.iterator]();!(s=(h=f.next()).done);s=!0){var d=h.value;d.key.isEqual(e.key)&&(t=sm(d,e,t,this.localWriteTime))}}catch(e){c=!0,l=e}finally{try{s||null==f.return||f.return()}finally{if(c)throw l}}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=Nm();return this.mutations.forEach((function(i){var a=e.get(i.key),o=a.overlayedDocument,u=n.applyToLocalView(o,a.mutatedFields),s=om(o,u=t.has(i.key)?null:u);null!==s&&r.set(i.key,s),o.isValidDocument()||o.convertToNoDocument(gv.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),Pm())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&pv(this.mutations,e.mutations,(function(e,t){return lm(e,t)}))&&pv(this.baseMutations,e.baseMutations,(function(e,t){return lm(e,t)}))}}]),t}(),Zg=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.batch=n,this.commitVersion=r,this.mutationResults=i,this.docVersions=a}return e(S)(t,null,[{key:"from",value:function(e,n,r){$d(e.mutations.length===r.length);for(var i=Rm,a=e.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new t(e,n,r,i)}}]),t}(),$g=function(){"use strict";function t(n,r){e(E)(this,t),this.largestBatchId=n,this.mutation=r}return e(S)(t,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),t}(),ek=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gv.min(),u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:gv.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ap.EMPTY_BYTE_STRING;e(E)(this,t),this.target=n,this.targetId=r,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=s}return e(S)(t,[{key:"withSequenceNumber",value:function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}},{key:"withLastLimboFreeSnapshotVersion",value:function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}]),t}(),tk=function t(n){"use strict";e(E)(this,t),this.ie=n};function nk(e,t){var n,r,i=t.key,a={prefixPath:i.getCollectionPath().popLast().toArray(),collectionGroup:i.collectionGroup,documentId:i.path.lastSegment(),readTime:rk(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())a.document={name:ng(n=e.ie,(r=t).key),fields:r.data.value.mapValue.fields,updateTime:Xm(n,r.version.toTimestamp()),createTime:Xm(n,r.createTime.toTimestamp())};else if(t.isNoDocument())a.noDocument={path:i.path.toArray(),readTime:ik(t.version)};else{if(!t.isUnknownDocument())return Zd();a.unknownDocument={path:i.path.toArray(),version:ik(t.version)}}return a}function rk(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function ik(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function ak(e){var t=new mv(e.seconds,e.nanoseconds);return gv.fromTimestamp(t)}function ok(e,t){for(var n=(t.baseMutations||[]).map((function(t){return hg(e.ie,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map((function(t){return hg(e.ie,t)})),u=mv.fromMillis(t.localWriteTimeMs);return new Jg(t.batchId,u,n,o)}function uk(e){var t,n,r=ak(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?ak(e.lastLimboFreeSnapshotVersion):gv.min();return void 0!==e.query.documents?($d(1===(n=e.query).documents.length),t=Ny(_y(ag(n.documents[0])))):t=Ny(vg(e.query)),new ek(t,e.targetId,0,e.lastListenSequenceNumber,r,i,ap.fromBase64String(e.resumeToken))}function sk(e,t){var n,r=ik(t.snapshotVersion),i=ik(t.lastLimboFreeSnapshotVersion);n=gy(t.target)?fg(e.ie,t.target):dg(e.ie,t.target);var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:yy(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function ck(e){var t=vg({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Ry(t,t.limit,"L"):t}function lk(e,t){return new $g(t.largestBatchId,hg(e.ie,t.overlayMutation))}function hk(e,t){var n=t.path.lastSegment();return[e,xg(t.path.popLast()),n]}function fk(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:ik(r.readTime),documentKey:xg(r.documentKey.path),largestBatchId:r.largestBatchId}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dk=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,[{key:"getBundleMetadata",value:function(e,t){return vk(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:ak(t.createTime),version:t.version};var t}))}},{key:"saveBundleMetadata",value:function(e,t){var n;return vk(e).put({bundleId:(n=t).id,createTime:ik($m(n.createTime)),version:n.version})}},{key:"getNamedQuery",value:function(e,t){return pk(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:ck(t.bundledQuery),readTime:ak(t.readTime)};var t}))}},{key:"saveNamedQuery",value:function(e,t){return pk(e).put({name:(n=t).name,readTime:ik($m(n.readTime)),bundledQuery:n.bundledQuery});var n}}]),t}();function vk(e){return Xg(e,"bundles")}function pk(e){return Xg(e,"namedQueries")}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yk=function(){"use strict";function t(n,r){e(E)(this,t),this.yt=n,this.userId=r}return e(S)(t,[{key:"getOverlay",value:function(e,t){var n=this;return mk(e).get(hk(this.userId,t)).next((function(e){return e?lk(n.yt,e):null}))}},{key:"getOverlays",value:function(e,t){var n=this,r=Cm();return Fv.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach((function(n,a){var o=new $g(t,a);i.push(r.oe(e,o))})),Fv.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach((function(e){return i.add(xg(e.getCollectionPath()))}));var a=[];return i.forEach((function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(mk(e).Y("collectionPathOverlayIndex",i))})),Fv.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=Cm(),a=xg(t),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return mk(e).W("collectionPathOverlayIndex",o).next((function(e){var t=!0,n=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(t=(o=u.next()).done);t=!0){var s=o.value,c=lk(r.yt,s);i.set(c.getKey(),c)}}catch(e){n=!0,a=e}finally{try{t||null==u.return||u.return()}finally{if(n)throw a}}return i}))}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,o=Cm(),u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return mk(e).Z({index:"collectionGroupOverlayIndex",range:u},(function(e,t,n){var u=lk(a.yt,t);o.size()<r||u.largestBatchId===i?(o.set(u.getKey(),u),i=u.largestBatchId):n.done()})).next((function(){return o}))}},{key:"oe",value:function(t,n){return mk(t).put(function(t,n,r){var i=e(D)(hk(n,r.mutation.key),3);i[0];return{userId:n,collectionPath:i[1],documentId:i[2],collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:lg(t.ie,r.mutation)}}(this.yt,this.userId,n))}}],[{key:"re",value:function(e,n){return new t(e,n.uid||"")}}]),t}();function mk(e){return Xg(e,"documentOverlays")}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gk=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,[{key:"ue",value:function(e,t){this.ce(e,t),t.ae()}},{key:"ce",value:function(e,t){if("nullValue"in e)this.he(t,5);else if("booleanValue"in e)this.he(t,10),t.le(e.booleanValue?1:0);else if("integerValue"in e)this.he(t,15),t.le(sp(e.integerValue));else if("doubleValue"in e){var n=sp(e.doubleValue);isNaN(n)?this.he(t,13):(this.he(t,15),np(n)?t.le(0):t.le(n))}else if("timestampValue"in e){var r=e.timestampValue;this.he(t,20),"string"==typeof r?t.fe(r):(t.fe("".concat(r.seconds||"")),t.le(r.nanos||0))}else if("stringValue"in e)this.de(e.stringValue,t),this._e(t);else if("bytesValue"in e)this.he(t,30),t.we(cp(e.bytesValue)),this._e(t);else if("referenceValue"in e)this.me(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.he(t,45),t.le(i.latitude||0),t.le(i.longitude||0)}else"mapValue"in e?Cp(e)?this.he(t,Number.MAX_SAFE_INTEGER):(this.ge(e.mapValue,t),this._e(t)):"arrayValue"in e?(this.ye(e.arrayValue,t),this._e(t)):Zd()}},{key:"de",value:function(e,t){this.he(t,25),this.pe(e,t)}},{key:"pe",value:function(e,t){t.fe(e)}},{key:"ge",value:function(e,t){var n=e.fields||{};this.he(t,55);var r=!0,i=!1,a=void 0;try{for(var o,u=Object.keys(n)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;this.de(s,t),this.ce(n[s],t)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"ye",value:function(e,t){var n=e.values||[];this.he(t,50);var r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;this.ce(s,t)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"me",value:function(e,t){var n=this;this.he(t,37),Iv.fromName(e).path.forEach((function(e){n.he(t,60),n.pe(e,t)}))}},{key:"he",value:function(e,t){e.le(t)}},{key:"_e",value:function(e){e.le(2)}}]),t}();function kk(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function wk(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=kk(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}gk.Ie=new gk;var bk=function(){"use strict";function t(){e(E)(this,t),this.buffer=new Uint8Array(1024),this.position=0}return e(S)(t,[{key:"Te",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ee(n.value),n=t.next();this.Ae()}},{key:"Re",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.be(n.value),n=t.next();this.Pe()}},{key:"ve",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=o.charCodeAt(0);if(u<128)this.Ee(u);else if(u<2048)this.Ee(960|u>>>6),this.Ee(128|63&u);else if(o<"\ud800"||"\udbff"<o)this.Ee(480|u>>>12),this.Ee(128|63&u>>>6),this.Ee(128|63&u);else{var s=o.codePointAt(0);this.Ee(240|s>>>18),this.Ee(128|63&s>>>12),this.Ee(128|63&s>>>6),this.Ee(128|63&s)}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.Ae()}},{key:"Ve",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=o.charCodeAt(0);if(u<128)this.be(u);else if(u<2048)this.be(960|u>>>6),this.be(128|63&u);else if(o<"\ud800"||"\udbff"<o)this.be(480|u>>>12),this.be(128|63&u>>>6),this.be(128|63&u);else{var s=o.codePointAt(0);this.be(240|s>>>18),this.be(128|63&s>>>12),this.be(128|63&s>>>6),this.be(128|63&s)}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.Pe()}},{key:"Se",value:function(e){var t=this.De(e),n=wk(t);this.Ce(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"xe",value:function(e){var t=this.De(e),n=wk(t);this.Ce(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"Ne",value:function(){this.ke(255),this.ke(255)}},{key:"Oe",value:function(){this.Me(255),this.Me(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.Ce(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Fe",value:function(){return this.buffer.slice(0,this.position)}},{key:"De",value:function(e){var t,n,r=(t=e,(n=new DataView(new ArrayBuffer(8))).setFloat64(0,t,!1),new Uint8Array(n.buffer)),i=0!=(128&r[0]);r[0]^=i?255:128;for(var a=1;a<r.length;++a)r[a]^=i?255:0;return r}},{key:"Ee",value:function(e){var t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(t)}},{key:"be",value:function(e){var t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(e)}},{key:"Ae",value:function(){this.ke(0),this.ke(1)}},{key:"Pe",value:function(){this.Me(0),this.Me(1)}},{key:"ke",value:function(e){this.Ce(1),this.buffer[this.position++]=e}},{key:"Me",value:function(e){this.Ce(1),this.buffer[this.position++]=~e}},{key:"Ce",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),t}(),xk=function(){"use strict";function t(n){e(E)(this,t),this.$e=n}return e(S)(t,[{key:"we",value:function(e){this.$e.Te(e)}},{key:"fe",value:function(e){this.$e.ve(e)}},{key:"le",value:function(e){this.$e.Se(e)}},{key:"ae",value:function(){this.$e.Ne()}}]),t}(),Ik=function(){"use strict";function t(n){e(E)(this,t),this.$e=n}return e(S)(t,[{key:"we",value:function(e){this.$e.Re(e)}},{key:"fe",value:function(e){this.$e.Ve(e)}},{key:"le",value:function(e){this.$e.xe(e)}},{key:"ae",value:function(){this.$e.Oe()}}]),t}(),_k=function(){"use strict";function t(){e(E)(this,t),this.$e=new bk,this.Be=new xk(this.$e),this.Le=new Ik(this.$e)}return e(S)(t,[{key:"seed",value:function(e){this.$e.seed(e)}},{key:"qe",value:function(e){return 0===e?this.Be:this.Le}},{key:"Fe",value:function(){return this.$e.Fe()}},{key:"reset",value:function(){this.$e.reset()}}]),t}(),Tk=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.indexId=n,this.documentKey=r,this.arrayValue=i,this.directionalValue=a}return e(S)(t,[{key:"Ue",value:function(){var e=this.directionalValue.length,n=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}}]),t}();function Ek(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=Sk(e.arrayValue,t.arrayValue))?n:0!==(n=Sk(e.directionalValue,t.directionalValue))?n:Iv.comparator(e.documentKey,t.documentKey)}function Sk(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ak=function(){"use strict";function t(n){e(E)(this,t),this.collectionId=null!=n.collectionGroup?n.collectionGroup:n.path.lastSegment(),this.Ke=n.orderBy,this.Ge=[];var r=!0,i=!1,a=void 0;try{for(var o,u=n.filters[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;s.isInequality()?this.Qe=s:this.Ge.push(s)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}return e(S)(t,[{key:"je",value:function(e){$d(e.collectionGroup===this.collectionId);var t=Tv(e);if(void 0!==t&&!this.We(t))return!1;for(var n=Ev(e),r=0,i=0;r<n.length&&this.We(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Qe){var a=n[r];if(!this.ze(this.Qe,a)||!this.He(this.Ke[i++],a))return!1;++r}for(;r<n.length;++r){var o=n[r];if(i>=this.Ke.length||!this.He(this.Ke[i++],o))return!1}return!0}},{key:"We",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.Ge[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(this.ze(o,e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"ze",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"He",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),t}();
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ck(e){var t,n;if($d(e instanceof Vp||e instanceof Up),e instanceof Vp){if(e instanceof $p){var r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((function(t){return Vp.create(e.field,"==",t)})))||[];return Up.create(r,"or")}return e}var i=e.filters.map((function(e){return Ck(e)}));return Up.create(i,e.op)}function Nk(e){if(0===e.getFilters().length)return[];var t=Pk(Ck(e));return $d(Ok(t)),Dk(t)||Rk(t)?[t]:t.getFilters()}function Dk(e){return e instanceof Vp}function Rk(e){return e instanceof Up&&jp(e)}function Ok(e){return Dk(e)||Rk(e)||function(e){if(e instanceof Up&&Bp(e)){var t=!0,n=!1,r=void 0;try{for(var i,a=e.getFilters()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(!Dk(o)&&!Rk(o))return!1}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!0}return!1}(e)}function Pk(e){if($d(e instanceof Vp||e instanceof Up),e instanceof Vp)return e;if(1===e.filters.length)return Pk(e.filters[0]);var t=e.filters.map((function(e){return Pk(e)})),n=Up.create(t,e.op);return Ok(n=Fk(n))?n:($d(n instanceof Up),$d(qp(n)),$d(n.filters.length>1),n.filters.reduce((function(e,t){return Lk(e,t)})))}function Lk(e,t){var n,r;return $d(e instanceof Vp||e instanceof Up),$d(t instanceof Vp||t instanceof Up),Fk(e instanceof Vp?t instanceof Vp?(n=e,r=t,Up.create([n,r],"and")):Mk(e,t):t instanceof Vp?Mk(t,e):function(e,t){if($d(e.filters.length>0&&t.filters.length>0),qp(e)&&qp(t))return Wp(e,t.getFilters());var n=Bp(e)?e:t,r=Bp(e)?t:e,i=n.filters.map((function(e){return Lk(e,r)}));return Up.create(i,"or")}(e,t))}function Mk(e,t){if(qp(t))return Wp(t,e.getFilters());var n=t.filters.map((function(t){return Lk(e,t)}));return Up.create(n,"or")}function Fk(t){if($d(t instanceof Vp||t instanceof Up),t instanceof Vp)return t;var n=t.getFilters();if(1===n.length)return Fk(n[0]);if(Gp(t))return t;var r=n.map((function(e){return Fk(e)})),i=[];return r.forEach((function(n){var r;n instanceof Vp?i.push(n):n instanceof Up&&(n.op===t.op?(r=i).push.apply(r,e(R)(n.filters)):i.push(n))})),1===i.length?i[0]:Up.create(i,t.op)
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var Vk=function(){"use strict";function t(){e(E)(this,t),this.Je=new Uk}return e(S)(t,[{key:"addToCollectionParentIndex",value:function(e,t){return this.Je.add(t),Fv.resolve()}},{key:"getCollectionParents",value:function(e,t){return Fv.resolve(this.Je.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Fv.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Fv.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Fv.resolve(null)}},{key:"getIndexType",value:function(e,t){return Fv.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Fv.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Fv.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Fv.resolve(Dv.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Fv.resolve(Dv.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Fv.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Fv.resolve()}}]),t}(),Uk=function(){"use strict";function t(){e(E)(this,t),this.index={}}return e(S)(t,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new uy(wv.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new uy(wv.comparator)).toArray()}}]),t}(),qk=new Uint8Array(0),Bk=function(){"use strict";function t(n,r){e(E)(this,t),this.user=n,this.databaseId=r,this.Ye=new Uk,this.Xe=new Im((function(e){return yy(e)}),(function(e,t){return my(e,t)})),this.uid=n.uid||""}return e(S)(t,[{key:"addToCollectionParentIndex",value:function(e,t){if(!this.Ye.has(t)){var n=this,r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.Ye.add(t)}));var a={collectionId:r,parent:xg(i)};return jk(e).put(a)}return Fv.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[yv(t),""],!1,!0);return jk(e).W(r).next((function(e){var r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(s.collectionId!==t)break;n.push(Tg(s.parent))}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}))}},{key:"addFieldIndex",value:function(e,t){var n,r=Kk(e),i={indexId:(n=t).indexId,collectionGroup:n.collectionGroup,fields:n.fields.map((function(e){return[e.fieldPath.canonicalString(),e.kind]}))};delete i.indexId;var a=r.add(i);if(t.indexState){var o=this,u=zk(e);return a.next((function(e){u.put(fk(e,o.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=Kk(e),r=zk(e),i=Gk(e);return n.delete(t.indexId).next((function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})).next((function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}))}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=Gk(e),i=!0,a=new Map;return Fv.forEach(this.Ze(t),(function(t){return n.tn(e,t).next((function(e){i&&(i=!!e),a.set(t,e)}))})).next((function(){if(i){var e=n,o=Pm(),u=[];return Fv.forEach(a,(function(n,i){var a;Qd("IndexedDbIndexManager","Using index ".concat((a=n,"id=".concat(a.indexId,"|cg=").concat(a.collectionGroup,"|f=").concat(a.fields.map((function(e){return"".concat(e.fieldPath,":").concat(e.kind)})).join(",")))," to execute ").concat(yy(t)));var s=function(e,t){var n=Tv(t);if(void 0===n)return null;var r=!0,i=!1,a=void 0;try{for(var o,u=ky(e,n.fieldPath)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;switch(s.op){case"array-contains-any":return s.value.arrayValue.values||[];case"array-contains":return[s.value]}}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return null}(i,n),c=function(e,t){var n=new Map,r=!0,i=!1,a=void 0,o=!0,u=!1,s=void 0;try{for(var c,l=Ev(t)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;try{for(var f,d=ky(e,h.fieldPath)[Symbol.iterator]();!(r=(f=d.next()).done);r=!0){var v=f.value;switch(v.op){case"==":case"in":n.set(h.fieldPath.canonicalString(),v.value);break;case"not-in":case"!=":return n.set(h.fieldPath.canonicalString(),v.value),Array.from(n.values())}}}catch(e){i=!0,a=e}finally{try{r||null==d.return||d.return()}finally{if(i)throw a}}}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return null}(i,n),l=function(e,t){var n=[],r=!0,i=!0,a=!1,o=void 0;try{for(var u,s=Ev(t)[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=0===c.kind?wy(e,c.fieldPath,e.startAt):by(e,c.fieldPath,e.startAt);n.push(l.value),r&&(r=l.inclusive)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return new Pp(n,r)}(i,n),h=function(e,t){var n=[],r=!0,i=!0,a=!1,o=void 0;try{for(var u,s=Ev(t)[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=0===c.kind?by(e,c.fieldPath,e.endAt):wy(e,c.fieldPath,e.endAt);n.push(l.value),r&&(r=l.inclusive)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return new Pp(n,r)}(i,n),f=e.en(n,i,l),d=e.en(n,i,h),v=e.nn(n,i,c),p=e.sn(n.indexId,s,f,l.inclusive,d,h.inclusive,v);return Fv.forEach(p,(function(e){return r.J(e,t.limit).next((function(e){e.forEach((function(e){var t=Iv.fromSegments(e.documentKey);o.has(t)||(o=o.add(t),u.push(t))}))}))}))})).next((function(){return u}))}return Fv.resolve(null)}))}},{key:"Ze",value:function(e){var t=this.Xe.get(e);return t||(t=0===e.filters.length?[e]:Nk(Up.create(e.filters,"and")).map((function(t){return py(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)})),this.Xe.set(e,t),t)}},{key:"sn",value:function(t,n,r,i,a,o,u){for(var s=this,c=function(c){var l,d=s,v=n?s.rn(n[c/h]):qk,p=s.on(t,v,r[c%h],i),y=s.un(t,v,a[c%h],o),m=u.map((function(e){return d.on(t,v,e,!0)}));(l=f).push.apply(l,e(R)(s.createRange(p,y,m)))},l=(null!=n?n.length:1)*Math.max(r.length,a.length),h=l/(null!=n?n.length:1),f=[],d=0;d<l;++d)c(d);return f}},{key:"on",value:function(e,t,n,r){var i=new Tk(e,Iv.empty(),t,n);return r?i:i.Ue()}},{key:"un",value:function(e,t,n,r){var i=new Tk(e,Iv.empty(),t,n);return r?i.Ue():i}},{key:"tn",value:function(e,t){var n=new Ak(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((function(e){var t=null,r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n.je(s)&&(!t||s.fields.length>t.fields.length)&&(t=s)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return t}))}},{key:"getIndexType",value:function(e,t){var n=this,r=2,i=this.Ze(t);return Fv.forEach(i,(function(t){return n.tn(e,t).next((function(e){e?0!==r&&e.fields.length<function(e){var t=new uy(xv.comparator),n=!1,r=!0,i=!1,a=void 0,o=!0,u=!1,s=void 0;try{for(var c,l=e.filters[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;try{for(var f,d=h.getFlattenedFilters()[Symbol.iterator]();!(r=(f=d.next()).done);r=!0){var v=f.value;v.field.isKeyField()||("array-contains"===v.op||"array-contains-any"===v.op?n=!0:t=t.add(v.field))}}catch(e){i=!0,a=e}finally{try{r||null==d.return||d.return()}finally{if(i)throw a}}}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}var p=!0,y=!1,m=void 0;try{for(var g,k=e.orderBy[Symbol.iterator]();!(p=(g=k.next()).done);p=!0){var w=g.value;w.field.isKeyField()||(t=t.add(w.field))}}catch(e){y=!0,m=e}finally{try{p||null==k.return||k.return()}finally{if(y)throw m}}return t.size+(n?1:0)}(t)&&(r=1):r=0}))})).next((function(){return null!==t.limit&&i.length>1&&2===r?1:r}))}},{key:"cn",value:function(e,t){var n=new _k,r=!0,i=!1,a=void 0;try{for(var o,u=Ev(e)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c=t.data.field(s.fieldPath);if(null==c)return null;var l=n.qe(s.kind);gk.Ie.ue(c,l)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n.Fe()}},{key:"rn",value:function(e){var t=new _k;return gk.Ie.ue(e,t.qe(0)),t.Fe()}},{key:"an",value:function(e,t){var n,r=new _k;return gk.Ie.ue(xp(this.databaseId,t),r.qe(0===(n=Ev(e)).length?0:n[n.length-1].kind)),r.Fe()}},{key:"nn",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new _k);var i=0,a=!0,o=!1,u=void 0;try{for(var s,c=Ev(e)[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,h=n[i++],f=!0,d=!1,v=void 0;try{for(var p,y=r[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){var m=p.value;if(this.hn(t,l.fieldPath)&&_p(h))r=this.ln(r,l,h);else{var g=m.qe(l.kind);gk.Ie.ue(h,g)}}}catch(e){d=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw v}}}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return this.fn(r)}},{key:"en",value:function(e,t,n){return this.nn(e,t,n.position)}},{key:"fn",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Fe();return t}},{key:"ln",value:function(t,n,r){var i=e(R)(t),a=[],o=!0,u=!1,s=void 0,c=!0,l=!1,h=void 0;try{for(var f,d=(r.arrayValue.values||[])[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value;try{for(var p,y=i[Symbol.iterator]();!(o=(p=y.next()).done);o=!0){var m=p.value,g=new _k;g.seed(m.Fe()),gk.Ie.ue(v,g.qe(n.kind)),a.push(g)}}catch(e){u=!0,s=e}finally{try{o||null==y.return||y.return()}finally{if(u)throw s}}}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return a}},{key:"hn",value:function(e,t){return!!e.filters.find((function(e){return e instanceof Vp&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)}))}},{key:"getFieldIndexes",value:function(t,n){var r=this,i=Kk(t),a=zk(t);return(n?i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):i.W()).next((function(t){var n=r,i=[];return Fv.forEach(t,(function(t){return a.get([t.indexId,n.uid]).next((function(n){var r,a,o,u;i.push((r=t,o=(a=n)?new Av(a.sequenceNumber,new Dv(ak(a.readTime),new Iv(Tg(a.documentKey)),a.largestBatchId)):Av.empty(),u=r.fields.map((function(t){var n=e(D)(t,2),r=n[0],i=n[1];return new Sv(xv.fromServerFormat(r),i)})),new _v(r.indexId,r.collectionGroup,u,o)))}))})).next((function(){return i}))}))}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next((function(e){return 0===e.length?null:(e.sort((function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:vv(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)}))}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=Kk(e),a=zk(e);return this.dn(e).next((function(e){return i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((function(t){return Fv.forEach(t,(function(t){return a.put(fk(t.indexId,r.user,e,n))}))}))}))}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return Fv.forEach(t,(function(t,i){var a=n,o=r.get(t.collectionGroup);return(o?Fv.resolve(o):n.getFieldIndexes(e,t.collectionGroup)).next((function(n){return r.set(t.collectionGroup,n),Fv.forEach(n,(function(n){return a._n(e,t,n).next((function(t){var r=a.wn(i,n);return t.isEqual(r)?Fv.resolve():a.mn(e,i,n,t,r)}))}))}))}))}},{key:"gn",value:function(e,t,n,r){return Gk(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.an(n,t.key),documentKey:t.key.path.toArray()})}},{key:"yn",value:function(e,t,n,r){return Gk(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.an(n,t.key),t.key.path.toArray()])}},{key:"_n",value:function(e,t,n){var r=Gk(e),i=new uy(Ek);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.an(n,t)])},(function(e,r){i=i.add(new Tk(n.indexId,t,r.arrayValue,r.directionalValue))})).next((function(){return i}))}},{key:"wn",value:function(e,t){var n=new uy(Ek),r=this.cn(t,e);if(null==r)return n;var i=Tv(t);if(null!=i){var a=e.data.field(i.fieldPath),o=!0,u=!1,s=void 0;if(_p(a))try{for(var c,l=(a.arrayValue.values||[])[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;n=n.add(new Tk(t.indexId,e.key,this.rn(h),r))}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}}else n=n.add(new Tk(t.indexId,e.key,qk,r));return n}},{key:"mn",value:function(e,t,n,r,i){var a=this;Qd("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var o=[];return function(e,t,n,r,i){for(var a=e.getIterator(),o=t.getIterator(),u=cy(a),s=cy(o);u||s;){var c=!1,l=!1;if(u&&s){var h=n(u,s);h<0?l=!0:h>0&&(c=!0)}else null!=u?l=!0:c=!0;c?(r(s),s=cy(o)):l?(i(u),u=cy(a)):(u=cy(a),s=cy(o))}}(r,i,Ek,(function(r){o.push(a.gn(e,t,n,r))}),(function(r){o.push(a.yn(e,t,n,r))})),Fv.waitFor(o)}},{key:"dn",value:function(e){var t=1;return zk(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(function(e,n,r){r.done(),t=n.sequenceNumber+1})).next((function(){return t}))}},{key:"createRange",value:function(e,t,n){n=n.sort((function(e,t){return Ek(e,t)})).filter((function(e,t,n){return!t||0!==Ek(e,n[t-1])}));var r=[];r.push(e);var i=!0,a=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=Ek(c,e),h=Ek(c,t);if(0===l)r[0]=e.Ue();else if(l>0&&h<0)r.push(c),r.push(c.Ue());else if(h>0)break}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}r.push(t);for(var f=[],d=0;d<r.length;d+=2){if(this.pn(r[d],r[d+1]))return[];var v=[r[d].indexId,this.uid,r[d].arrayValue,r[d].directionalValue,qk,[]],p=[r[d+1].indexId,this.uid,r[d+1].arrayValue,r[d+1].directionalValue,qk,[]];f.push(IDBKeyRange.bound(v,p))}return f}},{key:"pn",value:function(e,t){return Ek(e,t)>0}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(Wk)}},{key:"getMinOffset",value:function(e,t){var n=this;return Fv.mapArray(this.Ze(t),(function(t){return n.tn(e,t).next((function(e){return e||Zd()}))})).next(Wk)}}]),t}();function jk(e){return Xg(e,"collectionParents")}function Gk(e){return Xg(e,"indexEntries")}function Kk(e){return Xg(e,"indexConfiguration")}function zk(e){return Xg(e,"indexState")}function Wk(e){$d(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var i=e[r].indexState.offset;Rv(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Dv(t.readTime,t.documentKey,n)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Qk=function(){"use strict";function t(n,r,i){e(E)(this,t),this.cacheSizeCollectionThreshold=n,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=i}return e(S)(t,null,[{key:"withCacheSize",value:function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Yk(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],o=IDBKeyRange.only(n.batchId),u=0,s=r.Z({range:o},(function(e,t,n){return u++,n.delete()}));a.push(s.next((function(){$d(1===u)})));var c=[],l=!0,h=!1,f=void 0;try{for(var d,v=n.mutations[Symbol.iterator]();!(l=(d=v.next()).done);l=!0){var p=d.value,y=Ag(t,p.key.path,n.batchId);a.push(i.delete(y)),c.push(p.key)}}catch(e){h=!0,f=e}finally{try{l||null==v.return||v.return()}finally{if(h)throw f}}return Fv.waitFor(a).next((function(){return c}))}function Xk(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Zd();t=e.noDocument}return JSON.stringify(t).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qk.DEFAULT_COLLECTION_PERCENTILE=10,Qk.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qk.DEFAULT=new Qk(41943040,Qk.DEFAULT_COLLECTION_PERCENTILE,Qk.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qk.DISABLED=new Qk(-1,0,0);var Jk=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.userId=n,this.yt=r,this.indexManager=i,this.referenceDelegate=a,this.In={}}return e(S)(t,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return $k(e).Z({index:"userMutationsIndex",range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=ew(e),o=$k(e);return o.add({}).next((function(u){var s=i;$d("number"==typeof u);var c=new Jg(u,t,n,r),l=function(e,t,n){var r=n.baseMutations.map((function(t){return lg(e.ie,t)})),i=n.mutations.map((function(t){return lg(e.ie,t)}));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.yt,i.userId,c),h=[],f=new uy((function(e,t){return vv(e.canonicalString(),t.canonicalString())})),d=!0,v=!1,p=void 0;try{for(var y,m=r[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value,k=Ag(i.userId,g.key.path,u);f=f.add(g.key.path.popLast()),h.push(o.put(l)),h.push(a.put(k,Cg))}}catch(e){v=!0,p=e}finally{try{d||null==m.return||m.return()}finally{if(v)throw p}}return f.forEach((function(t){h.push(s.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){s.In[u]=c.keys()})),Fv.waitFor(h).next((function(){return c}))}))}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return $k(e).get(t).next((function(e){return e?($d(e.userId===n.userId),ok(n.yt,e)):null}))}},{key:"Tn",value:function(e,t){var n=this;return this.In[t]?Fv.resolve(this.In[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.In[t]=r,r}return null}))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return $k(e).Z({index:"userMutationsIndex",range:i},(function(e,t,i){t.userId===n.userId&&($d(t.batchId>=r),a=ok(n.yt,t)),i.done()})).next((function(){return a}))}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return $k(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return $k(e).W("userMutationsIndex",n).next((function(e){return e.map((function(e){return ok(t.yt,e)}))}))}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(t,n){var r=this,i=Sg(this.userId,n.path),a=IDBKeyRange.lowerBound(i),o=[];return ew(t).Z({range:a},(function(i,a,u){var s=r,c=e(D)(i,3),l=c[0],h=c[1],f=c[2],d=Tg(h);if(l===r.userId&&n.path.isEqual(d))return $k(t).get(f).next((function(e){if(!e)throw Zd();$d(e.userId===s.userId),o.push(ok(s.yt,e))}));u.done()})).next((function(){return o}))}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(t,n){var r=this,i=new uy(vv),a=[];return n.forEach((function(n){var o=r,u=Sg(r.userId,n.path),s=IDBKeyRange.lowerBound(u),c=ew(t).Z({range:s},(function(t,r,a){var u=e(D)(t,3),s=u[0],c=u[1],l=u[2],h=Tg(c);s===o.userId&&n.path.isEqual(h)?i=i.add(l):a.done()}));a.push(c)})),Fv.waitFor(a).next((function(){return r.En(t,i)}))}},{key:"getAllMutationBatchesAffectingQuery",value:function(t,n){var r=this,i=n.path,a=i.length+1,o=Sg(this.userId,i),u=IDBKeyRange.lowerBound(o),s=new uy(vv);return ew(t).Z({range:u},(function(t,n,o){var u=e(D)(t,3),c=u[0],l=u[1],h=u[2],f=Tg(l);c===r.userId&&i.isPrefixOf(f)?f.length===a&&(s=s.add(h)):o.done()})).next((function(){return r.En(t,s)}))}},{key:"En",value:function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){var a=n;i.push($k(e).get(t).next((function(e){if(null===e)throw Zd();$d(e.userId===a.userId),r.push(ok(a.yt,e))})))})),Fv.waitFor(i).next((function(){return r}))}},{key:"removeMutationBatch",value:function(e,t){var n=this;return Yk(e.se,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.An(t.batchId)})),Fv.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))}},{key:"An",value:function(e){delete this.In[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next((function(n){var r=t;if(!n)return Fv.resolve();var i=IDBKeyRange.lowerBound([t.userId]),a=[];return ew(e).Z({range:i},(function(e,t,n){if(e[0]===r.userId){var i=Tg(e[1]);a.push(i)}else n.done()})).next((function(){$d(0===a.length)}))}))}},{key:"containsKey",value:function(e,t){return Zk(e,this.userId,t)}},{key:"Rn",value:function(e){var t=this;return tw(e).get(this.userId).next((function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}}))}}],[{key:"re",value:function(e,n,r,i){return $d(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)}}]),t}();function Zk(t,n,r){var i=Sg(n,r.path),a=i[1],o=IDBKeyRange.lowerBound(i),u=!1;return ew(t).Z({range:o,X:!0},(function(t,r,i){var o=e(D)(t,3),s=o[0],c=o[1];o[2];s===n&&c===a&&(u=!0),i.done()})).next((function(){return u}))}function $k(e){return Xg(e,"mutations")}function ew(e){return Xg(e,"documentMutations")}function tw(e){return Xg(e,"mutationQueues")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nw=function(){"use strict";function t(n){e(E)(this,t),this.bn=n}return e(S)(t,[{key:"next",value:function(){return this.bn+=2,this.bn}}],[{key:"Pn",value:function(){return new t(0)}},{key:"vn",value:function(){return new t(-1)}}]),t}(),rw=function(){"use strict";function t(n,r){e(E)(this,t),this.referenceDelegate=n,this.yt=r}return e(S)(t,[{key:"allocateTargetId",value:function(e){var t=this;return this.Vn(e).next((function(n){var r=new nw(n.highestTargetId);return n.highestTargetId=r.next(),t.Sn(e,n).next((function(){return n.highestTargetId}))}))}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.Vn(e).next((function(e){return gv.fromTimestamp(new mv(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))}},{key:"getHighestSequenceNumber",value:function(e){return this.Vn(e).next((function(e){return e.highestListenSequenceNumber}))}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.Vn(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Sn(e,i)}))}},{key:"addTargetData",value:function(e,t){var n=this;return this.Dn(e,t).next((function(){return n.Vn(e).next((function(r){return r.targetCount+=1,n.Cn(t,r),n.Sn(e,r)}))}))}},{key:"updateTargetData",value:function(e,t){return this.Dn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return iw(e).delete(t.targetId)})).next((function(){return n.Vn(e)})).next((function(t){return $d(t.targetCount>0),t.targetCount-=1,n.Sn(e,t)}))}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return iw(e).Z((function(o,u){var s=uk(u);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,a.push(r.removeTargetData(e,s)))})).next((function(){return Fv.waitFor(a)})).next((function(){return i}))}},{key:"forEachTarget",value:function(e,t){return iw(e).Z((function(e,n){var r=uk(n);t(r)}))}},{key:"Vn",value:function(e){return aw(e).get("targetGlobalKey").next((function(e){return $d(null!==e),e}))}},{key:"Sn",value:function(e,t){return aw(e).put("targetGlobalKey",t)}},{key:"Dn",value:function(e,t){return iw(e).put(sk(this.yt,t))}},{key:"Cn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.Vn(e).next((function(e){return e.targetCount}))}},{key:"getTargetData",value:function(e,t){var n=yy(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return iw(e).Z({range:r,index:"queryTargetsIndex"},(function(e,n,r){var a=uk(n);my(t,a.target)&&(i=a,r.done())})).next((function(){return i}))}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=ow(e);return t.forEach((function(t){var o=xg(t.path);i.push(a.put({targetId:n,path:o})),i.push(r.referenceDelegate.addReference(e,n,t))})),Fv.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=ow(e);return Fv.forEach(t,(function(t){var a=xg(t.path);return Fv.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])}))}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=ow(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=ow(e),i=Pm();return r.Z({range:n,X:!0},(function(e,t,n){var r=Tg(e[1]),a=new Iv(r);i=i.add(a)})).next((function(){return i}))}},{key:"containsKey",value:function(t,n){var r=xg(n.path),i=IDBKeyRange.bound([r],[yv(r)],!1,!0),a=0;return ow(t).Z({index:"documentTargetsIndex",X:!0,range:i},(function(t,n,r){var i=e(D)(t,2),o=i[0];i[1];0!==o&&(a++,r.done())})).next((function(){return a>0}))}},{key:"ne",value:function(e,t){return iw(e).get(t).next((function(e){return e?uk(e):null}))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(e){return Xg(e,"targets")}function aw(e){return Xg(e,"targetGlobal")}function ow(e){return Xg(e,"targetDocuments")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(t,n){var r=e(D)(t,2),i=r[0],a=r[1],o=e(D)(n,2),u=o[0],s=o[1],c=vv(i,u);return 0===c?vv(a,s):c}var sw=function(){"use strict";function t(n){e(E)(this,t),this.xn=n,this.buffer=new uy(uw),this.Nn=0}return e(S)(t,[{key:"kn",value:function(){return++this.Nn}},{key:"On",value:function(e){var t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();uw(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),t}(),cw=function(){"use strict";function t(n,r,i){e(E)(this,t),this.garbageCollector=n,this.asyncQueue=r,this.localStore=i,this.Mn=null}return e(S)(t,[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}},{key:"stop",value:function(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}},{key:"started",get:function(){return null!==this.Mn}},{key:"Fn",value:function(t){var n=this;Qd("LruGarbageCollector","Garbage collection scheduled in ".concat(t,"ms")),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.Mn=null,e.prev=1,e.next=4,n.localStore.collectGarbage(n.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!jv(e.t0)){e.next=12;break}Qd("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,Lv(e.t0);case 14:return e.next=16,n.Fn(3e5);case 16:case"end":return e.stop()}}),t,null,[[1,6]])}))))}}]),t}(),lw=function(){"use strict";function t(n,r){e(E)(this,t),this.$n=n,this.params=r}return e(S)(t,[{key:"calculateTargetCount",value:function(e,t){return this.$n.Bn(e).next((function(e){return Math.floor(t/100*e)}))}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return Fv.resolve(Yv.at);var r=new sw(t);return this.$n.forEachTarget(e,(function(e){return r.On(e.sequenceNumber)})).next((function(){return n.$n.Ln(e,(function(e){return r.On(e)}))})).next((function(){return r.maxValue}))}},{key:"removeTargets",value:function(e,t,n){return this.$n.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.$n.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Qd("LruGarbageCollector","Garbage collection skipped; disabled"),Fv.resolve(Hk)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Qd("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),Hk):n.qn(e,t)}))}},{key:"getCacheSize",value:function(e){return this.$n.getCacheSize(e)}},{key:"qn",value:function(e,t){var n,r,i,a,o,u,s,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(Qd("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(c.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=c.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,o=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,u=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return s=Date.now(),Hd()<=Ue.DEBUG&&Qd("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-a)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(u-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(s-u)+"ms\n"+"Total Duration: ".concat(s-l,"ms")),Fv.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))}}]),t}(),hw=function(){"use strict";function t(n,r){e(E)(this,t),this.db=n,this.garbageCollector=new lw(this,r)}return e(S)(t,[{key:"Bn",value:function(e){var t=this.Un(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))}},{key:"Un",value:function(e){var t=0;return this.Ln(e,(function(e){t++})).next((function(){return t}))}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Ln",value:function(e,t){return this.Kn(e,(function(e,n){return t(n)}))}},{key:"addReference",value:function(e,t,n){return fw(e,n)}},{key:"removeReference",value:function(e,t,n){return fw(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return fw(e,t)}},{key:"Gn",value:function(e,t){return r=t,i=!1,tw(n=e).tt((function(e){return Zk(n,e,r).next((function(e){return e&&(i=!0),Fv.resolve(!e)}))})).next((function(){return i}));var n,r,i}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Kn(e,(function(o,u){if(u<=t){var s=n.Gn(e,o).next((function(t){if(!t)return a++,r.getEntry(e,o).next((function(){return r.removeEntry(o,gv.min()),ow(e).delete([0,xg(o.path)])}))}));i.push(s)}})).next((function(){return Fv.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return a}))}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return fw(e,t)}},{key:"Kn",value:function(t,n){var r,i=ow(t),a=Yv.at;return i.Z({index:"documentTargetsIndex"},(function(t,i){var o=e(D)(t,2),u=o[0],s=(o[1],i.path),c=i.sequenceNumber;0===u?(a!==Yv.at&&n(new Iv(Tg(r)),a),a=c,r=s):a=Yv.at})).next((function(){a!==Yv.at&&n(new Iv(Tg(r)),a)}))}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),t}();function fw(e,t){return ow(e).put((n=t,r=e.currentSequenceNumber,{targetId:0,path:xg(n.path),sequenceNumber:r}));var n,r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dw=function(){"use strict";function t(){e(E)(this,t),this.changes=new Im((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return e(S)(t,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,dy.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Fv.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),t}(),vw=function(){"use strict";function t(n){e(E)(this,t),this.yt=n}return e(S)(t,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return gw(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return gw(e).delete((r=n,[(i=t.path.toArray()).slice(0,i.length-2),i[i.length-2],rk(r),i[i.length-1]]));var r,i}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.Qn(e,r)}))}},{key:"getEntry",value:function(e,t){var n=this,r=dy.newInvalidDocument(t);return gw(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(kw(t))},(function(e,i){r=n.jn(t,i)})).next((function(){return r}))}},{key:"Wn",value:function(e,t){var n=this,r={size:0,document:dy.newInvalidDocument(t)};return gw(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(kw(t))},(function(e,i){r={document:n.jn(t,i),size:Xk(i)}})).next((function(){return r}))}},{key:"getEntries",value:function(e,t){var n=this,r=Tm();return this.zn(e,t,(function(e,t){var i=n.jn(e,t);r=r.insert(e,i)})).next((function(){return r}))}},{key:"Hn",value:function(e,t){var n=this,r=Tm(),i=new iy(Iv.comparator);return this.zn(e,t,(function(e,t){var a=n.jn(e,t);r=r.insert(e,a),i=i.insert(e,Xk(t))})).next((function(){return{documents:r,Jn:i}}))}},{key:"zn",value:function(t,n,r){if(n.isEmpty())return Fv.resolve();var i=new uy(bw);n.forEach((function(e){return i=i.add(e)}));var a=IDBKeyRange.bound(kw(i.first()),kw(i.last())),o=i.getIterator(),u=o.getNext();return gw(t).Z({index:"documentKeyIndex",range:a},(function(t,n,i){for(var a=Iv.fromSegments(e(R)(n.prefixPath).concat([n.collectionGroup,n.documentId]));u&&bw(u,a)<0;)r(u,null),u=o.getNext();u&&u.isEqual(a)&&(r(u,n),u=o.hasNext()?o.getNext():null),u?i.j(kw(u)):i.done()})).next((function(){for(;u;)r(u,null),u=o.hasNext()?o.getNext():null}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this,a=t.path,o=[a.popLast().toArray(),a.lastSegment(),rk(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],u=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return gw(e).W(IDBKeyRange.bound(o,u,!0)).next((function(e){var n=Tm(),a=!0,o=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,h=i.jn(Iv.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);h.isFoundDocument()&&(My(t,h)||r.has(h.key))&&(n=n.insert(h.key,h))}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return n}))}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=Tm(),o=ww(t,n),u=ww(t,Dv.max());return gw(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,u,!0)},(function(e,t,n){var o=i.jn(Iv.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(o.key,o)).size===r&&n.done()})).next((function(){return a}))}},{key:"newChangeBuffer",value:function(e){return new yw(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))}},{key:"getMetadata",value:function(e){return mw(e).get("remoteDocumentGlobalKey").next((function(e){return $d(!!e),e}))}},{key:"Qn",value:function(e,t){return mw(e).put("remoteDocumentGlobalKey",t)}},{key:"jn",value:function(e,t){if(t){var n=function(e,t){var n,r,i;if(t.document)n=cg(e.ie,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var a=Iv.fromSegments(t.noDocument.path),o=ak(t.noDocument.readTime);n=dy.newNoDocument(a,o),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Zd();var u=Iv.fromSegments(t.unknownDocument.path),s=ak(t.unknownDocument.version);n=dy.newUnknownDocument(u,s)}return t.readTime&&n.setReadTime((r=t.readTime,i=new mv(r[0],r[1]),gv.fromTimestamp(i))),n}(this.yt,t);if(!n.isNoDocument()||!n.version.isEqual(gv.min()))return n}return dy.newInvalidDocument(e)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(e){return new vw(e)}var yw=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this)).Yn=t,a.trackRemovals=i,a.Xn=new Im((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),e(Fc)(a)}return e(S)(r,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new uy((function(e,t){return vv(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(a,o){var u=t.Xn.get(a);if(n.push(t.Yn.removeEntry(e,a,u.readTime)),o.isValidDocument()){var s=nk(t.Yn.yt,o);i=i.add(a.path.popLast());var c=Xk(s);r+=c-u.size,n.push(t.Yn.addEntry(e,a,s))}else if(r-=u.size,t.trackRemovals){var l=nk(t.Yn.yt,o.convertToNoDocument(gv.min()));n.push(t.Yn.addEntry(e,a,l))}})),i.forEach((function(r){n.push(t.Yn.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.Yn.updateMetadata(e,r)),Fv.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.Yn.Wn(e,t).next((function(e){return n.Xn.set(t,{size:e.size,readTime:e.document.readTime}),e.document}))}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.Yn.Hn(e,t).next((function(e){var t=e.documents;return e.Jn.forEach((function(e,r){n.Xn.set(e,{size:r,readTime:t.get(e).readTime})})),t}))}}]),r}(dw);function mw(e){return Xg(e,"remoteDocumentGlobal")}function gw(e){return Xg(e,"remoteDocumentsV14")}function kw(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function ww(e,t){var n=t.documentKey.path.toArray();return[e,rk(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function bw(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),i=0,a=0;a<n.length-2&&a<r.length-2;++a)if(i=vv(n[a],r[a]))return i;return(i=vv(n.length,r.length))||((i=vv(n[n.length-2],r[r.length-2]))||vv(n[n.length-1],r[r.length-1]))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xw=function t(n,r){"use strict";e(E)(this,t),this.overlayedDocument=n,this.mutatedFields=r},Iw=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.remoteDocumentCache=n,this.mutationQueue=r,this.documentOverlayCache=i,this.indexManager=a}return e(S)(t,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(i){return r=i,n.remoteDocumentCache.getEntry(e,t)})).next((function(e){return null!==r&&sm(r.mutation,e,ly.empty(),mv.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,Pm()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pm(),r=this,i=Cm();return this.populateOverlays(e,i,t).next((function(){return r.computeViews(e,t,i,n).next((function(e){var t=Sm();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=Cm();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,Pm())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var i=Tm(),a=Dm(),o=Dm();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof fm)?i=i.insert(t.key,t):void 0!==o?(a.set(t.key,o.mutation.getFieldMask()),sm(o.mutation,t,o.mutation.getFieldMask(),mv.now())):a.set(t.key,ly.empty())})),this.recalculateAndSaveOverlays(e,i).next((function(e){return e.forEach((function(e,t){return a.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new xw(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=Dm(),i=new iy((function(e,t){return e-t})),a=Pm();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n=!0,a=!1,o=void 0;try{for(var u,s=function(e,n){var a=n.value;a.keys().forEach((function(e){var n=t.get(e);if(null!==n){var o=r.get(e)||ly.empty();o=a.applyToLocalView(n,o),r.set(e,o);var u=(i.get(a.batchId)||Pm()).add(e);i=i.insert(a.batchId,u)}}))},c=e[Symbol.iterator]();!(n=(u=c.next()).done);n=!0)s(0,u)}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}})).next((function(){for(var o=[],u=i.getReverseIterator();u.hasNext();){var s=u.getNext(),c=s.key,l=s.value,h=Nm();l.forEach((function(e){if(!a.has(e)){var n=om(t.get(e),r.get(e));null!==n&&h.set(e,n),a=a.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,c,h))}return Fv.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return r=t,Iv.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Ay(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(a){var o=i,u=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Fv.resolve(Cm()),s=-1,c=a;return u.next((function(t){return Fv.forEach(t,(function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?Fv.resolve():o.remoteDocumentCache.getEntry(e,t).next((function(e){c=c.insert(t,e)}))})).next((function(){return o.populateOverlays(e,t,a)})).next((function(){return o.computeViews(e,c,t,Pm())})).next((function(e){return{batchId:s,changes:Am(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new Iv(t)).next((function(e){var t=Sm();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=Sm();return this.indexManager.getCollectionParents(e,i).next((function(o){return Fv.forEach(o,(function(o){var u,s,c=(u=t,s=o.child(i),new xy(s,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt));return r.getDocumentsMatchingCollectionQuery(e,c,n).next((function(e){e.forEach((function(e,t){a=a.insert(e,t)}))}))})).next((function(){return a}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((function(a){return r=a,i.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)})).next((function(e){r.forEach((function(t,n){var r=n.getKey();null===e.get(r)&&(e=e.insert(r,dy.newInvalidDocument(r)))}));var n=Sm();return e.forEach((function(e,i){var a=r.get(e);void 0!==a&&sm(a.mutation,i,ly.empty(),mv.now()),My(t,i)&&(n=n.insert(e,i))})),n}))}}]),t}(),_w=function(){"use strict";function t(n){e(E)(this,t),this.yt=n,this.Zn=new Map,this.ts=new Map}return e(S)(t,[{key:"getBundleMetadata",value:function(e,t){return Fv.resolve(this.Zn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Zn.set(t.id,{id:(n=t).id,version:n.version,createTime:$m(n.createTime)}),Fv.resolve()}},{key:"getNamedQuery",value:function(e,t){return Fv.resolve(this.ts.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.ts.set(t.name,{name:(n=t).name,query:ck(n.bundledQuery),readTime:$m(n.readTime)}),Fv.resolve();var n}}]),t}(),Tw=function(){"use strict";function t(){e(E)(this,t),this.overlays=new iy(Iv.comparator),this.es=new Map}return e(S)(t,[{key:"getOverlay",value:function(e,t){return Fv.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=Cm();return Fv.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.oe(e,t,i)})),Fv.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.es.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.es.delete(n)),Fv.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=Cm(),i=t.length+1,a=new Iv(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var u=o.getNext().value,s=u.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return Fv.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new iy((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var u=i.get(o.largestBatchId);null===u&&(u=Cm(),i=i.insert(o.largestBatchId,u)),u.set(o.getKey(),o)}}for(var s=Cm(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return s.set(e,t)})),!(s.size()>=r)););return Fv.resolve(s)}},{key:"oe",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.es.get(r.largestBatchId).delete(n.key);this.es.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new $g(t,n));var a=this.es.get(t);void 0===a&&(a=Pm(),this.es.set(t,a)),this.es.set(t,a.add(n.key))}}]),t}(),Ew=function(){"use strict";function t(){e(E)(this,t),this.ns=new uy(Sw.ss),this.rs=new uy(Sw.os)}return e(S)(t,[{key:"isEmpty",value:function(){return this.ns.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Sw(e,t);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}},{key:"us",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.cs(new Sw(e,t))}},{key:"hs",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"ls",value:function(e){var t=this,n=new Iv(new wv([])),r=new Sw(n,e),i=new Sw(n,e+1),a=[];return this.rs.forEachInRange([r,i],(function(e){t.cs(e),a.push(e.key)})),a}},{key:"fs",value:function(){var e=this;this.ns.forEach((function(t){return e.cs(t)}))}},{key:"cs",value:function(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}},{key:"ds",value:function(e){var t=new Iv(new wv([])),n=new Sw(t,e),r=new Sw(t,e+1),i=Pm();return this.rs.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new Sw(e,0),n=this.ns.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),t}(),Sw=function(){"use strict";function t(n,r){e(E)(this,t),this.key=n,this._s=r}return e(S)(t,null,[{key:"ss",value:function(e,t){return Iv.comparator(e.key,t.key)||vv(e._s,t._s)}},{key:"os",value:function(e,t){return vv(e._s,t._s)||Iv.comparator(e.key,t.key)}}]),t}(),Aw=function(){"use strict";function t(n,r){e(E)(this,t),this.indexManager=n,this.referenceDelegate=r,this.mutationQueue=[],this.ws=1,this.gs=new uy(Sw.ss)}return e(S)(t,[{key:"checkEmpty",value:function(e){return Fv.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new Jg(i,t,n,r);this.mutationQueue.push(a);var o=!0,u=!1,s=void 0;try{for(var c,l=r[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;this.gs=this.gs.add(new Sw(h.key,i)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast())}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return Fv.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Fv.resolve(this.ys(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.ps(n),i=r<0?0:r;return Fv.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Fv.resolve(0===this.mutationQueue.length?-1:this.ws-1)}},{key:"getAllMutationBatches",value:function(e){return Fv.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Sw(t,0),i=new Sw(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],(function(e){var t=n.ys(e._s);a.push(t)})),Fv.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new uy(vv);return t.forEach((function(e){var t=new Sw(e,0),i=new Sw(e,Number.POSITIVE_INFINITY);n.gs.forEachInRange([t,i],(function(e){r=r.add(e._s)}))})),Fv.resolve(this.Is(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;Iv.isDocumentKey(i)||(i=i.child(""));var a=new Sw(new Iv(i),0),o=new uy(vv);return this.gs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e._s)),!0)}),a),Fv.resolve(this.Is(o))}},{key:"Is",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.ys(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;$d(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();var r=this.gs;return Fv.forEach(t.mutations,(function(i){var a=new Sw(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.gs=r}))}},{key:"An",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Sw(t,0),r=this.gs.firstAfterOrEqual(n);return Fv.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,Fv.resolve()}},{key:"Ts",value:function(e,t){return this.ps(e)}},{key:"ps",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"ys",value:function(e){var t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),t}(),Cw=function(){"use strict";function t(n){e(E)(this,t),this.Es=n,this.docs=new iy(Iv.comparator),this.size=0}return e(S)(t,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Es(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Fv.resolve(n?n.document.mutableCopy():dy.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=Tm();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():dy.newInvalidDocument(e))})),Fv.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){for(var i=Tm(),a=t.path,o=new Iv(a.child("")),u=this.docs.getIteratorFrom(o);u.hasNext();){var s=u.getNext(),c=s.key,l=s.value.document;if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Rv(Nv(l),n)<=0||(r.has(l.key)||My(t,l))&&(i=i.insert(l.key,l.mutableCopy()))}return Fv.resolve(i)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Zd()}},{key:"As",value:function(e,t){return Fv.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new Nw(this)}},{key:"getSize",value:function(e){return Fv.resolve(this.size)}}]),t}(),Nw=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this)).Yn=t,e(Fc)(i)}return e(S)(r,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t.Yn.addEntry(e,i)):t.Yn.removeEntry(r)})),Fv.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.Yn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.Yn.getEntries(e,t)}}]),r}(dw),Dw=function(){"use strict";function t(n){e(E)(this,t),this.persistence=n,this.Rs=new Im((function(e){return yy(e)}),my),this.lastRemoteSnapshotVersion=gv.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Ew,this.targetCount=0,this.vs=nw.Pn()}return e(S)(t,[{key:"forEachTarget",value:function(e,t){return this.Rs.forEach((function(e,n){return t(n)})),Fv.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Fv.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Fv.resolve(this.bs)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.vs.next(),Fv.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),Fv.resolve()}},{key:"Dn",value:function(e){this.Rs.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.vs=new nw(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.Dn(t),this.targetCount+=1,Fv.resolve()}},{key:"updateTargetData",value:function(e,t){return this.Dn(t),Fv.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,Fv.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Rs.forEach((function(o,u){u.sequenceNumber<=t&&null===n.get(u.targetId)&&(r.Rs.delete(o),a.push(r.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),Fv.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return Fv.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Rs.get(t)||null;return Fv.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Ps.us(t,n),Fv.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Ps.hs(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),Fv.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Ps.ls(t),Fv.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Ps.ds(t);return Fv.resolve(n)}},{key:"containsKey",value:function(e,t){return Fv.resolve(this.Ps.containsKey(t))}}]),t}(),Rw=function(){"use strict";function t(n,r){var i=this;e(E)(this,t),this.Vs={},this.overlays={},this.Ss=new Yv(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=n(this),this.Cs=new Dw(this),this.indexManager=new Vk,this.remoteDocumentCache=new Cw((function(e){return i.referenceDelegate.xs(e)})),this.yt=new tk(r),this.Ns=new _w(this.yt)}return e(S)(t,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Ds=!1,Promise.resolve()}},{key:"started",get:function(){return this.Ds}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new Tw,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Vs[e.toKey()];return n||(n=new Aw(t,this.referenceDelegate),this.Vs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;Qd("MemoryPersistence","Starting transaction:",e);var i=new Ow(this.Ss.next());return this.referenceDelegate.ks(),n(i).next((function(e){return r.referenceDelegate.Os(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Ms",value:function(e,t){return Fv.or(Object.values(this.Vs).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),t}(),Ow=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this)).currentSequenceNumber=t,e(Fc)(i)}return r}(Pv),Pw=function(){"use strict";function t(n){e(E)(this,t),this.persistence=n,this.Fs=new Ew,this.$s=null}return e(S)(t,[{key:"Ls",get:function(){if(this.$s)return this.$s;throw Zd()}},{key:"addReference",value:function(e,t,n){return this.Fs.addReference(n,t),this.Ls.delete(n.toString()),Fv.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Fs.removeReference(n,t),this.Ls.add(n.toString()),Fv.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Ls.add(t.toString()),Fv.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Fs.ls(t.targetId).forEach((function(e){return n.Ls.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){var t=n;e.forEach((function(e){return t.Ls.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"ks",value:function(){this.$s=new Set}},{key:"Os",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fv.forEach(this.Ls,(function(r){var i=Iv.fromPath(r);return t.qs(e,i).next((function(e){e||n.removeEntry(i,gv.min())}))})).next((function(){return t.$s=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.qs(e,t).next((function(e){e?n.Ls.delete(t.toString()):n.Ls.add(t.toString())}))}},{key:"xs",value:function(e){return 0}},{key:"qs",value:function(e,t){var n=this;return Fv.or([function(){return Fv.resolve(n.Fs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ms(e,t)}])}}],[{key:"Bs",value:function(e){return new t(e)}}]),t}(),Lw=function(){"use strict";function t(n){e(E)(this,t),this.yt=n}return e(S)(t,[{key:"$",value:function(e,t,n,r){var i=this,a=new Vv("createOrUpgrade",t);n<1&&r>=1&&(e.createObjectStore("owner"),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Eg,{unique:!0}),e.createObjectStore("documentMutations")}(e),Mw(e),function(e){e.createObjectStore("remoteDocuments")}(e));var o=Fv.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),Mw(e)),o=o.next((function(){return function(e){var t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:gv.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(a)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return t=e,(n=a).store("mutations").W().next((function(e){t.deleteObjectStore("mutations"),t.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Eg,{unique:!0});var r=n.store("mutations"),i=e.map((function(e){return r.put(e)}));return Fv.waitFor(i)}));var t,n}))),o=o.next((function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((function(){return i.Us(a)}))),n<6&&r>=6&&(o=o.next((function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.Ks(a)}))),n<7&&r>=7&&(o=o.next((function(){return i.Gs(a)}))),n<8&&r>=8&&(o=o.next((function(){return i.Qs(e,a)}))),n<9&&r>=9&&(o=o.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((function(){return i.js(a)}))),n<11&&r>=11&&(o=o.next((function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:Bg});t.createIndex("collectionPathOverlayIndex",jg,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Gg,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:Ng});t.createIndex("documentKeyIndex",Dg),t.createIndex("collectionGroupIndex",Rg)}(e)})).next((function(){return i.Ws(e,a)})).next((function(){return e.deleteObjectStore("remoteDocuments")}))),n<14&&r>=14&&(o=o.next((function(){return i.zs(e,a)}))),n<15&&r>=15&&(o=o.next((function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Fg}).createIndex("sequenceNumberIndex",Vg,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Ug}).createIndex("documentKeyIndex",qg,{unique:!1})}(e)}))),o}},{key:"Ks",value:function(e){var t=0;return e.store("remoteDocuments").Z((function(e,n){t+=Xk(n)})).next((function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}},{key:"Us",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next((function(n){return Fv.forEach(n,(function(n){var i=t,a=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next((function(t){return Fv.forEach(t,(function(t){$d(t.userId===n.userId);var r=ok(i.yt,t);return Yk(e,n.userId,r).next((function(){}))}))}))}))}))}},{key:"Gs",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((function(e){var r=[];return n.Z((function(n,i){var a=new wv(n),o=[0,xg(a)];r.push(t.get(o).next((function(n){return n?Fv.resolve():(r=a,t.put({targetId:0,path:xg(r),sequenceNumber:e.highestListenSequenceNumber}));var r})))})).next((function(){return Fv.waitFor(r)}))}))}},{key:"Qs",value:function(t,n){t.createObjectStore("collectionParents",{keyPath:Mg});var r=n.store("collectionParents"),i=new Uk,a=function(e){if(i.add(e)){var t=e.lastSegment(),n=e.popLast();return r.put({collectionId:t,parent:xg(n)})}};return n.store("remoteDocuments").Z({X:!0},(function(e,t){var n=new wv(e);return a(n.popLast())})).next((function(){return n.store("documentMutations").Z({X:!0},(function(t,n){var r=e(D)(t,3),i=(r[0],r[1]),o=(r[2],Tg(i));return a(o.popLast())}))}))}},{key:"js",value:function(e){var t=this,n=e.store("targets");return n.Z((function(e,r){var i=uk(r),a=sk(t.yt,i);return n.put(a)}))}},{key:"Ws",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.Z((function(e,n){var i,a=t.store("remoteDocumentsV14"),o=(i=n,i.document?new Iv(wv.fromString(i.document.name).popFirst(5)):i.noDocument?Iv.fromSegments(i.noDocument.path):i.unknownDocument?Iv.fromSegments(i.unknownDocument.path):Zd()).path.toArray(),u={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(u))})).next((function(){return Fv.waitFor(r)}))}},{key:"zs",value:function(e,t){var n=this,r=t.store("mutations"),i=pw(this.yt),a=new Rw(Pw.Bs,this.yt.ie);return r.W().next((function(e){var r=n,o=new Map;return e.forEach((function(e){var t,n=null!==(t=o.get(e.userId))&&void 0!==t?t:Pm();ok(r.yt,e).keys().forEach((function(e){return n=n.add(e)})),o.set(e.userId,n)})),Fv.forEach(o,(function(e,n){var o=new Kd(n),u=yk.re(r.yt,o),s=a.getIndexManager(o),c=Jk.re(o,r.yt,s,a.referenceDelegate);return new Iw(i,c,u,s).recalculateAndSaveOverlaysForDocumentKeys(new Yg(t,Yv.at),e).next()}))}))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mw(e){e.createObjectStore("targetDocuments",{keyPath:Pg}).createIndex("documentTargetsIndex",Lg,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Og,{unique:!0}),e.createObjectStore("targetGlobal")}var Fw="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Vw=function(){"use strict";function t(n,r,i,a,o,u,s,c,l,h){var f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:15;if(e(E)(this,t),this.allowTabSynchronization=n,this.persistenceKey=r,this.clientId=i,this.Hs=o,this.window=u,this.document=s,this.Js=l,this.Ys=h,this.Xs=f,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=function(e){return Promise.resolve()},!t.C())throw new nv(tv.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new hw(this,a),this.ii=r+"main",this.yt=new tk(c),this.ri=new Uv(this.ii,this.Xs,new Lw(this.yt)),this.Cs=new rw(this.referenceDelegate,this.yt),this.remoteDocumentCache=pw(this.yt),this.Ns=new dk,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===h&&Yd("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e(S)(t,[{key:"start",value:function(){var e=this;return this.ui().then((function(){var t=e;if(!e.isPrimary&&!e.allowTabSynchronization)throw new nv(tv.FAILED_PRECONDITION,Fw);return e.ci(),e.ai(),e.hi(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Cs.getHighestSequenceNumber(e)}))})).then((function(t){e.Ss=new Yv(t,e.Js)})).then((function(){e.Ds=!0})).catch((function(t){return e.ri&&e.ri.close(),Promise.reject(t)}))}},{key:"li",value:function(t){var n,r=this;return this.si=(n=e(u)(e(s).mark((function n(i){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.started){e.next=2;break}return e.abrupt("return",t(i));case 2:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}),t(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(t){var n;this.ri.L((n=e(u)(e(s).mark((function n(r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null===r.newVersion,!e.t0){e.next=4;break}return e.next=4,t();case 4:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))}},{key:"setNetworkEnabled",value:function(t){var n=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Hs.enqueueAndForget(e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.started,!e.t0){e.next=4;break}return e.next=4,n.ui();case 4:case"end":return e.stop()}}),t)})))))}},{key:"ui",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return qw(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next((function(){var n=e;if(e.isPrimary)return e.fi(t).next((function(e){var t=n;e||(n.isPrimary=!1,n.Hs.enqueueRetryable((function(){return t.si(!1)})))}))})).next((function(){return e.di(t)})).next((function(n){return e.isPrimary&&!n?e._i(t).next((function(){return!1})):!!n&&e.wi(t).next((function(){return!0}))}))})).catch((function(t){if(jv(t))return Qd("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return Qd("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){var n=e;e.isPrimary!==t&&e.Hs.enqueueRetryable((function(){return n.si(t)})),e.isPrimary=t}))}},{key:"fi",value:function(e){var t=this;return Uw(e).get("owner").next((function(e){return Fv.resolve(t.mi(e))}))}},{key:"gi",value:function(e){return qw(e).delete(this.clientId)}},{key:"yi",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i,a,o,u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isPrimary||t.pi(t.ni,18e5)){e.next=23;break}return t.ni=Date.now(),e.next=4,t.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=Xg(e,"clientMetadata");return n.W().next((function(e){var r=t.Ii(e,18e5),i=e.filter((function(e){return-1===r.indexOf(e)}));return Fv.forEach(i,(function(e){return n.delete(e.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}));case 4:if(r=e.sent,i=!0,a=!1,o=void 0,!t.oi){e.next=23;break}for(e.prev=7,u=r[Symbol.iterator]();!(i=(c=u.next()).done);i=!0)l=c.value,t.oi.removeItem(t.Ti(l.clientId));e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),a=!0,o=e.t0;case 15:e.prev=15,e.prev=16,i||null==u.return||u.return();case 18:if(e.prev=18,!a){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:case"end":return e.stop()}}),n,null,[[7,11,15,23],[16,,18,22]])})))()}},{key:"hi",value:function(){var e=this;this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.ui().then((function(){return e.yi()})).then((function(){return e.hi()}))}))}},{key:"mi",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"di",value:function(e){var t=this;return this.Ys?Fv.resolve(!0):Uw(e).get("owner").next((function(n){var r=t;if(null!==n&&t.pi(n.leaseTimestampMs,5e3)&&!t.Ei(n.ownerId)){if(t.mi(n)&&t.networkEnabled)return!0;if(!t.mi(n)){if(!n.allowTabSynchronization)throw new nv(tv.FAILED_PRECONDITION,Fw);return!1}}return!(!t.networkEnabled||!t.inForeground)||qw(e).W().next((function(e){return void 0===r.Ii(e,5e3).find((function(e){if(r.clientId!==e.clientId){var t=!r.networkEnabled&&e.networkEnabled,n=!r.inForeground&&e.inForeground,i=r.networkEnabled===e.networkEnabled;if(t||n&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&Qd("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e}))}},{key:"shutdown",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Ds=!1,t.Ai(),t.ei&&(t.ei.cancel(),t.ei=null),t.Ri(),t.bi(),e.next=7,t.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(function(e){var n=new Yg(e,Yv.at);return t._i(n).next((function(){return t.gi(n)}))}));case 7:t.ri.close(),t.Pi();case 9:case"end":return e.stop()}}),n)})))()}},{key:"Ii",value:function(e,t){var n=this;return e.filter((function(e){return n.pi(e.updateTimeMs,t)&&!n.Ei(e.clientId)}))}},{key:"vi",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return qw(t).W().next((function(t){return e.Ii(t,18e5).map((function(e){return e.clientId}))}))}))}},{key:"started",get:function(){return this.Ds}},{key:"getMutationQueue",value:function(e,t){return Jk.re(e,this.yt,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new Bk(e,this.yt.ie.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return yk.re(this.yt,e)}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;Qd("IndexedDbPersistence","Starting transaction:",e);var i,a,o="readonly"===t?"readonly":"readwrite",u=15===(i=this.Xs)?Qg:14===i?Hg:13===i?Wg:12===i?zg:11===i?Kg:void Zd();return this.ri.runTransaction(e,o,u,(function(i){return a=new Yg(i,r.Ss?r.Ss.next():Yv.at),"readwrite-primary"===t?r.fi(a).next((function(e){return!!e||r.di(a)})).next((function(t){var i=r;if(!t)throw Yd("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.Hs.enqueueRetryable((function(){return i.si(!1)})),new nv(tv.FAILED_PRECONDITION,Ov);return n(a)})).next((function(e){return r.wi(a).next((function(){return e}))})):r.Vi(a).next((function(){return n(a)}))})).then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Vi",value:function(e){var t=this;return Uw(e).get("owner").next((function(e){if(null!==e&&t.pi(e.leaseTimestampMs,5e3)&&!t.Ei(e.ownerId)&&!t.mi(e)&&!(t.Ys||t.allowTabSynchronization&&e.allowTabSynchronization))throw new nv(tv.FAILED_PRECONDITION,Fw)}))}},{key:"wi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Uw(e).put("owner",t)}},{key:"_i",value:function(e){var t=this,n=Uw(e);return n.get("owner").next((function(e){return t.mi(e)?(Qd("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Fv.resolve()}))}},{key:"pi",value:function(e,t){var n=Date.now();return!(e<n-t||e>n&&(Yd("Detected an update time that is in the future: ".concat(e," > ").concat(n)),1))}},{key:"ci",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=function(){var t=e;e.Hs.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.ui()}))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}},{key:"Ri",value:function(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}},{key:"ai",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=function(){var e=t;t.Ai(),!ve()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match(/Version\/1[45]/)&&t.Hs.enterRestrictedMode(!0),t.Hs.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Zs))}},{key:"bi",value:function(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}},{key:"Ei",value:function(e){var t;try{var n=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return Qd("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return Yd("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"Ai",value:function(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){Yd("Failed to set zombie client id.",e)}}},{key:"Pi",value:function(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch(e){}}},{key:"Ti",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"C",value:function(){return Uv.C()}}]),t}();function Uw(e){return Xg(e,"owner")}function qw(e){return Xg(e,"clientMetadata")}function Bw(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var jw=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.targetId=n,this.fromCache=r,this.Si=i,this.Di=a}return e(S)(t,null,[{key:"Ci",value:function(e,n){var r=Pm(),i=Pm(),a=!0,o=!1,u=void 0;try{for(var s,c=n.docChanges[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:i=i.add(l.doc.key)}}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return new t(e,n.fromCache,r,i)}}]),t}(),Gw=function(){"use strict";function t(){e(E)(this,t),this.xi=!1}return e(S)(t,[{key:"initialize",value:function(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.ki(e,t).next((function(a){return a||i.Oi(e,t,r,n)})).next((function(n){return n||i.Mi(e,t)}))}},{key:"ki",value:function(t,n){var r=this;if(Ty(n))return Fv.resolve(null);var i=Ny(n);return this.indexManager.getIndexType(t,i).next((function(a){return 0===a?null:(null!==n.limit&&1===a&&(n=Ry(n,null,"F"),i=Ny(n)),r.indexManager.getDocumentsMatchingTarget(t,i).next((function(a){var o=r,u=Pm.apply(void 0,e(R)(a));return r.Ni.getDocuments(t,u).next((function(e){return o.indexManager.getMinOffset(t,i).next((function(r){var i=o.Fi(n,e);return o.$i(n,i,u,r.readTime)?o.ki(t,Ry(n,null,"F")):o.Bi(t,i,n,r)}))}))})))}))}},{key:"Oi",value:function(e,t,n,r){var i=this;return Ty(t)||r.isEqual(gv.min())?this.Mi(e,t):this.Ni.getDocuments(e,n).next((function(a){var o=i.Fi(t,a);return i.$i(t,o,n,r)?i.Mi(e,t):(Hd()<=Ue.DEBUG&&Qd("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ly(t)),i.Bi(e,o,t,Cv(r,-1)))}))}},{key:"Fi",value:function(e,t){var n=new uy(Vy(e));return t.forEach((function(t,r){My(e,r)&&(n=n.add(r))})),n}},{key:"$i",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Mi",value:function(e,t){return Hd()<=Ue.DEBUG&&Qd("QueryEngine","Using full collection scan to execute query:",Ly(t)),this.Ni.getDocumentsMatchingQuery(e,t,Dv.min())}},{key:"Bi",value:function(e,t,n,r){return this.Ni.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),t}(),Kw=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.persistence=n,this.Li=r,this.yt=a,this.qi=new iy(vv),this.Ui=new Im((function(e){return yy(e)}),my),this.Ki=new Map,this.Gi=n.getRemoteDocumentCache(),this.Cs=n.getTargetCache(),this.Ns=n.getBundleCache(),this.Qi(i)}return e(S)(t,[{key:"Qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Iw(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.qi)}))}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(e,t,n,r){return new Kw(e,t,n,r)}function Ww(e,t){return Hw.apply(this,arguments)}function Hw(){return(Hw=e(u)(e(s).mark((function t(n,r){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ev(n),e.next=3,i.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return i.mutationQueue.getAllMutationBatches(e).next((function(n){return t=n,i.Qi(r),i.mutationQueue.getAllMutationBatches(e)})).next((function(n){var r=[],a=[],o=Pm(),u=!0,s=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(u=(l=h.next()).done);u=!0){var f=l.value;r.push(f.batchId);var d=!0,v=!1,p=void 0;try{for(var y,m=f.mutations[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value;o=o.add(g.key)}}catch(e){v=!0,p=e}finally{try{d||null==m.return||m.return()}finally{if(v)throw p}}}}catch(e){s=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(s)throw c}}var k=!0,w=!1,b=void 0;try{for(var x,I=n[Symbol.iterator]();!(k=(x=I.next()).done);k=!0){var _=x.value;a.push(_.batchId);var T=!0,E=!1,S=void 0;try{for(var A,C=_.mutations[Symbol.iterator]();!(T=(A=C.next()).done);T=!0){var N=A.value;o=o.add(N.key)}}catch(e){E=!0,S=e}finally{try{T||null==C.return||C.return()}finally{if(E)throw S}}}}catch(e){w=!0,b=e}finally{try{k||null==I.return||I.return()}finally{if(w)throw b}}return i.localDocuments.getDocuments(e,o).next((function(e){return{ji:e,removedBatchIds:r,addedBatchIds:a}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Qw(e,t){var n=ev(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),o=Fv.resolve();return a.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var a=n.docVersions.get(e);$d(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=Pm(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function Yw(e){var t=ev(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Cs.getLastRemoteSnapshotVersion(e)}))}function Xw(e,t){var n=ev(e),r=t.snapshotVersion,i=n.qi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.qi;var o=[];t.targetChanges.forEach((function(a,u){var s=i.get(u);if(s){o.push(n.Cs.removeMatchingKeys(e,a.removedDocuments,u).next((function(){return n.Cs.addMatchingKeys(e,a.addedDocuments,u)})));var c,l,h,f=s.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(u)?f=f.withResumeToken(ap.EMPTY_BYTE_STRING,gv.min()).withLastLimboFreeSnapshotVersion(gv.min()):a.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(a.resumeToken,r)),i=i.insert(u,f),l=f,h=a,(0===(c=s).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&o.push(n.Cs.updateTargetData(e,f))}}));var u=Tm(),s=Pm();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Jw(e,a,t.documentUpdates).next((function(e){u=e.Wi,s=e.zi}))),!r.isEqual(gv.min())){var c=n.Cs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Cs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return Fv.waitFor(o).next((function(){return a.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,u,s)})).next((function(){return u}))})).then((function(e){return n.qi=i,e}))}function Jw(e,t,n){var r=Pm(),i=Pm();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=Tm();return n.forEach((function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(gv.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Qd("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)})),{Wi:r,zi:i}}))}function Zw(e,t){var n=ev(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function $w(e,t){var n=ev(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Cs.getTargetData(e,t).next((function(i){return i?(r=i,Fv.resolve(r)):n.Cs.allocateTargetId(e).next((function(i){return r=new ek(t,i,0,e.currentSequenceNumber),n.Cs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.qi.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.qi=n.qi.insert(e.targetId,e),n.Ui.set(t,e.targetId)),e}))}function eb(e,t,n){return tb.apply(this,arguments)}function tb(){return(tb=e(u)(e(s).mark((function t(n,r,i){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=ev(n),o=a.qi.get(r),u=i?"readwrite":"readwrite-primary",e.prev=1,e.t0=i,e.t0){e.next=6;break}return e.next=6,a.persistence.runTransaction("Release target",u,(function(e){return a.persistence.referenceDelegate.removeTarget(e,o)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),jv(e.t1)){e.next=12;break}throw e.t1;case 12:Qd("LocalStore","Failed to update sequence numbers for target ".concat(r,": ").concat(e.t1));case 13:a.qi=a.qi.remove(r),a.Ui.delete(o.target);case 14:case"end":return e.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}function nb(e,t,n){var r=ev(e),i=gv.min(),a=Pm();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=ev(e),i=r.Ui.get(n);return void 0!==i?Fv.resolve(r.qi.get(i)):r.Cs.getTargetData(t,n)}(r,e,Ny(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.Li.getDocumentsMatchingQuery(e,t,n?i:gv.min(),n?a:Pm())})).next((function(e){return ab(r,Fy(t),e),{documents:e,Hi:a}}))}))}function rb(e,t){var n=ev(e),r=ev(n.Cs),i=n.qi.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.ne(e,t).next((function(e){return e?e.target:null}))}))}function ib(e,t){var n=ev(e),r=n.Ki.get(t)||gv.min();return n.persistence.runTransaction("Get new document changes","readonly",(function(e){return n.Gi.getAllFromCollectionGroup(e,t,Cv(r,-1),Number.MAX_SAFE_INTEGER)})).then((function(e){return ab(n,t,e),e}))}function ab(e,t,n){var r=e.Ki.get(t)||gv.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Ki.set(t,r)}function ob(e,t,n,r){return ub.apply(this,arguments)}function ub(){return(ub=e(u)(e(s).mark((function t(n,r,i,a){var o,u,c,l,h,f,d,v,p,y,m,g,k;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=ev(n),u=Pm(),c=Tm(),l=!0,h=!1,f=void 0,e.prev=3,d=i[Symbol.iterator]();!(l=(v=d.next()).done);l=!0)p=v.value,y=r.Ji(p.metadata.name),p.document&&(u=u.add(y)),(m=r.Yi(p)).setReadTime(r.Xi(p.metadata.readTime)),c=c.insert(y,m);e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),h=!0,f=e.t0;case 11:e.prev=11,e.prev=12,l||null==d.return||d.return();case 14:if(e.prev=14,!h){e.next=17;break}throw f;case 17:return e.finish(14);case 18:return e.finish(11);case 19:return g=o.Gi.newChangeBuffer({trackRemovals:!0}),e.next=22,$w(o,(t=a,Ny(_y(wv.fromString("__bundle__/docs/".concat(t))))));case 22:return k=e.sent,e.abrupt("return",o.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return Jw(e,g,c).next((function(t){return g.apply(e),t})).next((function(t){return o.Cs.removeMatchingKeysForTargetId(e,k.targetId).next((function(){return o.Cs.addMatchingKeys(e,u,k.targetId)})).next((function(){return o.localDocuments.getLocalViewOfDocuments(e,t.Wi,t.zi)})).next((function(){return t.Wi}))}))})));case 24:case"end":return e.stop()}var t}),t,null,[[3,7,11,19],[12,,14,18]])})))).apply(this,arguments)}function sb(e,t){return cb.apply(this,arguments)}function cb(){return cb=e(u)(e(s).mark((function t(n,r){var i,a,o,u=arguments;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:Pm(),e.next=3,$w(n,Ny(ck(r.bundledQuery)));case 3:return a=e.sent,o=ev(n),e.abrupt("return",o.persistence.runTransaction("Save named query","readwrite",(function(e){var t=$m(r.readTime);if(a.snapshotVersion.compareTo(t)>=0)return o.Ns.saveNamedQuery(e,r);var n=a.withResumeToken(ap.EMPTY_BYTE_STRING,t);return o.qi=o.qi.insert(n.targetId,n),o.Cs.updateTargetData(e,n).next((function(){return o.Cs.removeMatchingKeysForTargetId(e,a.targetId)})).next((function(){return o.Cs.addMatchingKeys(e,i,a.targetId)})).next((function(){return o.Ns.saveNamedQuery(e,r)}))})));case 6:case"end":return e.stop()}}),t)}))),cb.apply(this,arguments)}function lb(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function hb(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function fb(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var db=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this.user=n,this.batchId=r,this.state=i,this.error=a}return e(S)(t,[{key:"tr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Zi",value:function(e,n,r){var i,a=JSON.parse(r),o="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return o&&a.error&&((o="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new nv(a.error.code,a.error.message))),o?new t(e,n,a.state,i):(Yd("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),t}(),vb=function(){"use strict";function t(n,r,i){e(E)(this,t),this.targetId=n,this.state=r,this.error=i}return e(S)(t,[{key:"tr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Zi",value:function(e,n){var r,i=JSON.parse(n),a="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new nv(i.error.code,i.error.message))),a?new t(e,i.state,r):(Yd("SharedClientState","Failed to parse target state for ID '".concat(e,"': ").concat(n)),null)}}]),t}(),pb=function(){"use strict";function t(n,r){e(E)(this,t),this.clientId=n,this.activeTargetIds=r}return e(S)(t,null,[{key:"Zi",value:function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,a=Mm(),o=0;i&&o<r.activeTargetIds.length;++o)i=rp(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new t(e,a):(Yd("SharedClientState","Failed to parse client data for instance '".concat(e,"': ").concat(n)),null)}}]),t}(),yb=function(){"use strict";function t(n,r){e(E)(this,t),this.clientId=n,this.onlineState=r}return e(S)(t,null,[{key:"Zi",value:function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Yd("SharedClientState","Failed to parse online state: ".concat(e)),null)}}]),t}(),mb=function(){"use strict";function t(){e(E)(this,t),this.activeTargetIds=Mm()}return e(S)(t,[{key:"er",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"nr",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"tr",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),t}(),gb=function(){"use strict";function t(n,r,i,a,o){e(E)(this,t),this.window=n,this.Hs=r,this.persistenceKey=i,this.sr=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new iy(vv),this.started=!1,this.cr=[];var u,s=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.ar=lb(this.persistenceKey,this.sr),this.hr=(u=this.persistenceKey,"firestore_sequence_number_".concat(u)),this.ur=this.ur.insert(this.sr,new mb),this.lr=new RegExp("^firestore_clients_".concat(s,"_([^_]*)$")),this.dr=new RegExp("^firestore_mutations_".concat(s,"_(\\d+)(?:_(.*))?$")),this._r=new RegExp("^firestore_targets_".concat(s,"_(\\d+)$")),this.wr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.mr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}return e(S)(t,[{key:"start",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i,a,o,u,c,l,h,f,d,v,p,y,m,g,k,w;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.syncEngine.vi();case 2:r=e.sent,i=!0,a=!1,o=void 0,e.prev=4,u=r[Symbol.iterator]();case 6:if(i=(c=u.next()).done){e.next=15;break}if((l=c.value)!==t.sr){e.next=10;break}return e.abrupt("continue",12);case 10:(h=t.getItem(lb(t.persistenceKey,l)))&&(f=pb.Zi(l,h))&&(t.ur=t.ur.insert(f.clientId,f));case 12:i=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),a=!0,o=e.t0;case 21:e.prev=21,e.prev=22,i||null==u.return||u.return();case 24:if(e.prev=24,!a){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:for(t.gr(),(d=t.storage.getItem(t.wr))&&(v=t.yr(d))&&t.pr(v),p=!0,y=!1,m=void 0,e.prev=33,g=t.cr[Symbol.iterator]();!(p=(k=g.next()).done);p=!0)w=k.value,t.rr(w);e.next=41;break;case 37:e.prev=37,e.t1=e.catch(33),y=!0,m=e.t1;case 41:e.prev=41,e.prev=42,p||null==g.return||g.return();case 44:if(e.prev=44,!y){e.next=47;break}throw m;case 47:return e.finish(44);case 48:return e.finish(41);case 49:t.cr=[],t.window.addEventListener("pagehide",(function(){return t.shutdown()})),t.started=!0;case 50:case"end":return e.stop()}}),n,null,[[4,17,21,29],[22,,24,28],[33,37,41,49],[42,,44,48]])})))()}},{key:"writeSequenceNumber",value:function(e){this.setItem(this.hr,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.Ir(this.ur)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.ur.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t}},{key:"addPendingMutation",value:function(e){this.Tr(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.Tr(e,t,n),this.Er(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(fb(this.persistenceKey,e));if(n){var r=vb.Zi(e,n);r&&(t=r.state)}}return this.Ar.er(e),this.gr(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Ar.nr(e),this.gr()}},{key:"isLocalQueryTarget",value:function(e){return this.Ar.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(fb(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.Rr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach((function(e){r.Er(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))}},{key:"setOnlineState",value:function(e){this.br(e)}},{key:"notifyBundleLoaded",value:function(e){this.Pr(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return Qd("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){Qd("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){Qd("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"rr",value:function(t){var n=t;if(n.storageArea===this.storage){if(Qd("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ar)return void Yd("Received WebStorage notification for local change. Another client might have garbage-collected our state");var r=this;this.Hs.enqueueRetryable(e(u)(e(s).mark((function t(){var i,a,o,u,c,l,h;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.started){e.next=42;break}if(null===n.key){e.next=40;break}if(!r.lr.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return i=r.vr(n.key),e.abrupt("return",r.Vr(i,null));case 6:if(!(a=r.Sr(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",r.Vr(a.clientId,a));case 9:e.next=40;break;case 11:if(!r.dr.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(o=r.Dr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",r.Cr(o));case 16:e.next=40;break;case 18:if(!r._r.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(u=r.Nr(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",r.kr(u));case 23:e.next=40;break;case 25:if(n.key!==r.wr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(c=r.yr(n.newValue))){e.next=30;break}return e.abrupt("return",r.pr(c));case 30:e.next=40;break;case 32:if(n.key!==r.hr){e.next=36;break}(l=function(e){var t=Yv.at;if(null!=e)try{var n=JSON.parse(e);$d("number"==typeof n),t=n}catch(e){Yd("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==Yv.at&&r.sequenceNumberHandler(l),e.next=40;break;case 36:if(n.key!==r.mr){e.next=40;break}return h=r.Or(n.newValue),e.next=40,Promise.all(h.map((function(e){return r.syncEngine.Mr(e)})));case 40:e.next=43;break;case 42:r.cr.push(n);case 43:case"end":return e.stop()}}),t)}))))}}},{key:"Ar",get:function(){return this.ur.get(this.sr)}},{key:"gr",value:function(){this.setItem(this.ar,this.Ar.tr())}},{key:"Tr",value:function(e,t,n){var r=new db(this.currentUser,e,t,n),i=hb(this.persistenceKey,this.currentUser,e);this.setItem(i,r.tr())}},{key:"Er",value:function(e){var t=hb(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"br",value:function(e){var t={clientId:this.sr,onlineState:e};this.storage.setItem(this.wr,JSON.stringify(t))}},{key:"Rr",value:function(e,t,n){var r=fb(this.persistenceKey,e),i=new vb(e,t,n);this.setItem(r,i.tr())}},{key:"Pr",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}},{key:"vr",value:function(e){var t=this.lr.exec(e);return t?t[1]:null}},{key:"Sr",value:function(e,t){var n=this.vr(e);return pb.Zi(n,t)}},{key:"Dr",value:function(e,t){var n=this.dr.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return db.Zi(new Kd(i),r,t)}},{key:"Nr",value:function(e,t){var n=this._r.exec(e),r=Number(n[1]);return vb.Zi(r,t)}},{key:"yr",value:function(e){return yb.Zi(e)}},{key:"Or",value:function(e){return JSON.parse(e)}},{key:"Cr",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==n.currentUser.uid){e.next=2;break}return e.abrupt("return",n.syncEngine.Fr(t.batchId,t.state,t.error));case 2:Qd("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}}),r)})))()}},{key:"kr",value:function(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}},{key:"Vr",value:function(e,t){var n=this,r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),o=[],u=[];return a.forEach((function(e){i.has(e)||o.push(e)})),i.forEach((function(e){a.has(e)||u.push(e)})),this.syncEngine.Br(o,u).then((function(){n.ur=r}))}},{key:"pr",value:function(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"Ir",value:function(e){var t=Mm();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t}}],[{key:"C",value:function(e){return!(!e||!e.localStorage)}}]),t}(),kb=function(){"use strict";function t(){e(E)(this,t),this.Lr=new mb,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e(S)(t,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Lr.er(e),this.qr[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.qr[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Lr.nr(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.qr[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Lr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Lr=new mb,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),t}(),wb=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,[{key:"Ur",value:function(e){}},{key:"shutdown",value:function(){}}]),t}(),bb=function(){"use strict";function t(){var n=this;e(E)(this,t),this.Kr=function(){return n.Gr()},this.Qr=function(){return n.jr()},this.Wr=[],this.zr()}return e(S)(t,[{key:"Ur",value:function(e){this.Wr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}},{key:"zr",value:function(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}},{key:"Gr",value:function(){Qd("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e=!0,t=!1,n=void 0;try{for(var r,i=this.Wr[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)(0)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"jr",value:function(){Qd("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e=!0,t=!1,n=void 0;try{for(var r,i=this.Wr[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)(1)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}],[{key:"C",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),t}(),xb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Ib=function(){"use strict";function t(n){e(E)(this,t),this.Hr=n.Hr,this.Jr=n.Jr}return e(S)(t,[{key:"Yr",value:function(e){this.Xr=e}},{key:"Zr",value:function(e){this.eo=e}},{key:"onMessage",value:function(e){this.no=e}},{key:"close",value:function(){this.Jr()}},{key:"send",value:function(e){this.Hr(e)}},{key:"so",value:function(){this.Xr()}},{key:"io",value:function(e){this.eo(e)}},{key:"ro",value:function(e){this.no(e)}}]),t}(),_b=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this,t)).forceLongPolling=t.forceLongPolling,i.autoDetectLongPolling=t.autoDetectLongPolling,i.useFetchStreams=t.useFetchStreams,e(Fc)(i)}return e(S)(r,[{key:"fo",value:function(e,t,n,r){return new Promise((function(i,a){var o=new jd;o.setWithCredentials(!0),o.listenOnce(Fd.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case Md.NO_ERROR:var t=o.getResponseJson();Qd("Connection","XHR received:",JSON.stringify(t)),i(t);break;case Md.TIMEOUT:Qd("Connection",'RPC "'+e+'" timed out'),a(new nv(tv.DEADLINE_EXCEEDED,"Request time out"));break;case Md.HTTP_ERROR:var n=o.getStatus();if(Qd("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson();Array.isArray(r)&&(r=r[0]);var u=null==r?void 0:r.error;if(u&&u.status&&u.message){var s=(c=u.status,l=c.toLowerCase().replace(/_/g,"-"),Object.values(tv).indexOf(l)>=0?l:tv.UNKNOWN);a(new nv(s,u.message))}else a(new nv(tv.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new nv(tv.UNAVAILABLE,"Connection failed."));break;default:Zd()}}finally{Qd("Connection",'RPC "'+e+'" completed.')}var c,l}));var u=JSON.stringify(r);o.send(t,"POST",u,n,15)}))}},{key:"wo",value:function(e,t,n){var r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Pd(),a=Ld(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new qd({})),this.lo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;var u=r.join("");Qd("Connection","Creating WebChannel: "+u,o);var s=i.createWebChannel(u,o),c=!1,l=!1,h=new Ib({Hr:function(e){l?Qd("Connection","Not sending because WebChannel is closed:",e):(c||(Qd("Connection","Opening WebChannel transport."),s.open(),c=!0),Qd("Connection","WebChannel sending:",e),s.send(e))},Jr:function(){return s.close()}}),f=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return f(s,Bd.EventType.OPEN,(function(){l||Qd("Connection","WebChannel transport opened.")})),f(s,Bd.EventType.CLOSE,(function(){l||(l=!0,Qd("Connection","WebChannel transport closed"),h.io())})),f(s,Bd.EventType.ERROR,(function(e){l||(l=!0,Xd("Connection","WebChannel transport errored:",e),h.io(new nv(tv.UNAVAILABLE,"The operation could not be completed")))})),f(s,Bd.EventType.MESSAGE,(function(e){var t;if(!l){var n=e.data[0];$d(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){Qd("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=ym[e];if(void 0!==t)return xm(t)}(a),u=i.message;void 0===o&&(o=tv.INTERNAL,u="Unknown error status: "+a+" with message "+i.message),l=!0,h.io(new nv(o,u)),s.close()}else Qd("Connection","WebChannel received:",n),h.ro(n)}})),f(a,Vd.STAT_EVENT,(function(e){e.stat===Ud.PROXY?Qd("Connection","Detected buffering proxy"):e.stat===Ud.NOPROXY&&Qd("Connection","Detected no buffering proxy")})),setTimeout((function(){h.so()}),0),h}}]),r}(function(){"use strict";function t(n){e(E)(this,t),this.databaseInfo=n,this.databaseId=n.databaseId;var r=n.ssl?"https":"http";this.oo=r+"://"+n.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return e(S)(t,[{key:"co",get:function(){return!1}},{key:"ao",value:function(e,t,n,r,i){var a=this.ho(e,t);Qd("RestConnection","Sending: ",a,n);var o={};return this.lo(o,r,i),this.fo(e,a,o,n).then((function(e){return Qd("RestConnection","Received: ",e),e}),(function(t){throw Xd("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t}))}},{key:"_o",value:function(e,t,n,r,i,a){return this.ao(e,t,n,r,i)}},{key:"lo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+zd,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"ho",value:function(e,t){var n=xb[e];return"".concat(this.oo,"/v1/").concat(t,":").concat(n)}}]),t}());
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tb(){return"undefined"!=typeof window?window:null}function Eb(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sb(e){return new Ym(e,!0)}var Ab=function(){"use strict";function t(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;e(E)(this,t),this.Hs=n,this.timerId=r,this.mo=i,this.yo=a,this.po=o,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}return e(S)(t,[{key:"reset",value:function(){this.Io=0}},{key:"Ao",value:function(){this.Io=this.po}},{key:"Ro",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),i=Math.max(0,n-r);i>0&&Qd("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Io," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,(function(){return t.Eo=Date.now(),e()})),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}},{key:"Po",value:function(){null!==this.To&&(this.To.skipDelay(),this.To=null)}},{key:"cancel",value:function(){null!==this.To&&(this.To.cancel(),this.To=null)}},{key:"bo",value:function(){return(Math.random()-.5)*this.Io}}]),t}(),Cb=function(){"use strict";function t(n,r,i,a,o,u,s,c){e(E)(this,t),this.Hs=n,this.vo=i,this.Vo=a,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=s,this.listener=c,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Ab(n,r)}return e(S)(t,[{key:"No",value:function(){return 1===this.state||5===this.state||this.ko()}},{key:"ko",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Oo()}},{key:"stop",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.No(),!e.t0){e.next=4;break}return e.next=4,t.close(0);case 4:case"end":return e.stop()}}),n)})))()}},{key:"Mo",value:function(){this.state=0,this.xo.reset()}},{key:"Fo",value:function(){var e=this;this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(function(){return e.$o()})))}},{key:"Bo",value:function(e){this.Lo(),this.stream.send(e)}},{key:"$o",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ko()){e.next=2;break}return e.abrupt("return",t.close(0));case 2:case"end":return e.stop()}}),n)})))()}},{key:"Lo",value:function(){this.Do&&(this.Do.cancel(),this.Do=null)}},{key:"qo",value:function(){this.Co&&(this.Co.cancel(),this.Co=null)}},{key:"close",value:function(t,n){var r=this;return e(u)(e(s).mark((function i(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.Lo(),r.qo(),r.xo.cancel(),r.So++,4!==t?r.xo.reset():n&&n.code===tv.RESOURCE_EXHAUSTED?(Yd(n.toString()),Yd("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):n&&n.code===tv.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Uo(),r.stream.close(),r.stream=null),r.state=t,e.next=9,r.listener.Zr(n);case 9:case"end":return e.stop()}}),i)})))()}},{key:"Uo",value:function(){}},{key:"auth",value:function(){var t=this;this.state=1;var n=this.Ko(this.So),r=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(n){var i=e(D)(n,2),a=i[0],o=i[1];t.So===r&&t.Go(a,o)}),(function(e){var r=t;n((function(){var t=new nv(tv.UNKNOWN,"Fetching auth token failed: "+e.message);return r.Qo(t)}))}))}},{key:"Go",value:function(e,t){var n=this,r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr((function(){var e=n;r((function(){return e.state=2,e.Co=e.Hs.enqueueAfterDelay(e.Vo,1e4,(function(){return e.ko()&&(e.state=3),Promise.resolve()})),e.listener.Yr()}))})),this.stream.Zr((function(e){var t=n;r((function(){return t.Qo(e)}))})),this.stream.onMessage((function(e){var t=n;r((function(){return t.onMessage(e)}))}))}},{key:"Oo",value:function(){var t=this;this.state=5,this.xo.Ro(e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.state=0,t.start();case 1:case"end":return e.stop()}}),n)}))))}},{key:"Qo",value:function(e){return Qd("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Ko",value:function(e){var t=this;return function(n){var r=t;t.Hs.enqueueAndForget((function(){return r.So===e?n():(Qd("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),t}(),Nb=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a,o,u,s){var c;return e(E)(this,r),(c=n.call(this,t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,a,o,s)).yt=u,e(Fc)(c)}return e(S)(r,[{key:"jo",value:function(e,t){return this.connection.wo("Listen",e,t)}},{key:"onMessage",value:function(e){this.xo.reset();var t=function(e,t){var n,r;if("targetChange"in t){t.targetChange;var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:Zd(),a=t.targetChange.targetIds||[],o=function(e,t){return e.wt?($d(void 0===t||"string"==typeof t),ap.fromBase64String(t||"")):($d(void 0===t||t instanceof Uint8Array),ap.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),u=t.targetChange.cause,s=u&&function(e){var t=void 0===e.code?tv.UNKNOWN:xm(e.code);return new nv(t,e.message||"")}(u);n=new Bm(i,a,o,s||null)}else if("documentChange"in t){t.documentChange;var c=t.documentChange;c.document,c.document.name,c.document.updateTime;var l=rg(e,c.document.name),h=$m(c.document.updateTime),f=c.document.createTime?$m(c.document.createTime):gv.min(),d=new hy({mapValue:{fields:c.document.fields}}),v=dy.newFoundDocument(l,h,f,d),p=c.targetIds||[],y=c.removedTargetIds||[];n=new Um(p,y,v.key,v)}else if("documentDelete"in t){t.documentDelete;var m=t.documentDelete;m.document;var g=rg(e,m.document),k=m.readTime?$m(m.readTime):gv.min(),w=dy.newNoDocument(g,k),b=m.removedTargetIds||[];n=new Um([],b,w.key,w)}else if("documentRemove"in t){t.documentRemove;var x=t.documentRemove;x.document;var I=rg(e,x.document),_=x.removedTargetIds||[];n=new Um([],_,I,null)}else{if(!("filter"in t))return Zd();t.filter;var T=t.filter;T.targetId;var E=T.count||0,S=new wm(E),A=T.targetId;n=new qm(A,S)}return n}(this.yt,e),n=function(e){if(!("targetChange"in e))return gv.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?gv.min():t.readTime?$m(t.readTime):gv.min()}(e);return this.listener.Wo(t,n)}},{key:"zo",value:function(e){var t,n,r,i,a={};a.database=og(this.yt),a.addTarget=(t=this.yt,i=(n=e).target,(r=gy(i)?{documents:fg(t,i)}:{query:dg(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=Jm(t,n.resumeToken):n.snapshotVersion.compareTo(gv.min())>0&&(r.readTime=Xm(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Zd()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.yt,e);o&&(a.labels=o),this.Bo(a)}},{key:"Ho",value:function(e){var t={};t.database=og(this.yt),t.removeTarget=e,this.Bo(t)}}]),r}(Cb),Db=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a,o,u,s){var c;return e(E)(this,r),(c=n.call(this,t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,a,o,s)).yt=u,c.Jo=!1,e(Fc)(c)}return e(S)(r,[{key:"Yo",get:function(){return this.Jo}},{key:"start",value:function(){this.Jo=!1,this.lastStreamToken=void 0,e(fn)(e(pn)(r.prototype),"start",this).call(this)}},{key:"Uo",value:function(){this.Jo&&this.Xo([])}},{key:"jo",value:function(e,t){return this.connection.wo("Write",e,t)}},{key:"onMessage",value:function(e){if($d(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();var t=(r=e.writeResults,i=e.commitTime,r&&r.length>0?($d(void 0!==i),r.map((function(e){return n=i,(r=(t=e).updateTime?$m(t.updateTime):$m(n)).isEqual(gv.min())&&(r=$m(n)),new nm(r,t.transformResults||[]);var t,n,r}))):[]),n=$m(e.commitTime);return this.listener.Zo(n,t)}var r,i;return $d(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}},{key:"eu",value:function(){var e={};e.database=og(this.yt),this.Bo(e)}},{key:"Xo",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return lg(t.yt,e)}))};this.Bo(n)}}]),r}(Cb),Rb=function(t){"use strict";e(N)(r,(function t(){e(E)(this,t)}));var n=e(G)(r);function r(t,i,a,o){var u;return e(E)(this,r),(u=n.call(this)).authCredentials=t,u.appCheckCredentials=i,u.connection=a,u.yt=o,u.nu=!1,e(Fc)(u)}return e(S)(r,[{key:"su",value:function(){if(this.nu)throw new nv(tv.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ao",value:function(t,n,r){var i=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=e(D)(a,2),u=o[0],s=o[1];return i.connection.ao(t,n,r,u,s)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===tv.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new nv(tv.UNKNOWN,e.toString())}))}},{key:"_o",value:function(t,n,r,i){var a=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(o){var u=e(D)(o,2),s=u[0],c=u[1];return a.connection._o(t,n,r,s,c,i)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===tv.UNAUTHENTICATED&&(a.authCredentials.invalidateToken(),a.appCheckCredentials.invalidateToken()),e):new nv(tv.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.nu=!0}}]),r}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ob=function(){"use strict";function t(n,r){e(E)(this,t),this.asyncQueue=n,this.onlineStateHandler=r,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}return e(S)(t,[{key:"uu",value:function(){var e=this;0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.ru=null,e.au("Backend didn't respond within 10 seconds."),e.cu("Offline"),Promise.resolve()})))}},{key:"hu",value:function(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.cu("Offline")))}},{key:"set",value:function(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}},{key:"cu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"au",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.ou?(Yd(t),this.ou=!1):Qd("OnlineStateTracker",t)}},{key:"lu",value:function(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}]),t}(),Pb=function t(n,r,i,a,o){"use strict";var c=this;e(E)(this,t),this.localStore=n,this.datastore=r,this.asyncQueue=i,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=o,this.mu.Ur((function(t){var n=c;i.enqueueAndForget(e(u)(e(s).mark((function t(){return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=zb(n),!t.t0){t.next=5;break}return Qd("RemoteStore","Restarting streams for network reachability change."),t.next=5,function(){var t=e(u)(e(s).mark((function t(n){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=ev(n))._u.add(4),e.next=4,Fb(r);case 4:return r.gu.set("Unknown"),r._u.delete(4),e.next=8,Lb(r);case 8:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(n);case 5:case"end":return t.stop()}}),t)}))))})),this.gu=new Ob(i,a)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lb(e){return Mb.apply(this,arguments)}function Mb(){return(Mb=e(u)(e(s).mark((function t(n){var r,i,a,o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,i=!1,a=void 0,!zb(n)){e.next=25;break}e.prev=2,o=n.wu[Symbol.iterator]();case 4:if(r=(u=o.next()).done){e.next=11;break}return c=u.value,e.next=8,c(!0);case 8:r=!0,e.next=4;break;case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),i=!0,a=e.t0;case 17:e.prev=17,e.prev=18,r||null==o.return||o.return();case 20:if(e.prev=20,!i){e.next=23;break}throw a;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}}),t,null,[[2,13,17,25],[18,,20,24]])})))).apply(this,arguments)}function Fb(e){return Vb.apply(this,arguments)}function Vb(){return(Vb=e(u)(e(s).mark((function t(n){var r,i,a,o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!0,i=!1,a=void 0,e.prev=1,o=n.wu[Symbol.iterator]();case 3:if(r=(u=o.next()).done){e.next=10;break}return c=u.value,e.next=7,c(!1);case 7:r=!0,e.next=3;break;case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),i=!0,a=e.t0;case 16:e.prev=16,e.prev=17,r||null==o.return||o.return();case 19:if(e.prev=19,!i){e.next=22;break}throw a;case 22:return e.finish(19);case 23:return e.finish(16);case 24:case"end":return e.stop()}}),t,null,[[1,12,16,24],[17,,19,23]])})))).apply(this,arguments)}function Ub(e,t){var n=ev(e);n.du.has(t.targetId)||(n.du.set(t.targetId,t),Kb(n)?Gb(n):wx(n).ko()&&Bb(n,t))}function qb(e,t){var n=ev(e),r=wx(n);n.du.delete(t),r.ko()&&jb(n,t),0===n.du.size&&(r.ko()?r.Fo():zb(n)&&n.gu.set("Unknown"))}function Bb(e,t){e.yu.Ot(t.targetId),wx(e).zo(t)}function jb(e,t){e.yu.Ot(t),wx(e).Ho(t)}function Gb(e){e.yu=new Gm({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},ne:function(t){return e.du.get(t)||null}}),wx(e).start(),e.gu.uu()}function Kb(e){return zb(e)&&!wx(e).No()&&e.du.size>0}function zb(e){return 0===ev(e)._u.size}function Wb(e){e.yu=void 0}function Hb(e){return Qb.apply(this,arguments)}function Qb(){return(Qb=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.du.forEach((function(e,t){Bb(n,e)}));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Yb(e,t){return Xb.apply(this,arguments)}function Xb(){return(Xb=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Wb(n),Kb(n)?(n.gu.hu(r),Gb(n)):n.gu.set("Unknown");case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Jb(e,t,n){return Zb.apply(this,arguments)}function Zb(){return Zb=e(u)(e(s).mark((function t(n,r,i){var a;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.gu.set("Online"),!(r instanceof Bm&&2===r.state&&r.cause)){t.next=13;break}return t.prev=1,t.next=4,function(){var t=e(u)(e(s).mark((function t(n,r){var i,a,o,u,c,l,h;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=r.cause,a=!0,o=!1,u=void 0,e.prev=2,c=r.targetIds[Symbol.iterator]();case 4:if(a=(l=c.next()).done){e.next=15;break}if(h=l.value,e.t0=n.du.has(h),!e.t0){e.next=12;break}return e.next=10,n.remoteSyncer.rejectListen(h,i);case 10:n.du.delete(h),n.yu.removeTarget(h);case 12:a=!0,e.next=4;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(2),o=!0,u=e.t1;case 21:e.prev=21,e.prev=22,a||null==c.return||c.return();case 24:if(e.prev=24,!o){e.next=27;break}throw u;case 27:return e.finish(24);case 28:return e.finish(21);case 29:case"end":return e.stop()}}),t,null,[[2,17,21,29],[22,,24,28]])})));return function(e,n){return t.apply(this,arguments)}}()(n,r);case 4:t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(1),Qd("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),t.t0),t.next=11,$b(n,t.t0);case 11:case 22:t.next=29;break;case 13:if(r instanceof Um?n.yu.Kt(r):r instanceof qm?n.yu.Jt(r):n.yu.jt(r),i.isEqual(gv.min())){t.next=29;break}return t.prev=14,t.next=17,Yw(n.localStore);case 17:if(a=t.sent,t.t1=i.compareTo(a)>=0,!t.t1){t.next=22;break}return t.next=22,function(e,t){var n=e.yu.Zt(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.du.get(r);i&&e.du.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.du.get(t);if(n){e.du.set(t,n.withResumeToken(ap.EMPTY_BYTE_STRING,n.snapshotVersion)),jb(e,t);var r=new ek(n.target,t,1,n.sequenceNumber);Bb(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(n,i);case 24:return t.prev=24,t.t2=t.catch(14),Qd("RemoteStore","Failed to raise snapshot:",t.t2),t.next=29,$b(n,t.t2);case 29:case"end":return t.stop()}}),t,null,[[1,6],[14,24]])}))),Zb.apply(this,arguments)}function $b(e,t,n){return ex.apply(this,arguments)}function ex(){return(ex=e(u)(e(s).mark((function t(n,r,i){return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(jv(r)){t.next=2;break}throw r;case 2:return n._u.add(1),t.next=5,Fb(n);case 5:n.gu.set("Offline"),i||(i=function(){return Yw(n.localStore)}),n.asyncQueue.enqueueRetryable(e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Qd("RemoteStore","Retrying IndexedDB access"),e.next=3,i();case 3:return n._u.delete(1),e.next=6,Lb(n);case 6:case"end":return e.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function tx(e,t){return t().catch((function(n){return $b(e,n,t)}))}function nx(e){return rx.apply(this,arguments)}function rx(){return(rx=e(u)(e(s).mark((function t(n){var r,i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=ev(n),i=bx(r),a=r.fu.length>0?r.fu[r.fu.length-1].batchId:-1;case 2:if(!ix(r)){e.next=19;break}return e.prev=3,e.next=6,Zw(r.localStore,a);case 6:if(null!==(o=e.sent)){e.next=10;break}return 0===r.fu.length&&i.Fo(),e.abrupt("break",19);case 10:a=o.batchId,ax(r,o),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,$b(r,e.t0);case 17:e.next=2;break;case 19:ox(r)&&ux(r);case 20:case"end":return e.stop()}}),t,null,[[3,13]])})))).apply(this,arguments)}function ix(e){return zb(e)&&e.fu.length<10}function ax(e,t){e.fu.push(t);var n=bx(e);n.ko()&&n.Yo&&n.Xo(t.mutations)}function ox(e){return zb(e)&&!bx(e).No()&&e.fu.length>0}function ux(e){bx(e).start()}function sx(e){return cx.apply(this,arguments)}function cx(){return(cx=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:bx(n).eu();case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function lx(e){return hx.apply(this,arguments)}function hx(){return(hx=e(u)(e(s).mark((function t(n){var r,i,a,o,u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=bx(n),i=!0,a=!1,o=void 0,e.prev=2,u=n.fu[Symbol.iterator]();!(i=(c=u.next()).done);i=!0)l=c.value,r.Xo(l.mutations);e.next=10;break;case 6:e.prev=6,e.t0=e.catch(2),a=!0,o=e.t0;case 10:e.prev=10,e.prev=11,i||null==u.return||u.return();case 13:if(e.prev=13,!a){e.next=16;break}throw o;case 16:return e.finish(13);case 17:return e.finish(10);case 18:case"end":return e.stop()}}),t,null,[[2,6,10,18],[11,,13,17]])})))).apply(this,arguments)}function fx(e,t,n){return dx.apply(this,arguments)}function dx(){return(dx=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.fu.shift(),o=Zg.from(a,r,i),e.next=3,tx(n,(function(){return n.remoteSyncer.applySuccessfulWrite(o)}));case 3:return e.next=5,nx(n);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function vx(e,t){return px.apply(this,arguments)}function px(){return px=e(u)(e(s).mark((function t(n,r){return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=r&&bx(n).Yo,!t.t0){t.next=4;break}return t.next=4,function(){var t=e(u)(e(s).mark((function t(n,r){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!bm(a=r.code)||a===tv.ABORTED){e.next=7;break}return i=n.fu.shift(),bx(n).Mo(),e.next=5,tx(n,(function(){return n.remoteSyncer.rejectFailedWrite(i.batchId,r)}));case 5:return e.next=7,nx(n);case 7:case 8:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(n,r);case 4:ox(n)&&ux(n);case 5:case"end":return t.stop()}}),t)}))),px.apply(this,arguments)}function yx(e,t){return mx.apply(this,arguments)}function mx(){return(mx=e(u)(e(s).mark((function t(n,r){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=ev(n)).asyncQueue.verifyOperationInProgress(),Qd("RemoteStore","RemoteStore received new credentials"),a=zb(i),i._u.add(3),e.next=6,Fb(i);case 6:return a&&i.gu.set("Unknown"),e.next=9,i.remoteSyncer.handleCredentialChange(r);case 9:return i._u.delete(3),e.next=12,Lb(i);case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function gx(e,t){return kx.apply(this,arguments)}function kx(){return(kx=e(u)(e(s).mark((function t(n,r){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=ev(n),!r){e.next=7;break}return i._u.delete(2),e.next=5,Lb(i);case 5:e.next=13;break;case 7:if(e.t0=r,e.t0){e.next=13;break}return i._u.add(2),e.next=12,Fb(i);case 12:i.gu.set("Unknown");case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function wx(t){return t.pu||(t.pu=(r=t.datastore,i=t.asyncQueue,a={Yr:Hb.bind(null,t),Zr:Yb.bind(null,t),Wo:Jb.bind(null,t)},(o=ev(r)).su(),new Nb(i,o.connection,o.authCredentials,o.appCheckCredentials,o.yt,a)),t.wu.push((n=e(u)(e(s).mark((function n(r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=4;break}t.pu.Mo(),Kb(t)?Gb(t):t.gu.set("Unknown"),e.next=7;break;case 4:return e.next=6,t.pu.stop();case 6:Wb(t);case 7:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))),t.pu;var n,r,i,a,o}function bx(t){return t.Iu||(t.Iu=(r=t.datastore,i=t.asyncQueue,a={Yr:sx.bind(null,t),Zr:vx.bind(null,t),tu:lx.bind(null,t),Zo:fx.bind(null,t)},(o=ev(r)).su(),new Db(i,o.connection,o.authCredentials,o.appCheckCredentials,o.yt,a)),t.wu.push((n=e(u)(e(s).mark((function n(r){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return t.Iu.Mo(),e.next=4,nx(t);case 4:e.next=9;break;case 6:return e.next=8,t.Iu.stop();case 8:t.fu.length>0&&(Qd("RemoteStore","Stopping write stream with ".concat(t.fu.length," pending writes")),t.fu=[]);case 9:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))),t.Iu
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */;var n,r,i,a,o}var xx=function(){"use strict";function t(n,r,i,a,o){e(E)(this,t),this.asyncQueue=n,this.timerId=r,this.targetTimeMs=i,this.op=a,this.removalCallback=o,this.deferred=new rv,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return e(S)(t,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new nv(tv.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}],[{key:"createAndSchedule",value:function(e,n,r,i,a){var o=new t(e,n,Date.now()+r,i,a);return o.start(r),o}}]),t}();function Ix(e,t){if(Yd("AsyncQueue","".concat(t,": ").concat(e)),jv(e))return new nv(tv.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _x=function(){"use strict";function t(n){e(E)(this,t),this.comparator=n?function(e,t){return n(e,t)||Iv.comparator(e.key,t.key)}:function(e,t){return Iv.comparator(e.key,t.key)},this.keyedMap=Sm(),this.sortedSet=new iy(this.comparator)}return e(S)(t,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}],[{key:"emptySet",value:function(e){return new t(e.comparator)}}]),t}(),Tx=function(){"use strict";function t(){e(E)(this,t),this.Tu=new iy(Iv.comparator)}return e(S)(t,[{key:"track",value:function(e){var t=e.doc.key,n=this.Tu.get(t);n?0!==e.type&&3===n.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==n.type?this.Tu=this.Tu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Tu=this.Tu.remove(t):1===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):Zd():this.Tu=this.Tu.insert(t,e)}},{key:"Eu",value:function(){var e=[];return this.Tu.inorderTraversal((function(t,n){e.push(n)})),e}}]),t}(),Ex=function(){"use strict";function t(n,r,i,a,o,u,s,c,l){e(E)(this,t),this.query=n,this.docs=r,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=s,this.excludesMetadataChanges=c,this.hasCachedResults=l}return e(S)(t,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Oy(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(e,n,r,i,a){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new t(e,n,_x.emptySet(n),o,r,i,!0,!1,a)}}]),t}(),Sx=function t(){"use strict";e(E)(this,t),this.Au=void 0,this.listeners=[]},Ax=function t(){"use strict";e(E)(this,t),this.queries=new Im((function(e){return Py(e)}),Oy),this.onlineState="Unknown",this.Ru=new Set};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(e,t){return Nx.apply(this,arguments)}function Nx(){return(Nx=e(u)(e(s).mark((function t(n,r){var i,a,o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=ev(n),a=r.query,o=!1,(u=i.queries.get(a))||(o=!0,u=new Sx),!o){e.next=13;break}return e.prev=3,e.next=6,i.onListen(a);case 6:u.Au=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),c=Ix(e.t0,"Initialization of query '".concat(Ly(r.query),"' failed")),e.abrupt("return",void r.onError(c));case 13:i.queries.set(a,u),u.listeners.push(r),r.bu(i.onlineState),u.Au&&r.Pu(u.Au)&&Lx(i);case 14:case"end":return e.stop()}}),t,null,[[3,9]])})))).apply(this,arguments)}function Dx(e,t){return Rx.apply(this,arguments)}function Rx(){return(Rx=e(u)(e(s).mark((function t(n,r){var i,a,o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=ev(n),a=r.query,o=!1,(u=i.queries.get(a))&&(c=u.listeners.indexOf(r))>=0&&(u.listeners.splice(c,1),o=0===u.listeners.length),!o){e.next=6;break}return e.abrupt("return",(i.queries.delete(a),i.onUnlisten(a)));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ox(e,t){var n=ev(e),r=!1,i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=c.query,h=n.queries.get(l);if(h){var f=!0,d=!1,v=void 0;try{for(var p,y=h.listeners[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){p.value.Pu(c)&&(r=!0)}}catch(e){d=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw v}}h.Au=c}}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}r&&Lx(n)}function Px(e,t,n){var r=ev(e),i=r.queries.get(t),a=!0,o=!1,u=void 0;if(i)try{for(var s,c=i.listeners[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){s.value.onError(n)}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}r.queries.delete(t)}function Lx(e){e.Ru.forEach((function(e){e.next()}))}var Mx=function(){"use strict";function t(n,r,i){e(E)(this,t),this.query=n,this.vu=r,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=i||{}}return e(S)(t,[{key:"Pu",value:function(e){if(!this.options.includeMetadataChanges){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e.docChanges[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;3!==u.type&&t.push(u)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}e=new Ex(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var s=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),s=!0):this.Cu(e,this.onlineState)&&(this.xu(e),s=!0),this.Su=e,s}},{key:"onError",value:function(e){this.vu.error(e)}},{key:"bu",value:function(e){this.onlineState=e;var t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}},{key:"Cu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Nu||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"Du",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"xu",value:function(e){e=Ex.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}]),t}(),Fx=function(){"use strict";function t(n,r){e(E)(this,t),this.ku=n,this.byteLength=r}return e(S)(t,[{key:"Ou",value:function(){return"metadata"in this.ku}}]),t}(),Vx=function(){"use strict";function t(n){e(E)(this,t),this.yt=n}return e(S)(t,[{key:"Ji",value:function(e){return rg(this.yt,e)}},{key:"Yi",value:function(e){return e.metadata.exists?cg(this.yt,e.document,!1):dy.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}},{key:"Xi",value:function(e){return $m(e)}}]),t}(),Ux=function(){"use strict";function t(n,r,i){e(E)(this,t),this.Mu=n,this.localStore=r,this.yt=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=qx(n)}return e(S)(t,[{key:"Fu",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.ku.namedQuery)this.queries.push(e.ku.namedQuery);else if(e.ku.documentMetadata){this.documents.push({metadata:e.ku.documentMetadata}),e.ku.documentMetadata.exists||++t;var n=wv.fromString(e.ku.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.ku.document&&(this.documents[this.documents.length-1].document=e.ku.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"$u",value:function(e){var t=new Map,n=new Vx(this.yt),r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(s.metadata.queries){var c=n.Ji(s.metadata.name),l=!0,h=!1,f=void 0;try{for(var d,v=s.metadata.queries[Symbol.iterator]();!(l=(d=v.next()).done);l=!0){var p=d.value,y=(t.get(p)||Pm()).add(c);t.set(p,y)}}catch(e){h=!0,f=e}finally{try{l||null==v.return||v.return()}finally{if(h)throw f}}}}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return t}},{key:"complete",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i,a,o,u,c,l,h;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ob(t.localStore,new Vx(t.yt),t.documents,t.Mu.id);case 2:r=e.sent,i=t.$u(t.documents),a=!0,o=!1,u=void 0,e.prev=5,c=t.queries[Symbol.iterator]();case 7:if(a=(l=c.next()).done){e.next=14;break}return h=l.value,e.next=11,sb(t.localStore,h,i.get(h.name));case 11:a=!0,e.next=7;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),o=!0,u=e.t0;case 20:e.prev=20,e.prev=21,a||null==c.return||c.return();case 23:if(e.prev=23,!o){e.next=26;break}throw u;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",(t.progress.taskState="Success",{progress:t.progress,Bu:t.collectionGroups,Lu:r}));case 29:case"end":return e.stop()}}),n,null,[[5,16,20,28],[21,,23,27]])})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bx=function t(n){"use strict";e(E)(this,t),this.key=n},jx=function t(n){"use strict";e(E)(this,t),this.key=n},Gx=function(){"use strict";function t(n,r){e(E)(this,t),this.query=n,this.qu=r,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Pm(),this.mutatedKeys=Pm(),this.Gu=Vy(n),this.Qu=new _x(this.Gu)}return e(S)(t,[{key:"ju",get:function(){return this.qu}},{key:"Wu",value:function(e,t){var n=this,r=t?t.zu:new Tx,i=t?t.Qu:this.Qu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,s="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=My(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),v=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),v=!0):n.Hu(l,h)||(r.track({type:2,doc:h}),v=!0,(s&&n.Gu(h,s)>0||c&&n.Gu(h,c)<0)&&(u=!0)):!l&&h?(r.track({type:0,doc:h}),v=!0):l&&!h&&(r.track({type:1,doc:l}),v=!0,(s||c)&&(u=!0)),v&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Qu:o,zu:r,$i:u,mutatedKeys:a}}},{key:"Hu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;var a=e.zu.Eu();a.sort((function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Zd()}})(n)-a(i)||r.Gu(e.doc,t.doc);var n,i,a})),this.Ju(n);var o=t?this.Yu():[],u=0===this.Ku.size&&this.current?1:0,s=u!==this.Uu;return this.Uu=u,0!==a.length||s?{snapshot:new Ex(this.query,e.Qu,i,a,e.mutatedKeys,0===u,s,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}},{key:"bu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Tx,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}},{key:"Zu",value:function(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}},{key:"Ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.qu=t.qu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.qu=t.qu.delete(e)})),this.current=e.current)}},{key:"Yu",value:function(){var e=this;if(!this.current)return[];var t=this.Ku;this.Ku=Pm(),this.Qu.forEach((function(t){e.Zu(t.key)&&(e.Ku=e.Ku.add(t.key))}));var n=[];return t.forEach((function(t){e.Ku.has(t)||n.push(new jx(t))})),this.Ku.forEach((function(e){t.has(e)||n.push(new Bx(e))})),n}},{key:"tc",value:function(e){this.qu=e.Hi,this.Ku=Pm();var t=this.Wu(e.documents);return this.applyChanges(t,!0)}},{key:"ec",value:function(){return Ex.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}]),t}(),Kx=function t(n,r,i){"use strict";e(E)(this,t),this.query=n,this.targetId=r,this.view=i},zx=function t(n){"use strict";e(E)(this,t),this.key=n,this.nc=!1},Wx=function(){"use strict";function t(n,r,i,a,o,u){e(E)(this,t),this.localStore=n,this.remoteStore=r,this.eventManager=i,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.sc={},this.ic=new Im((function(e){return Py(e)}),Oy),this.rc=new Map,this.oc=new Set,this.uc=new iy(Iv.comparator),this.cc=new Map,this.ac=new Ew,this.hc={},this.lc=new Map,this.fc=nw.vn(),this.onlineState="Unknown",this.dc=void 0}return e(S)(t,[{key:"isPrimaryClient",get:function(){return!0===this.dc}}]),t}();function Hx(e,t){return Qx.apply(this,arguments)}function Qx(){return(Qx=e(u)(e(s).mark((function t(n,r){var i,a,o,u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=qI(n),!(u=i.ic.get(r))){e.next=7;break}a=u.targetId,i.sharedClientState.addLocalQueryTarget(a),o=u.view.ec(),e.next=16;break;case 7:return e.next=9,$w(i.localStore,Ny(r));case 9:return c=e.sent,i.isPrimaryClient&&Ub(i.remoteStore,c),l=i.sharedClientState.addLocalQueryTarget(c.targetId),a=c.targetId,e.next=15,Yx(i,r,a,"current"===l,c.resumeToken);case 15:o=e.sent;case 16:return e.abrupt("return",o);case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Yx(e,t,n,r,i){return Xx.apply(this,arguments)}function Xx(){return Xx=e(u)(e(s).mark((function t(n,r,i,a,o){var c,l,h,f,d,v;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n._c=function(t,r,i){return(a=e(u)(e(s).mark((function t(n,r,i,a){var o,u,c;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.view.Wu(i),e.t0=o.$i,!e.t0){e.next=6;break}return e.next=5,nb(n.localStore,r.query,!1).then((function(e){var t=e.documents;return r.view.Wu(t,o)}));case 5:o=e.sent;case 6:return u=a&&a.targetChanges.get(r.targetId),c=r.view.applyChanges(o,n.isPrimaryClient,u),e.abrupt("return",(yI(n,r.targetId,c.Xu),c.snapshot));case 8:case"end":return e.stop()}}),t)}))),function(e,t,n,r){return a.apply(this,arguments)})(n,t,r,i);var a},t.next=3,nb(n.localStore,r,!0);case 3:return c=t.sent,l=new Gx(r,c.Hi),h=l.Wu(c.documents),f=Vm.createSynthesizedTargetChangeForCurrentChange(i,a&&"Offline"!==n.onlineState,o),d=l.applyChanges(h,n.isPrimaryClient,f),yI(n,i,d.Xu),v=new Kx(r,i,l),t.abrupt("return",(n.ic.set(r,v),n.rc.has(i)?n.rc.get(i).push(r):n.rc.set(i,[r]),d.snapshot));case 11:case"end":return t.stop()}}),t)}))),Xx.apply(this,arguments)}function Jx(e,t){return Zx.apply(this,arguments)}function Zx(){return(Zx=e(u)(e(s).mark((function t(n,r){var i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=ev(n),a=i.ic.get(r),!((o=i.rc.get(a.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(i.rc.set(a.targetId,o.filter((function(e){return!Oy(e,r)}))),void i.ic.delete(r)));case 3:if(!i.isPrimaryClient){e.next=11;break}if(i.sharedClientState.removeLocalQueryTarget(a.targetId),e.t0=i.sharedClientState.isActiveQueryTarget(a.targetId),e.t0){e.next=9;break}return e.next=9,eb(i.localStore,a.targetId,!1).then((function(){i.sharedClientState.clearQueryState(a.targetId),qb(i.remoteStore,a.targetId),vI(i,a.targetId)})).catch(Lv);case 9:e.next=14;break;case 11:return vI(i,a.targetId),e.next=14,eb(i.localStore,a.targetId,!0);case 14:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function $x(e,t,n){return eI.apply(this,arguments)}function eI(){return(eI=e(u)(e(s).mark((function t(n,r,i){var a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=BI(n),e.prev=1,e.next=4,function(e,t){var n,r,i=ev(e),a=mv.now(),o=t.reduce((function(e,t){return e.add(t.key)}),Pm());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var u=Tm(),s=Pm();return i.Gi.getEntries(e,o).next((function(e){(u=e).forEach((function(e,t){t.isValidDocument()||(s=s.add(e))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(e,u)})).next((function(r){n=r;var o=[],u=!0,s=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(u=(l=h.next()).done);u=!0){var f=l.value,d=cm(f,n.get(f.key).overlayedDocument);null!=d&&o.push(new fm(f.key,d,fy(d.value.mapValue),rm.exists(!0)))}}catch(e){s=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(s)throw c}}return i.mutationQueue.addMutationBatch(e,a,o,t)})).next((function(t){r=t;var a=t.applyToLocalDocumentSet(n,s);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)}))})).then((function(){return{batchId:r.batchId,changes:Am(n)}}))}(a.localStore,r);case 4:return o=e.sent,a.sharedClientState.addPendingMutation(o.batchId),t=a,s=o.batchId,c=i,l=void 0,(l=t.hc[t.currentUser.toKey()])||(l=new iy(vv)),l=l.insert(s,c),t.hc[t.currentUser.toKey()]=l,e.next=9,kI(a,o.changes);case 9:return e.next=11,nx(a.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),u=Ix(e.t0,"Failed to persist write"),i.reject(u);case 17:case"end":return e.stop()}var t,s,c,l}),t,null,[[1,13]])})))).apply(this,arguments)}function tI(e,t){return nI.apply(this,arguments)}function nI(){return(nI=e(u)(e(s).mark((function t(n,r){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ev(n),e.prev=1,e.next=4,Xw(i.localStore,r);case 4:return a=e.sent,r.targetChanges.forEach((function(e,t){var n=i.cc.get(t);n&&($d(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.nc=!0:e.modifiedDocuments.size>0?$d(n.nc):e.removedDocuments.size>0&&($d(n.nc),n.nc=!1))})),e.next=8,kI(i,a,r);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Lv(e.t0);case 14:case"end":return e.stop()}}),t,null,[[1,10]])})))).apply(this,arguments)}function rI(e,t,n){var r=ev(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.ic.forEach((function(e,n){var r=n.view.bu(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=ev(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i=!0,a=!1,o=void 0;try{for(var u,s=n.listeners[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){u.value.bu(t)&&(r=!0)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}})),r&&Lx(n)}(r.eventManager,t),i.length&&r.sc.Wo(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function iI(e,t,n){return aI.apply(this,arguments)}function aI(){return(aI=e(u)(e(s).mark((function t(n,r,i){var a,o,u,c,l,h;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=ev(n)).sharedClientState.updateQueryState(r,"rejected",i),o=a.cc.get(r),!(u=o&&o.key)){e.next=14;break}return c=(c=new iy(Iv.comparator)).insert(u,dy.newNoDocument(u,gv.min())),l=Pm().add(u),h=new Fm(gv.min(),new Map,new uy(vv),c,l),e.next=9,tI(a,h);case 9:a.uc=a.uc.remove(u),a.cc.delete(r),gI(a),e.next=16;break;case 14:return e.next=16,eb(a.localStore,r,!1).then((function(){return vI(a,r,i)})).catch(Lv);case 16:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function oI(e,t){return uI.apply(this,arguments)}function uI(){return(uI=e(u)(e(s).mark((function t(n,r){var i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ev(n),a=r.batch.batchId,e.prev=1,e.next=4,Qw(i.localStore,r);case 4:return o=e.sent,dI(i,a,null),fI(i,a),i.sharedClientState.updateMutationState(a,"acknowledged"),e.next=10,kI(i,o);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Lv(e.t0);case 16:case"end":return e.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function sI(e,t,n){return cI.apply(this,arguments)}function cI(){return(cI=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ev(n),e.prev=1,e.next=4,function(e,t){var n=ev(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return $d(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(a.localStore,r);case 4:return o=e.sent,dI(a,r,i),fI(a,r),a.sharedClientState.updateMutationState(r,"rejected",i),e.next=10,kI(a,o);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Lv(e.t0);case 16:case"end":return e.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function lI(e,t){return hI.apply(this,arguments)}function hI(){return(hI=e(u)(e(s).mark((function t(n,r){var i,a,o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return zb((i=ev(n)).remoteStore)||Qd("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=ev(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))}(i.localStore);case 5:if(-1!==(a=e.sent)){e.next=8;break}return e.abrupt("return",void r.resolve());case 8:(o=i.lc.get(a)||[]).push(r),i.lc.set(a,o),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),u=Ix(e.t0,"Initialization of waitForPendingWrites() operation failed"),r.reject(u);case 16:case"end":return e.stop()}}),t,null,[[2,12]])})))).apply(this,arguments)}function fI(e,t){(e.lc.get(t)||[]).forEach((function(e){e.resolve()})),e.lc.delete(t)}function dI(e,t,n){var r=ev(e),i=r.hc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.hc[r.currentUser.toKey()]=i}}function vI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r=!0,i=!1,a=void 0;try{for(var o,u=e.rc.get(t)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;e.ic.delete(s),n&&e.sc.wc(s,n)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}e.rc.delete(t),e.isPrimaryClient&&e.ac.ls(t).forEach((function(t){e.ac.containsKey(t)||pI(e,t)}))}function pI(e,t){e.oc.delete(t.path.canonicalString());var n=e.uc.get(t);null!==n&&(qb(e.remoteStore,n),e.uc=e.uc.remove(t),e.cc.delete(n),gI(e))}function yI(e,t,n){var r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;s instanceof Bx?(e.ac.addReference(s.key,t),mI(e,s)):s instanceof jx?(Qd("SyncEngine","Document no longer in limbo: "+s.key),e.ac.removeReference(s.key,t),e.ac.containsKey(s.key)||pI(e,s.key)):Zd()}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}function mI(e,t){var n=t.key,r=n.path.canonicalString();e.uc.get(n)||e.oc.has(r)||(Qd("SyncEngine","New document in limbo: "+n),e.oc.add(r),gI(e))}function gI(e){for(;e.oc.size>0&&e.uc.size<e.maxConcurrentLimboResolutions;){var t=e.oc.values().next().value;e.oc.delete(t);var n=new Iv(wv.fromString(t)),r=e.fc.next();e.cc.set(r,new zx(n)),e.uc=e.uc.insert(n,r),Ub(e.remoteStore,new ek(Ny(_y(n.path)),r,2,Yv.at))}}function kI(e,t,n){return wI.apply(this,arguments)}function wI(){return wI=e(u)(e(s).mark((function t(n,r,i){var a,o,c,l;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=ev(n),o=[],c=[],l=[],t.t0=a.ic.isEmpty(),t.t0){t.next=9;break}return a.ic.forEach((function(e,t){l.push(a._c(t,r,i).then((function(e){if((e||i)&&a.isPrimaryClient&&a.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){o.push(e);var n=jw.Ci(t.targetId,e);c.push(n)}})))})),t.next=6,Promise.all(l);case 6:return a.sc.Wo(o),t.next=9,function(){var t=e(u)(e(s).mark((function t(n,r){var i,a,o,u,c,l,h,f,d,v,p;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ev(n),e.prev=1,e.next=4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return Fv.forEach(r,(function(t){return Fv.forEach(t.Si,(function(n){return i.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return Fv.forEach(t.Di,(function(n){return i.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),jv(e.t0)){e.next=10;break}throw e.t0;case 10:Qd("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:for(a=!0,o=!1,u=void 0,e.prev=12,c=r[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)h=l.value,f=h.targetId,h.fromCache||(d=i.qi.get(f),v=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(v),i.qi=i.qi.insert(f,p));e.next=20;break;case 16:e.prev=16,e.t1=e.catch(12),o=!0,u=e.t1;case 20:e.prev=20,e.prev=21,a||null==c.return||c.return();case 23:if(e.prev=23,!o){e.next=26;break}throw u;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),t,null,[[1,6],[12,16,20,28],[21,,23,27]])})));return function(e,n){return t.apply(this,arguments)}}()(a.localStore,c);case 9:case"end":return t.stop()}}),t)}))),wI.apply(this,arguments)}function bI(e,t){return xI.apply(this,arguments)}function xI(){return(xI=e(u)(e(s).mark((function t(n,r){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=ev(n)).currentUser.isEqual(r)){e.next=11;break}return Qd("SyncEngine","User change. New user:",r.toKey()),e.next=5,Ww(i.localStore,r);case 5:return a=e.sent,i.currentUser=r,(t=i).lc.forEach((function(e){e.forEach((function(e){e.reject(new nv(tv.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.lc.clear(),i.sharedClientState.handleUserChange(r,a.removedBatchIds,a.addedBatchIds),e.next=11,kI(i,a.ji);case 11:case"end":return e.stop()}var t}),t)})))).apply(this,arguments)}function II(e,t){var n=ev(e),r=n.cc.get(t);if(r&&r.nc)return Pm().add(r.key);var i=Pm(),a=n.rc.get(t);if(!a)return i;var o=!0,u=!1,s=void 0;try{for(var c,l=a[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value,f=n.ic.get(h);i=i.unionWith(f.view.ju)}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return i}function _I(e,t){return TI.apply(this,arguments)}function TI(){return(TI=e(u)(e(s).mark((function t(n,r){var i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ev(n),e.next=3,nb(i.localStore,r.query,!0);case 3:return a=e.sent,o=r.view.tc(a),e.abrupt("return",(i.isPrimaryClient&&yI(i,r.targetId,o.Xu),o));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function EI(e,t){return SI.apply(this,arguments)}function SI(){return(SI=e(u)(e(s).mark((function t(n,r){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ev(n),e.abrupt("return",ib(i.localStore,r).then((function(e){return kI(i,e)})));case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function AI(e,t,n,r){return CI.apply(this,arguments)}function CI(){return(CI=e(u)(e(s).mark((function t(n,r,i,a){var o,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=ev(n),e.next=3,function(e,t){var n=ev(e),r=ev(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.Tn(e,t).next((function(t){return t?n.localDocuments.getDocuments(e,t):Fv.resolve(null)}))}))}(o.localStore,r);case 3:if(null===(u=e.sent)){e.next=15;break}if("pending"!==i){e.next=10;break}return e.next=8,nx(o.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===i||"rejected"===i?(dI(o,r,a||null),fI(o,r),t=o.localStore,s=r,ev(ev(t).mutationQueue).An(s)):Zd();case 11:return e.next=13,kI(o,u);case 13:e.next=16;break;case 15:Qd("SyncEngine","Cannot apply mutation batch with id: "+r);case 16:case"end":return e.stop()}var t,s}),t)})))).apply(this,arguments)}function NI(e,t){return DI.apply(this,arguments)}function DI(){return(DI=e(u)(e(s).mark((function t(n,r){var i,a,o,u,c,l,h,f,d,v,p;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qI(i=ev(n)),BI(i),!0!==r||!0===i.dc){e.next=28;break}return a=i.sharedClientState.getAllActiveQueryTargets(),e.next=5,RI(i,a.toArray());case 5:return o=e.sent,i.dc=!0,e.next=9,gx(i.remoteStore,!0);case 9:for(u=!0,c=!1,l=void 0,e.prev=10,h=o[Symbol.iterator]();!(u=(f=h.next()).done);u=!0)d=f.value,Ub(i.remoteStore,d);e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),c=!0,l=e.t0;case 18:e.prev=18,e.prev=19,u||null==h.return||h.return();case 21:if(e.prev=21,!c){e.next=24;break}throw l;case 24:return e.finish(21);case 25:return e.finish(18);case 26:e.next=40;break;case 28:if(!1!==r||!1===i.dc){e.next=40;break}return v=[],p=Promise.resolve(),i.rc.forEach((function(e,t){i.sharedClientState.isLocalQueryTarget(t)?v.push(t):p=p.then((function(){return vI(i,t),eb(i.localStore,t,!0)})),qb(i.remoteStore,t)})),e.next=34,p;case 34:return e.next=36,RI(i,v);case 36:return function(e){var t=ev(e);t.cc.forEach((function(e,n){qb(t.remoteStore,n)})),t.ac.fs(),t.cc=new Map,t.uc=new iy(Iv.comparator)}(i),i.dc=!1,e.next=40,gx(i.remoteStore,!1);case 40:case"end":return e.stop()}}),t,null,[[10,14,18,26],[19,,21,25]])})))).apply(this,arguments)}function RI(e,t,n){return OI.apply(this,arguments)}function OI(){return(OI=e(u)(e(s).mark((function t(n,r,i){var a,o,u,c,l,h,f,d,v,p,y,m,g,k,w,b,x,I,_,T;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=ev(n),o=[],u=[],c=!0,l=!1,h=void 0,e.prev=2,f=r[Symbol.iterator]();case 4:if(c=(d=f.next()).done){e.next=53;break}if(v=d.value,!(y=a.rc.get(v))||0===y.length){e.next=41;break}return e.next=11,$w(a.localStore,Ny(y[0]));case 11:p=e.sent,m=!0,g=!1,k=void 0,e.prev=13,w=y[Symbol.iterator]();case 15:if(m=(b=w.next()).done){e.next=25;break}return x=b.value,I=a.ic.get(x),e.next=20,_I(a,I);case 20:(_=e.sent).snapshot&&u.push(_.snapshot);case 22:m=!0,e.next=15;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(13),g=!0,k=e.t0;case 31:e.prev=31,e.prev=32,m||null==w.return||w.return();case 34:if(e.prev=34,!g){e.next=37;break}throw k;case 37:return e.finish(34);case 38:return e.finish(31);case 39:e.next=49;break;case 41:return e.next=43,rb(a.localStore,v);case 43:return T=e.sent,e.next=46,$w(a.localStore,T);case 46:return p=e.sent,e.next=49,Yx(a,PI(T),v,!1,p.resumeToken);case 49:o.push(p);case 50:c=!0,e.next=4;break;case 53:e.next=59;break;case 55:e.prev=55,e.t1=e.catch(2),l=!0,h=e.t1;case 59:e.prev=59,e.prev=60,c||null==f.return||f.return();case 62:if(e.prev=62,!l){e.next=65;break}throw h;case 65:return e.finish(62);case 66:return e.finish(59);case 67:return e.abrupt("return",(a.sc.Wo(u),o));case 68:case"end":return e.stop()}}),t,null,[[2,55,59,67],[13,27,31,39],[32,,34,38],[60,,62,66]])})))).apply(this,arguments)}function PI(e){return Iy(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function LI(e){var t=ev(e);return ev(ev(t.localStore).persistence).vi()}function MI(e,t,n,r){return FI.apply(this,arguments)}function FI(){return(FI=e(u)(e(s).mark((function t(n,r,i,a){var o,u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=ev(n)).dc){e.next=3;break}return e.abrupt("return",void Qd("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((u=o.rc.get(r))&&u.length>0)){e.next=20;break}e.t0=i,e.next="current"===e.t0||"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,ib(o.localStore,Fy(u[0]));case 10:return c=e.sent,l=Fm.createSynthesizedRemoteEventForCurrentChange(r,"current"===i,ap.EMPTY_BYTE_STRING),e.next=14,kI(o,c,l);case 14:return e.abrupt("break",20);case 15:return e.next=17,eb(o.localStore,r,!0);case 17:return vI(o,r,a),e.abrupt("break",20);case 19:Zd();case 20:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function VI(e,t,n){return UI.apply(this,arguments)}function UI(){return(UI=e(u)(e(s).mark((function t(n,r,i){var a,o,u,c,l,h,f,d,v,p,y,m,g,k,w;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=qI(n)).dc){e.next=62;break}o=!0,u=!1,c=void 0,e.prev=3,l=r[Symbol.iterator]();case 5:if(o=(h=l.next()).done){e.next=22;break}if(f=h.value,!a.rc.has(f)){e.next=10;break}return Qd("SyncEngine","Adding an already active target "+f),e.abrupt("continue",19);case 10:return e.next=12,rb(a.localStore,f);case 12:return d=e.sent,e.next=15,$w(a.localStore,d);case 15:return v=e.sent,e.next=18,Yx(a,PI(d),v.targetId,!1,v.resumeToken);case 18:Ub(a.remoteStore,v);case 19:o=!0,e.next=5;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(3),u=!0,c=e.t0;case 28:e.prev=28,e.prev=29,o||null==l.return||l.return();case 31:if(e.prev=31,!u){e.next=34;break}throw c;case 34:return e.finish(31);case 35:return e.finish(28);case 36:p=!0,y=!1,m=void 0,e.prev=37,g=i[Symbol.iterator]();case 39:if(p=(k=g.next()).done){e.next=48;break}if(w=k.value,e.t1=a.rc.has(w),!e.t1){e.next=45;break}return e.next=45,eb(a.localStore,w,!1).then((function(){qb(a.remoteStore,w),vI(a,w)})).catch(Lv);case 45:p=!0,e.next=39;break;case 48:e.next=54;break;case 50:e.prev=50,e.t2=e.catch(37),y=!0,m=e.t2;case 54:e.prev=54,e.prev=55,p||null==g.return||g.return();case 57:if(e.prev=57,!y){e.next=60;break}throw m;case 60:return e.finish(57);case 61:return e.finish(54);case 62:case"end":return e.stop()}}),t,null,[[3,24,28,36],[29,,31,35],[37,50,54,62],[55,,57,61]])})))).apply(this,arguments)}function qI(e){var t=ev(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=tI.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=II.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=iI.bind(null,t),t.sc.Wo=Ox.bind(null,t.eventManager),t.sc.wc=Px.bind(null,t.eventManager),t}function BI(e){var t=ev(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=oI.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=sI.bind(null,t),t}function jI(t,n,r){var i,a=ev(t);(i=e(u)(e(s).mark((function t(n,r,i){var a,o,u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.getMetadata();case 3:return a=e.sent,e.next=6,function(e,t){var n=ev(e),r=$m(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.Ns.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(n.localStore,a);case 6:if(!e.sent){e.next=11;break}return e.next=9,r.close();case 9:return i._completeWith({taskState:"Success",documentsLoaded:(t=a).totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}),e.abrupt("return",(e.sent,Promise.resolve(new Set)));case 11:return i._updateProgress(qx(a)),o=new Ux(a,n.localStore,r.yt),e.next=15,r.mc();case 15:u=e.sent;case 16:if(!u){e.next=26;break}return e.next=19,o.Fu(u);case 19:return(c=e.sent)&&i._updateProgress(c),e.next=23,r.mc();case 23:u=e.sent;case 24:e.next=16;break;case 26:return e.next=28,o.complete();case 28:return l=e.sent,e.next=31,kI(n,l.Lu,void 0);case 31:return e.next=33,function(e,t){var n=ev(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.Ns.saveBundleMetadata(e,t)}))}(n.localStore,a);case 33:return i._completeWith(l.progress),e.abrupt("return",(e.sent,e.sent,Promise.resolve(l.Bu)));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(Xd("SyncEngine","Loading bundle failed with ".concat(e.t0)),i._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}var t}),t,null,[[0,37]])}))),function(e,t,n){return i.apply(this,arguments)})(a,n,r).then((function(e){a.sharedClientState.notifyBundleLoaded(e)}))}var GI=function(){"use strict";function t(){e(E)(this,t),this.synchronizeTabs=!1}return e(S)(t,[{key:"initialize",value:function(t){var n=this;return e(u)(e(s).mark((function r(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.yt=Sb(t.databaseInfo.databaseId),n.sharedClientState=n.gc(t),n.persistence=n.yc(t),e.next=5,n.persistence.start();case 5:n.localStore=n.Ic(t),n.gcScheduler=n.Tc(t,n.localStore),n.indexBackfillerScheduler=n.Ec(t,n.localStore);case 8:case"end":return e.stop()}}),r)})))()}},{key:"Tc",value:function(e,t){return null}},{key:"Ec",value:function(e,t){return null}},{key:"Ic",value:function(e){return zw(this.persistence,new Gw,e.initialUser,this.yt)}},{key:"yc",value:function(e){return new Rw(Pw.Bs,this.yt)}},{key:"gc",value:function(e){return new kb}},{key:"terminate",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.gcScheduler&&t.gcScheduler.stop(),e.next=3,t.sharedClientState.shutdown();case 3:return e.next=5,t.persistence.shutdown();case 5:case"end":return e.stop()}}),n)})))()}}]),t}(),KI=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o;return e(E)(this,r),(o=n.call(this)).Ac=t,o.cacheSizeBytes=i,o.forceOwnership=a,o.synchronizeTabs=!1,e(Fc)(o)}return e(S)(r,[{key:"initialize",value:function(t){var n=this,i=this;return e(u)(e(s).mark((function a(){return e(s).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(fn)(e(pn)(r.prototype),"initialize",n).call(i,t);case 2:return a.next=4,i.Ac.initialize(i,t);case 4:return a.next=6,BI(i.Ac.syncEngine);case 6:return a.next=8,nx(i.Ac.remoteStore);case 8:return a.next=10,i.persistence.li((function(){return i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()}));case 10:case"end":return a.stop()}}),a)})))()}},{key:"Ic",value:function(e){return zw(this.persistence,new Gw,e.initialUser,this.yt)}},{key:"Tc",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new cw(n,e.asyncQueue,t)}},{key:"Ec",value:function(e,t){var n=new Qv(t,this.persistence);return new Hv(e.asyncQueue,n)}},{key:"yc",value:function(e){var t=Bw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Qk.withCacheSize(this.cacheSizeBytes):Qk.DEFAULT;return new Vw(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Tb(),Eb(),this.yt,this.sharedClientState,!!this.forceOwnership)}},{key:"gc",value:function(e){return new kb}}]),r}(GI),zI=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,t,i,!1)).Ac=t,a.cacheSizeBytes=i,a.synchronizeTabs=!0,e(Fc)(a)}return e(S)(r,[{key:"initialize",value:function(t){var n=this,i=this;return e(u)(e(s).mark((function a(){var o;return e(s).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(fn)(e(pn)(r.prototype),"initialize",n).call(i,t);case 2:if(o=i.Ac.syncEngine,a.t0=i.sharedClientState instanceof gb,!a.t0){a.next=8;break}return i.sharedClientState.syncEngine={Fr:AI.bind(null,o),$r:MI.bind(null,o),Br:VI.bind(null,o),vi:LI.bind(null,o),Mr:EI.bind(null,o)},a.next=8,i.sharedClientState.start();case 8:return a.next=10,i.persistence.li(function(){var t=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,NI(i.Ac.syncEngine,n);case 2:i.gcScheduler&&(n&&!i.gcScheduler.started?i.gcScheduler.start():n||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(n&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():n||i.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:case"end":return a.stop()}}),a)})))()}},{key:"gc",value:function(e){var t=Tb();if(!gb.C(t))throw new nv(tv.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Bw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new gb(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),r}(KI),WI=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,[{key:"initialize",value:function(t,n){var r=this;return e(u)(e(s).mark((function i(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r.localStore,e.t0){e.next=12;break}return r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=function(e){return rI(r.syncEngine,e,1)},r.remoteStore.remoteSyncer.handleCredentialChange=bI.bind(null,r.syncEngine),e.next=12,gx(r.remoteStore,r.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),i)})))()}},{key:"createEventManager",value:function(e){return new Ax}},{key:"createDatastore",value:function(e){var t,n,r,i=Sb(e.databaseInfo.databaseId),a=(t=e.databaseInfo,new _b(t));return n=e.authCredentials,r=e.appCheckCredentials,new Rb(n,r,a,i)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return rI(o.syncEngine,e,0)},a=bb.C()?new bb:new wb,new Pb(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,o){var u=new Wx(e,t,n,r,i,a);return o&&(u.dc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return(t=e(u)(e(s).mark((function t(n){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ev(n),Qd("RemoteStore","RemoteStore shutting down."),r._u.add(5),e.next=5,Fb(r);case 5:r.mu.shutdown(),r.gu.set("Unknown");case 7:case"end":return e.stop()}}),t)}))),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function HI(e,t,n){if(!n)throw new nv(tv.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function QI(e,t,n,r){if(!0===t&&!0===r)throw new nv(tv.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function YI(e){if(!Iv.isDocumentKey(e))throw new nv(tv.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function XI(e){if(Iv.isDocumentKey(e))throw new nv(tv.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function JI(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":Zd()}function ZI(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new nv(tv.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=JI(e);throw new nv(tv.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function $I(e,t){if(t<=0)throw new nv(tv.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var e_=new Map,t_=function(){"use strict";function t(n){var r;if(e(E)(this,t),void 0===n.host){if(void 0!==n.ssl)throw new nv(tv.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=n.host,this.ssl=null===(r=n.ssl)||void 0===r||r;if(this.credentials=n.credentials,this.ignoreUndefinedProperties=!!n.ignoreUndefinedProperties,void 0===n.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new nv(tv.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=n.cacheSizeBytes}this.experimentalForceLongPolling=!!n.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!n.experimentalAutoDetectLongPolling,this.useFetchStreams=!!n.useFetchStreams,QI("experimentalForceLongPolling",n.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",n.experimentalAutoDetectLongPolling)}return e(S)(t,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),t}(),n_=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this._authCredentials=n,this._appCheckCredentials=r,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new t_({}),this._settingsFrozen=!1}return e(S)(t,[{key:"app",get:function(){if(!this._app)throw new nv(tv.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new nv(tv.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new t_(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new av;switch(e.type){case"gapi":var t=e.client;return new cv(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new nv(tv.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=e_.get(e))&&(Qd("ComponentProvider","Removing Datastore"),e_.delete(e),t.terminate()),Promise.resolve();var e,t}}]),t}();function r_(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=ZI(e,n_))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&Xd("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,u;if("string"==typeof i.mockUserToken)o=i.mockUserToken,u=Kd.MOCK_USER;else{o=fe(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new nv(tv.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Kd(s)}e._authCredentials=new ov(new iv(o,u))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var i_=function(){"use strict";function t(n,r,i){e(E)(this,t),this.converter=r,this._key=i,this.type="document",this.firestore=n}return e(S)(t,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new o_(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(e){return new t(this.firestore,e,this._key)}}]),t}(),a_=function(){"use strict";function t(n,r,i){e(E)(this,t),this.converter=r,this._query=i,this.type="query",this.firestore=n}return e(S)(t,[{key:"withConverter",value:function(e){return new t(this.firestore,e,this._query)}}]),t}(),o_=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o;return e(E)(this,r),(o=n.call(this,t,i,_y(a)))._path=a,o.type="collection",e(Fc)(o)}return e(S)(r,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new i_(this.firestore,null,new Iv(e))}},{key:"withConverter",value:function(e){return new r(this.firestore,e,this._path)}}]),r}(a_);function u_(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(t=Oe(t),HI("collection","path",n),t instanceof n_){var o,u=(o=wv).fromString.apply(o,[n].concat(e(R)(i)));return XI(u),new o_(t,null,u)}var s;if(!(t instanceof i_||t instanceof o_))throw new nv(tv.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=t._path.child((s=wv).fromString.apply(s,[n].concat(e(R)(i))));return XI(c),new o_(t.firestore,null,c)}function s_(e,t){if(e=ZI(e,n_),HI("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new nv(tv.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new a_(e,null,(n=t,new xy(wv.emptyPath(),n)));var n}function c_(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(t=Oe(t),1===arguments.length&&(n=dv.R()),HI("doc","path",n),t instanceof n_){var o,u=(o=wv).fromString.apply(o,[n].concat(e(R)(i)));return YI(u),new i_(t,null,new Iv(u))}var s;if(!(t instanceof i_||t instanceof o_))throw new nv(tv.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=t._path.child((s=wv).fromString.apply(s,[n].concat(e(R)(i))));return YI(c),new i_(t.firestore,t instanceof o_?t.converter:null,new Iv(c))}function l_(e,t){return e=Oe(e),t=Oe(t),(e instanceof i_||e instanceof o_)&&(t instanceof i_||t instanceof o_)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function h_(e,t){return e=Oe(e),t=Oe(t),e instanceof a_&&t instanceof a_&&e.firestore===t.firestore&&Oy(e._query,t._query)&&e.converter===t.converter
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}function f_(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,r=0;return{read:function(){return e(u)(e(s).mark((function i(){var a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r<t.byteLength)){e.next=3;break}return a={value:t.slice(r,r+n),done:!1},e.abrupt("return",(r+=n,a));case 3:return e.abrupt("return",{done:!0});case 4:case"end":return e.stop()}}),i)})))()},cancel:function(){return e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)})))()},releaseLock:function(){},closed:Promise.reject("unimplemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var d_=function(){"use strict";function t(n){e(E)(this,t),this.observer=n,this.muted=!1}return e(S)(t,[{key:"next",value:function(e){this.observer.next&&this.Rc(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Rc(this.observer.error,e):Yd("Uncaught Error in snapshot listener:",e.toString())}},{key:"bc",value:function(){this.muted=!0}},{key:"Rc",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),t}(),v_=function(){"use strict";function t(n,r){var i=this;e(E)(this,t),this.Pc=n,this.yt=r,this.metadata=new rv,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then((function(e){e&&e.Ou()?i.metadata.resolve(e.ku.metadata):i.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.ku))))}),(function(e){return i.metadata.reject(e)}))}return e(S)(t,[{key:"close",value:function(){return this.Pc.cancel()}},{key:"getMetadata",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.metadata.promise);case 1:case"end":return e.stop()}}),n)})))()}},{key:"mc",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMetadata();case 2:return e.abrupt("return",(e.sent,t.Vc()));case 3:case"end":return e.stop()}}),n)})))()}},{key:"Vc",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.Sc();case 2:if(null!==(r=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return i=t.vc.decode(r),a=Number(i),isNaN(a)&&t.Dc("length string (".concat(i,") is not valid number")),e.next=9,t.Cc(a);case 9:return o=e.sent,e.abrupt("return",new Fx(JSON.parse(o),r.length+a));case 11:case"end":return e.stop()}}),n)})))()}},{key:"xc",value:function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))}},{key:"Sc",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.xc()<0)){e.next=7;break}return e.next=3,t.Nc();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==t.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(r=t.xc())<0&&t.Dc("Reached the end of bundle when a length string is expected."),i=t.buffer.slice(0,r),e.abrupt("return",(t.buffer=t.buffer.slice(r),i));case 13:case"end":return e.stop()}}),n)})))()}},{key:"Cc",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.buffer.length<t)){e.next=8;break}return e.next=3,n.Nc();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}n.Dc("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return i=n.vc.decode(n.buffer.slice(0,t)),e.abrupt("return",(n.buffer=n.buffer.slice(t),i));case 10:case"end":return e.stop()}}),r)})))()}},{key:"Dc",value:function(e){throw this.Pc.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"Nc",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.Pc.read();case 2:return(r=e.sent).done||((i=new Uint8Array(t.buffer.length+r.value.length)).set(t.buffer),i.set(r.value,t.buffer.length),t.buffer=i),e.abrupt("return",r.done);case 5:case"end":return e.stop()}}),n)})))()}}]),t}(),p_=function(){"use strict";function t(n){e(E)(this,t),this.datastore=n,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e(S)(t,[{key:"lookup",value:function(t){var n=this;return e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.ensureCommitNotCalled(),!(n.mutations.length>0)){r.next=2;break}throw new nv(tv.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return r.next=4,function(){var t=e(u)(e(s).mark((function t(n,r){var i,a,o,u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ev(n),a=og(i.yt)+"/documents",o={documents:r.map((function(e){return ng(i.yt,e)}))},e.next=5,i._o("BatchGetDocuments",a,o,r.length);case 5:return u=e.sent,c=new Map,u.forEach((function(e){var t,n,r=(t=i.yt,"found"in(n=e)?function(e,t){$d(!!t.found),t.found.name,t.found.updateTime;var n=rg(e,t.found.name),r=$m(t.found.updateTime),i=t.found.createTime?$m(t.found.createTime):gv.min(),a=new hy({mapValue:{fields:t.found.fields}});return dy.newFoundDocument(n,r,i,a)}(t,n):"missing"in n?function(e,t){$d(!!t.missing),$d(!!t.readTime);var n=rg(e,t.missing),r=$m(t.readTime);return dy.newNoDocument(n,r)}(t,n):Zd());c.set(r.key.toString(),r)})),l=[],e.abrupt("return",(r.forEach((function(e){var t=c.get(e.toString());$d(!!t),l.push(t)})),l));case 10:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(n.datastore,t);case 4:return i=r.sent,r.abrupt("return",(i.forEach((function(e){return n.recordVersion(e)})),i));case 6:case"end":return r.stop()}}),r)})))()}},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new gm(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ensureCommitNotCalled(),!t.lastWriteError){n.next=2;break}throw t.lastWriteError;case 2:return r=t.readVersions,t.mutations.forEach((function(e){r.delete(e.key.toString())})),r.forEach((function(e,n){var r=Iv.fromPath(n);t.mutations.push(new km(r,t.precondition(r)))})),n.next=7,function(){var t=e(u)(e(s).mark((function t(n,r){var i,a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ev(n),a=og(i.yt)+"/documents",o={writes:r.map((function(e){return lg(i.yt,e)}))},e.next=3,i.ao("Commit",a,o);case 3:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(t.datastore,t.mutations);case 7:t.committed=!0;case 8:case"end":return n.stop()}}),n)})))()}},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Zd();t=gv.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new nv(tv.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(gv.min())?rm.exists(!1):rm.updateTime(t):rm.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(gv.min()))throw new nv(tv.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rm.updateTime(t)}return rm.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),t}(),y_=function(){"use strict";function t(n,r,i,a,o){e(E)(this,t),this.asyncQueue=n,this.datastore=r,this.options=i,this.updateFunction=a,this.deferred=o,this.kc=i.maxAttempts,this.xo=new Ab(this.asyncQueue,"transaction_retry")}return e(S)(t,[{key:"run",value:function(){this.kc-=1,this.Oc()}},{key:"Oc",value:function(){var t=this;this.xo.Ro(e(u)(e(s).mark((function n(){var r,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new p_(t.datastore),(i=t.Mc(r))&&i.then((function(e){t.asyncQueue.enqueueAndForget((function(){return r.commit().then((function(){t.deferred.resolve(e)})).catch((function(e){t.Fc(e)}))}))})).catch((function(e){t.Fc(e)}));case 2:case"end":return e.stop()}}),n)}))))}},{key:"Mc",value:function(e){try{var t=this.updateFunction(e);return!tp(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Fc",value:function(e){var t=this;this.kc>0&&this.$c(e)?(this.kc-=1,this.asyncQueue.enqueueAndForget((function(){return t.Oc(),Promise.resolve()}))):this.deferred.reject(e)}},{key:"$c",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!bm(t)}return!1}}]),t}(),m_=function(){"use strict";function t(n,r,i,a){var o=this;e(E)(this,t);var c,l=this;this.authCredentials=n,this.appCheckCredentials=r,this.asyncQueue=i,this.databaseInfo=a,this.user=Kd.UNAUTHENTICATED,this.clientId=dv.R(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(i,(c=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Qd("FirestoreClient","Received user=",n.uid),e.next=3,l.authCredentialListener(n);case 3:l.user=n;case 4:case"end":return e.stop()}}),t)}))),function(e){return c.apply(this,arguments)})),this.appCheckCredentials.start(i,(function(e){return Qd("FirestoreClient","Received new app check token=",e),o.appCheckCredentialListener(e,o.user)}))}return e(S)(t,[{key:"getConfiguration",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),n)})))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new nv(tv.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){this.asyncQueue.enterRestrictedMode();var t=new rv,n=this;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(e(u)(e(s).mark((function r(){var i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=n.onlineComponents,!e.t0){e.next=5;break}return e.next=5,n.onlineComponents.terminate();case 5:if(e.t1=n.offlineComponents,!e.t1){e.next=9;break}return e.next=9,n.offlineComponents.terminate();case 9:n.authCredentials.shutdown(),n.appCheckCredentials.shutdown(),t.resolve(),e.next=18;break;case 14:e.prev=14,e.t2=e.catch(0),i=Ix(e.t2,"Failed to shutdown persistence"),t.reject(i);case 18:case"end":return e.stop()}}),r,null,[[0,14]])})))),t.promise}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(e,t){return k_.apply(this,arguments)}function k_(){return k_=e(u)(e(s).mark((function t(n,r){var i,a;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.asyncQueue.verifyOperationInProgress(),Qd("FirestoreClient","Initializing OfflineComponentProvider"),t.next=3,n.getConfiguration();case 3:return i=t.sent,t.next=6,r.initialize(i);case 6:a=i.initialUser,n.setCredentialChangeListener(function(){var t=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.isEqual(n),e.t0){e.next=5;break}return e.next=4,Ww(r.localStore,n);case 4:a=n;case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.persistence.setDatabaseDeletedListener((function(){return n.terminate()})),n.offlineComponents=r;case 8:case"end":return t.stop()}}),t)}))),k_.apply(this,arguments)}function w_(e,t){return b_.apply(this,arguments)}function b_(){return(b_=e(u)(e(s).mark((function t(n,r){var i,a;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.asyncQueue.verifyOperationInProgress(),e.next=3,x_(n);case 3:return i=e.sent,Qd("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,n.getConfiguration();case 7:return a=e.sent,e.next=10,r.initialize(i,a);case 10:n.setCredentialChangeListener((function(e){return yx(r.remoteStore,e)})),n.setAppCheckTokenChangeListener((function(e,t){return yx(r.remoteStore,t)})),n.onlineComponents=r;case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function x_(e){return I_.apply(this,arguments)}function I_(){return(I_=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.offlineComponents,e.t0){e.next=5;break}return Qd("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,g_(n,new GI);case 5:return e.abrupt("return",(e.t0||e.sent,n.offlineComponents));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function __(e){return T_.apply(this,arguments)}function T_(){return(T_=e(u)(e(s).mark((function t(n){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.onlineComponents,e.t0){e.next=5;break}return Qd("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,w_(n,new WI);case 5:return e.abrupt("return",(e.t0||e.sent,n.onlineComponents));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function E_(e){return x_(e).then((function(e){return e.persistence}))}function S_(e){return x_(e).then((function(e){return e.localStore}))}function A_(e){return __(e).then((function(e){return e.remoteStore}))}function C_(e){return __(e).then((function(e){return e.syncEngine}))}function N_(e){return __(e).then((function(e){return e.datastore}))}function D_(e){return R_.apply(this,arguments)}function R_(){return(R_=e(u)(e(s).mark((function t(n){var r,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,__(n);case 2:return r=e.sent,i=r.eventManager,e.abrupt("return",(i.onListen=Hx.bind(null,r.syncEngine),i.onUnlisten=Jx.bind(null,r.syncEngine),i));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function O_(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new rv;return t.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function a(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n,r,i){var a=new d_({next:function(a){t.enqueueAndForget((function(){return Dx(e,o)}));var u=a.docs.has(n);!u&&a.fromCache?i.reject(new nv(tv.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&a.fromCache&&r&&"server"===r.source?i.reject(new nv(tv.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new Mx(_y(n.path),a,{includeMetadataChanges:!0,Nu:!0});return Cx(e,o)},e.next=3,D_(t);case 3:return e.t1=e.sent,e.t2=t.asyncQueue,e.t3=n,e.t4=r,e.t5=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4,e.t5));case 9:case"end":return e.stop()}}),a)})))),i.promise}function P_(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new rv;return t.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function a(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n,r,i){var a=new d_({next:function(n){t.enqueueAndForget((function(){return Dx(e,o)})),n.fromCache&&"server"===r.source?i.reject(new nv(tv.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new Mx(n,a,{includeMetadataChanges:!0,Nu:!0});return Cx(e,o)},e.next=3,D_(t);case 3:return e.t1=e.sent,e.t2=t.asyncQueue,e.t3=n,e.t4=r,e.t5=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4,e.t5));case 9:case"end":return e.stop()}}),a)})))),i.promise}var L_=function(){"use strict";function t(){var n=this;e(E)(this,t),this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new Ab(this,"async_queue_retry"),this.Wc=function(){var e=Eb();e&&Qd("AsyncQueue","Visibility state changed to "+e.visibilityState),n.xo.Po()};var r=Eb();r&&"function"==typeof r.addEventListener&&r.addEventListener("visibilitychange",this.Wc)}return e(S)(t,[{key:"isShuttingDown",get:function(){return this.qc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.zc(),this.Hc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;var t=Eb();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}},{key:"enqueue",value:function(e){var t=this;if(this.zc(),this.qc)return new Promise((function(){}));var n=new rv;return this.Hc((function(){return t.qc&&t.Qc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Lc.push(e),t.Jc()}))}},{key:"Jc",value:function(){var t=this;return e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===t.Lc.length){e.next=14;break}return e.prev=1,e.next=4,t.Lc[0]();case 4:t.Lc.shift(),t.xo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),jv(e.t0)){e.next=12;break}throw e.t0;case 12:Qd("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:t.Lc.length>0&&t.xo.Ro((function(){return t.Jc()}));case 14:case"end":return e.stop()}}),n,null,[[1,8]])})))()}},{key:"Hc",value:function(e){var t=this,n=this.Bc.then((function(){return t.Gc=!0,e().catch((function(e){var n,r;throw t.Kc=e,t.Gc=!1,Yd("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e})).then((function(e){return t.Gc=!1,e}))}));return this.Bc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.zc(),this.jc.indexOf(e)>-1&&(t=0);var i=xx.createAndSchedule(this,e,t,n,(function(e){return r.Yc(e)}));return this.Uc.push(i),i}},{key:"zc",value:function(){this.Kc&&Zd()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Xc",value:function(){var t=this;return e(u)(e(s).mark((function n(){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:return r=t.Bc,e.next=4,r;case 4:if(r!==t.Bc){e.next=1;break}case 5:case"end":return e.stop()}}),n)})))()}},{key:"Zc",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.Uc[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.timerId===e)return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"ta",value:function(e){var t=this;return this.Xc().then((function(){t.Uc.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n=!0,r=!1,i=void 0;try{for(var a,o=t.Uc[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(u.skipDelay(),"all"!==e&&u.timerId===e)break}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t.Xc()}))}},{key:"ea",value:function(e){this.jc.push(e)}},{key:"Yc",value:function(e){var t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}]),t}();function M_(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n=e,r=!0,i=!1,a=void 0;try{for(var o,u=["next","error","complete"][Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(s in n&&"function"==typeof n[s])return!0}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return!1}(e)}var F_=function(){"use strict";function t(){e(E)(this,t),this._progressObserver={},this._taskCompletionResolver=new rv,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return e(S)(t,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),t}(),V_=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a,o){var u;return e(E)(this,r),(u=n.call(this,t,i,a,o)).type="firestore",u._queue=new L_,u._persistenceKey=(null==o?void 0:o.name)||"[DEFAULT]",e(Fc)(u)}return e(S)(r,[{key:"_terminate",value:function(){return this._firestoreClient||q_(this),this._firestoreClient.terminate()}}]),r}(n_);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U_(e){return e._firestoreClient||q_(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function q_(e){var t,n,r,i,a,o=e._freezeSettings(),u=(n=e._databaseId,r=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",i=e._persistenceKey,new Xv(n,r,i,(a=o).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));e._firestoreClient=new m_(e._authCredentials,e._appCheckCredentials,e._queue,u)}function B_(e,t){Y_(e=ZI(e,V_));var n=U_(e),r=e._freezeSettings(),i=new WI;return G_(n,i,new KI(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function j_(e){Y_(e=ZI(e,V_));var t=U_(e),n=e._freezeSettings(),r=new WI;return G_(t,r,new zI(r,n.cacheSizeBytes))}function G_(t,n,r){var i=new rv;return t.asyncQueue.enqueue(e(u)(e(s).mark((function a(){var o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g_(t,r);case 3:return e.next=5,w_(t,n);case 5:i.resolve(),e.next=14;break;case 8:if(e.prev=8,e.t0=e.catch(0),o=e.t0,"FirebaseError"===(a=o).name?a.code===tv.FAILED_PRECONDITION||a.code===tv.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&a instanceof DOMException)||22===a.code||20===a.code||11===a.code){e.next=13;break}throw o;case 13:Xd("Error enabling offline persistence. Falling back to persistence disabled: "+o),i.reject(o);case 14:case"end":return e.stop()}var a}),a,null,[[0,8]])})))).then((function(){return i.promise}))}function K_(t){if(t._initialized&&!t._terminated)throw new nv(tv.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new rv;return t._queue.enqueueAndForgetEvenWhileRestricted(e(u)(e(s).mark((function r(){return e(s).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,function(){var t=e(u)(e(s).mark((function t(n){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Uv.C()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return r=n+"main",e.next=5,Uv.delete(r);case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(Bw(t._databaseId,t._persistenceKey));case 3:n.resolve(),r.next=9;break;case 6:r.prev=6,r.t0=r.catch(0),n.reject(r.t0);case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))),n.promise}function z_(t){return(n=U_(t=ZI(t,V_))).asyncQueue.enqueue(e(u)(e(s).mark((function t(){var r,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E_(n);case 2:return r=e.sent,e.next=5,A_(n);case 5:return i=e.sent,e.abrupt("return",(r.setNetworkEnabled(!0),t=void 0,(t=ev(i))._u.delete(0),Lb(t)));case 7:case"end":return e.stop()}var t}),t)}))));var n}function W_(t){return(n=U_(t=ZI(t,V_))).asyncQueue.enqueue(e(u)(e(s).mark((function t(){var r,i;return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E_(n);case 2:return r=t.sent,t.next=5,A_(n);case 5:return i=t.sent,t.abrupt("return",(r.setNetworkEnabled(!1),function(){var t=e(u)(e(s).mark((function t(n){var r;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=ev(n))._u.add(0),e.next=4,Fb(r);case 4:r.gu.set("Offline");case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(i)));case 7:case"end":return t.stop()}}),t)}))));var n}function H_(t,n){var r=U_(t=ZI(t,V_)),i=new F_;return function(t,n,r,i){var a,o,c,l,h=(a=r,o=Sb(n),c="string"==typeof a?(new TextEncoder).encode(a):a,l=function(e,t){if(e instanceof Uint8Array)return f_(e,t);if(e instanceof ArrayBuffer)return f_(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),new v_(l,o));t.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=jI,e.next=3,C_(t);case 3:e.t1=e.sent,e.t2=h,e.t3=i,(0,e.t0)(e.t1,e.t2,e.t3);case 7:case"end":return e.stop()}}),n)}))))}(r,t._databaseId,n,i),i}function Q_(t,n){return(r=U_(t=ZI(t,V_)),i=n,r.asyncQueue.enqueue(e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t){var n=ev(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.Ns.getNamedQuery(e,t)}))},e.next=3,S_(r);case 3:return e.t1=e.sent,e.t2=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)}))))).then((function(e){return e?new a_(t,null,e.query):null}));var r,i}function Y_(e){if(e._initialized||e._terminated)throw new nv(tv.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var X_=function(){"use strict";function t(n){e(E)(this,t),this._byteString=n}return e(S)(t,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(e){try{return new t(ap.fromBase64String(e))}catch(e){throw new nv(tv.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}},{key:"fromUint8Array",value:function(e){return new t(ap.fromUint8Array(e))}}]),t}(),J_=function(){"use strict";function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e(E)(this,t);for(var a=0;a<r.length;++a)if(0===r[a].length)throw new nv(tv.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xv(r)}return e(S)(t,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Z_=function t(n){"use strict";e(E)(this,t),this._methodName=n},$_=function(){"use strict";function t(n,r){if(e(E)(this,t),!isFinite(n)||n<-90||n>90)throw new nv(tv.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+n);if(!isFinite(r)||r<-180||r>180)throw new nv(tv.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=n,this._long=r}return e(S)(t,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return vv(this._lat,e._lat)||vv(this._long,e._long)}}]),t}(),eT=/^__.*__$/,tT=function(){"use strict";function t(n,r,i){e(E)(this,t),this.data=n,this.fieldMask=r,this.fieldTransforms=i}return e(S)(t,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new fm(e,this.data,this.fieldMask,t,this.fieldTransforms):new hm(e,this.data,t,this.fieldTransforms)}}]),t}(),nT=function(){"use strict";function t(n,r,i){e(E)(this,t),this.data=n,this.fieldMask=r,this.fieldTransforms=i}return e(S)(t,[{key:"toMutation",value:function(e,t){return new fm(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Zd()}}var iT=function(){"use strict";function t(n,r,i,a,o,u){e(E)(this,t),this.settings=n,this.databaseId=r,this.yt=i,this.ignoreUndefinedProperties=a,void 0===o&&this.na(),this.fieldTransforms=o||[],this.fieldMask=u||[]}return e(S)(t,[{key:"path",get:function(){return this.settings.path}},{key:"sa",get:function(){return this.settings.sa}},{key:"ia",value:function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ra",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.ua(e),r}},{key:"ca",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.na(),r}},{key:"aa",value:function(e){return this.ia({path:void 0,oa:!0})}},{key:"ha",value:function(e){return _T(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"na",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.ua(this.path.get(e))}},{key:"ua",value:function(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(rT(this.sa)&&eT.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}]),t}(),aT=function(){"use strict";function t(n,r,i){e(E)(this,t),this.databaseId=n,this.ignoreUndefinedProperties=r,this.yt=i||Sb(n)}return e(S)(t,[{key:"da",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new iT({sa:e,methodName:t,fa:n,path:xv.emptyPath(),oa:!1,la:r},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}]),t}();function oT(e){var t=e._freezeSettings(),n=Sb(e._databaseId);return new aT(e._databaseId,!!t.ignoreUndefinedProperties,n)}function uT(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.da(a.merge||a.mergeFields?2:0,t,n,i);wT("Data must be an object, but it was:",o,r);var u,s,c=gT(r,o);if(a.merge)u=new ly(o.fieldMask),s=o.fieldTransforms;else if(a.mergeFields){var l=[],h=!0,f=!1,d=void 0;try{for(var v,p=a.mergeFields[Symbol.iterator]();!(h=(v=p.next()).done);h=!0){var y=v.value,m=bT(t,y,n);if(!o.contains(m))throw new nv(tv.INVALID_ARGUMENT,"Field '".concat(m,"' is specified in your field mask but missing from your input data."));TT(l,m)||l.push(m)}}catch(e){f=!0,d=e}finally{try{h||null==p.return||p.return()}finally{if(f)throw d}}u=new ly(l),s=o.fieldTransforms.filter((function(e){return u.covers(e.field)}))}else u=null,s=o.fieldTransforms;return new tT(new hy(c),u,s)}var sT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.apply(this,arguments)}return e(S)(r,[{key:"_toFieldTransform",value:function(e){if(2!==e.sa)throw 1===e.sa?e.ha("".concat(this._methodName,"() can only appear at the top level of your update data")):e.ha("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof r}}]),r}(Z_);function cT(e,t,n){return new iT({sa:3,fa:t.settings.fa,methodName:e._methodName,oa:n},t.databaseId,t.yt,t.ignoreUndefinedProperties)}var lT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.apply(this,arguments)}return e(S)(r,[{key:"_toFieldTransform",value:function(e){return new tm(e.path,new Hy)}},{key:"isEqual",value:function(e){return e instanceof r}}]),r}(Z_),hT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,t))._a=i,e(Fc)(a)}return e(S)(r,[{key:"_toFieldTransform",value:function(e){var t=cT(this,e,!0),n=this._a.map((function(e){return mT(e,t)})),r=new Qy(n);return new tm(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),r}(Z_),fT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,t))._a=i,e(Fc)(a)}return e(S)(r,[{key:"_toFieldTransform",value:function(e){var t=cT(this,e,!0),n=this._a.map((function(e){return mT(e,t)})),r=new Xy(n);return new tm(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),r}(Z_),dT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,t)).wa=i,e(Fc)(a)}return e(S)(r,[{key:"_toFieldTransform",value:function(e){var t=new Zy(e.yt,jy(e.yt,this.wa));return new tm(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),r}(Z_);function vT(e,t,n,r){var i=e.da(1,t,n);wT("Data must be an object, but it was:",i,r);var a=[],o=hy.empty();$v(r,(function(e,r){var u=IT(t,e,n);r=Oe(r);var s=i.ca(u);if(r instanceof sT)a.push(u);else{var c=mT(r,s);null!=c&&(a.push(u),o.set(u,c))}}));var u=new ly(a);return new nT(o,u,i.fieldTransforms)}function pT(e,t,n,r,i,a){var o=e.da(1,t,n),u=[bT(t,r,n)],s=[i];if(a.length%2!=0)throw new nv(tv.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)u.push(bT(t,a[c])),s.push(a[c+1]);for(var l=[],h=hy.empty(),f=u.length-1;f>=0;--f)if(!TT(l,u[f])){var d=u[f],v=s[f];v=Oe(v);var p=o.ca(d);if(v instanceof sT)l.push(d);else{var y=mT(v,p);null!=y&&(l.push(d),h.set(d,y))}}var m=new ly(l);return new nT(h,m,o.fieldTransforms)}function yT(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return mT(n,e.da(r?4:3,t))}function mT(e,t){if(kT(e=Oe(e)))return wT("Unsupported field value:",t,e),gT(e,t);if(e instanceof Z_)return function(e,t){if(!rT(t.sa))throw t.ha("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.ha("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,t){var n=[],r=0,i=!0,a=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=mT(u.value,t.aa(r));null==c&&(c={nullValue:"NULL_VALUE"}),n.push(c),r++}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Oe(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return jy(t.yt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=mv.fromDate(e);return{timestampValue:Xm(t.yt,n)}}if(e instanceof mv){var r=new mv(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Xm(t.yt,r)}}if(e instanceof $_)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof X_)return{bytesValue:Jm(t.yt,e._byteString)};if(e instanceof i_){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.ha("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:eg(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.ha("Unsupported field value: ".concat(JI(e)))}(e,t)}function gT(e,t){var n={};return ep(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):$v(e,(function(e,r){var i=mT(r,t.ra(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function kT(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof mv||e instanceof $_||e instanceof X_||e instanceof i_||e instanceof Z_)}function wT(e,t,n){if(!kT(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=JI(n);throw"an object"===r?t.ha(e+" a custom object"):t.ha(e+" "+r)}var i}function bT(e,t,n){if((t=Oe(t))instanceof J_)return t._internalPath;if("string"==typeof t)return IT(e,t);throw _T("Field path arguments must be of type string or ",e,!1,void 0,n)}var xT=new RegExp("[~\\*/\\[\\]]");function IT(t,n,r){if(n.search(xT)>=0)throw _T("Invalid field path (".concat(n,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,r);try{return e(Mc)(J_,e(R)(n.split(".")))._internalPath}catch(e){throw _T("Invalid field path (".concat(n,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,r)}}function _T(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,u="Function ".concat(t,"() called with invalid data");n&&(u+=" (via `toFirestore()`)"),u+=". ";var s="";return(a||o)&&(s+=" (found",a&&(s+=" in field ".concat(r)),o&&(s+=" in document ".concat(i)),s+=")"),new nv(tv.INVALID_ARGUMENT,u+e+s)}function TT(e,t){return e.some((function(e){return e.isEqual(t)}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ET=function(){"use strict";function t(n,r,i,a,o){e(E)(this,t),this._firestore=n,this._userDataWriter=r,this._key=i,this._document=a,this._converter=o}return e(S)(t,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new i_(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new ST(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(AT("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),t}(),ST=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.apply(this,arguments)}return e(S)(r,[{key:"data",value:function(){return e(fn)(e(pn)(r.prototype),"data",this).call(this)}}]),r}(ET);function AT(e,t){return"string"==typeof t?IT(e,t):t instanceof J_?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CT(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new nv(tv.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var NT=function t(){"use strict";e(E)(this,t)},DT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.apply(this,arguments)}return r}(NT);function RT(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var a=[];t instanceof NT&&a.push(t),function(e){var t=e.filter((function(e){return e instanceof LT})).length,n=e.filter((function(e){return e instanceof OT})).length;if(t>1||t>0&&n>0)throw new nv(tv.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a=a.concat(r));var o=!0,u=!1,s=void 0;try{for(var c,l=a[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;e=h._apply(e)}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return e}var OT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o;return e(E)(this,r),(o=n.call(this))._field=t,o._op=i,o._value=a,o.type="where",e(Fc)(o)}return e(S)(r,[{key:"_apply",value:function(e){var t=this._parse(e);return QT(e._query,t),new a_(e.firestore,e.converter,Dy(e._query,t))}},{key:"_parse",value:function(e){var t=oT(e.firestore);return function(e,t,n,r,i,a,o){var u;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new nv(tv.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){HT(o,a);var s=[],c=!0,l=!1,h=void 0;try{for(var f,d=o[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value;s.push(WT(r,e,v))}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}u={arrayValue:{values:s}}}else u=WT(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||HT(o,a),u=yT(n,"where",o,"in"===a||"not-in"===a);return Vp.create(i,a,u)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}],[{key:"_create",value:function(e,t,n){return new r(e,t,n)}}]),r}(DT);function PT(e,t,n){var r=t,i=AT("where",e);return OT._create(i,r,n)}var LT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this)).type=t,a._queryConstraints=i,e(Fc)(a)}return e(S)(r,[{key:"_parse",value:function(e){var t=this._queryConstraints.map((function(t){return t._parse(e)})).filter((function(e){return e.getFilters().length>0}));return 1===t.length?t[0]:Up.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n=e,r=t.getFlattenedFilters(),i=!0,a=!1,o=void 0;try{for(var u,s=r[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;QT(n,c),n=Dy(n,c)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}(e._query,t),new a_(e.firestore,e.converter,Dy(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,t){return new r(e,t)}}]),r}(NT);var MT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this))._field=t,a._direction=i,a.type="orderBy",e(Fc)(a)}return e(S)(r,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new nv(tv.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new nv(tv.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ny(t,n);return function(e,t){if(null===Ey(e)){var n=Sy(e);null!==n&&YT(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new a_(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new xy(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}],[{key:"_create",value:function(e,t){return new r(e,t)}}]),r}(DT);function FT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=AT("orderBy",e);return MT._create(r,n)}var VT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o;return e(E)(this,r),(o=n.call(this)).type=t,o._limit=i,o._limitType=a,e(Fc)(o)}return e(S)(r,[{key:"_apply",value:function(e){return new a_(e.firestore,e.converter,Ry(e._query,this._limit,this._limitType))}}],[{key:"_create",value:function(e,t,n){return new r(e,t,n)}}]),r}(DT);var UT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o;return e(E)(this,r),(o=n.call(this)).type=t,o._docOrFields=i,o._inclusive=a,e(Fc)(o)}return e(S)(r,[{key:"_apply",value:function(e){var t,n,r=zT(e,this.type,this._docOrFields,this._inclusive);return new a_(e.firestore,e.converter,(t=e._query,n=r,new xy(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,n,t.endAt)))}}],[{key:"_create",value:function(e,t,n){return new r(e,t,n)}}]),r}(DT);function qT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return UT._create("startAt",t,!0)}function BT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return UT._create("startAfter",t,!1)}var jT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a){var o;return e(E)(this,r),(o=n.call(this)).type=t,o._docOrFields=i,o._inclusive=a,e(Fc)(o)}return e(S)(r,[{key:"_apply",value:function(e){var t,n,r=zT(e,this.type,this._docOrFields,this._inclusive);return new a_(e.firestore,e.converter,(t=e._query,n=r,new xy(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,n)))}}],[{key:"_create",value:function(e,t,n){return new r(e,t,n)}}]),r}(DT);function GT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return jT._create("endBefore",t,!1)}function KT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return jT._create("endAt",t,!0)}function zT(t,n,r,i){if(r[0]=Oe(r[0]),r[0]instanceof ET)return function(e,t,n,r,i){if(!r)throw new nv(tv.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a=[],o=!0,u=!1,s=void 0;try{for(var c,l=Cy(e)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;if(h.field.isKeyField())a.push(xp(t,r.key));else{var f=r.data.field(h.field);if(lp(f))throw new nv(tv.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===f){var d=h.field.canonicalString();throw new nv(tv.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(d,"' (used as the orderBy) does not exist."))}a.push(f)}}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return new Pp(a,i)}(t._query,t.firestore._databaseId,n,r[0]._document,i);var a=oT(t.firestore);return function(t,n,r,i,a,o){var u=t.explicitOrderBy;if(a.length>u.length)throw new nv(tv.INVALID_ARGUMENT,"Too many arguments provided to ".concat(i,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var s=[],c=0;c<a.length;c++){var l=a[c];if(u[c].field.isKeyField()){if("string"!=typeof l)throw new nv(tv.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(i,"(), but got a ").concat(void 0===l?"undefined":e(Vc)(l)));if(!Ay(t)&&-1!==l.indexOf("/"))throw new nv(tv.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(i,"() must be a plain document ID, but '").concat(l,"' contains a slash."));var h=t.path.child(wv.fromString(l));if(!Iv.isDocumentKey(h))throw new nv(tv.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(i,"() must result in a valid document path, but '").concat(h,"' is not because it contains an odd number of segments."));var f=new Iv(h);s.push(xp(n,f))}else{var d=yT(r,i,l);s.push(d)}}return new Pp(s,o)}(t._query,t.firestore._databaseId,a,n,r,i)}function WT(e,t,n){if("string"==typeof(n=Oe(n))){if(""===n)throw new nv(tv.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ay(t)&&-1!==n.indexOf("/"))throw new nv(tv.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(wv.fromString(n));if(!Iv.isDocumentKey(r))throw new nv(tv.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return xp(e,new Iv(r))}if(n instanceof i_)return xp(e,n._key);throw new nv(tv.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(JI(n),"."))}function HT(e,t){if(!Array.isArray(e)||0===e.length)throw new nv(tv.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new nv(tv.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function QT(e,t){if(t.isInequality()){var n=Sy(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new nv(tv.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));var i=Ey(e);null!==i&&YT(e,r,i)}var a=function(e,t){var n=!0,r=!1,i=void 0,a=!0,o=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;try{for(var h,f=l.getFlattenedFilters()[Symbol.iterator]();!(n=(h=f.next()).done);n=!0){var d=h.value;if(t.indexOf(d.op)>=0)return d.op}}catch(e){r=!0,i=e}finally{try{n||null==f.return||f.return()}finally{if(r)throw i}}}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==a)throw a===t.op?new nv(tv.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new nv(tv.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(a.toString(),"' filters."))}function YT(e,t,n){if(!n.isEqual(t))throw new nv(tv.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var XT=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(pp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return sp(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(cp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Zd()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return $v(e.fields,(function(e,i){r[e]=n.convertValue(i,t)})),r}},{key:"convertGeoPoint",value:function(e){return new $_(sp(e.latitude),sp(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=hp(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(fp(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=up(e);return new mv(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=wv.fromString(e);$d(bg(n));var r=new Jv(n.get(1),n.get(3)),i=new Iv(n.popFirst(5));return r.isEqual(t)||Yd("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var ZT=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this)).firestore=t,e(Fc)(i)}return e(S)(r,[{key:"convertBytes",value:function(e){return new X_(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new i_(this.firestore,null,t)}}]),r}(XT),$T=function(){"use strict";function t(n,r){e(E)(this,t),this.hasPendingWrites=n,this.fromCache=r}return e(S)(t,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),t}(),eE=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i,a,o,u,s){var c;return e(E)(this,r),(c=n.call(this,t,i,a,o,s))._firestore=t,c._firestoreImpl=t,c.metadata=u,e(Fc)(c)}return e(S)(r,[{key:"exists",value:function(){return e(fn)(e(pn)(r.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new tE(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(AT("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),r}(ET),tE=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.apply(this,arguments)}return e(S)(r,[{key:"data",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e(fn)(e(pn)(r.prototype),"data",this).call(this,t)}}]),r}(eE),nE=function(){"use strict";function t(n,r,i,a){e(E)(this,t),this._firestore=n,this._userDataWriter=r,this._snapshot=a,this.metadata=new $T(a.hasPendingWrites,a.fromCache),this.query=i}return e(S)(t,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new tE(n._firestore,n._userDataWriter,r.key,r,new $T(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new nv(tv.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new tE(e._firestore,e._userDataWriter,t.doc.key,t.doc,new $T(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new tE(e._firestore,e._userDataWriter,t.doc.key,t.doc,new $T(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:rE(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Zd()}}function iE(e,t){return e instanceof eE&&t instanceof eE?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof nE&&t instanceof nE&&e._firestore===t._firestore&&h_(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aE(e){e=ZI(e,i_);var t=ZI(e.firestore,V_);return O_(U_(t),e._key).then((function(n){return gE(t,e,n)}))}var oE=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this)).firestore=t,e(Fc)(i)}return e(S)(r,[{key:"convertBytes",value:function(e){return new X_(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new i_(this.firestore,null,t)}}]),r}(XT);function uE(t){t=ZI(t,i_);var n,r,i,a=ZI(t.firestore,V_),o=U_(a),c=new oE(a);return(n=o,r=t._key,i=new rv,n.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function t(){return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(){var t=e(u)(e(s).mark((function t(n,r,i){var a,o;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=ev(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.localDocuments.getDocument(e,t)}))}(n,r);case 3:(a=e.sent).isFoundDocument()?i.resolve(a):a.isNoDocument()?i.resolve(null):i.reject(new nv(tv.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),o=Ix(e.t0,"Failed to get document '".concat(r," from cache")),i.reject(o);case 11:case"end":return e.stop()}}),t,null,[[0,7]])})));return function(e,n,r){return t.apply(this,arguments)}}(),t.next=3,S_(n);case 3:return t.t1=t.sent,t.t2=r,t.t3=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t3));case 7:case"end":return t.stop()}}),t)})))),i.promise).then((function(e){return new eE(a,c,t._key,e,new $T(null!==e&&e.hasLocalMutations,!0),t.converter)}))}function sE(e){e=ZI(e,i_);var t=ZI(e.firestore,V_);return O_(U_(t),e._key,{source:"server"}).then((function(n){return gE(t,e,n)}))}function cE(e){e=ZI(e,a_);var t=ZI(e.firestore,V_),n=U_(t),r=new oE(t);return CT(e._query),P_(n,e._query).then((function(n){return new nE(t,r,e,n)}))}function lE(t){t=ZI(t,a_);var n,r,i,a=ZI(t.firestore,V_),o=U_(a),c=new oE(a);return(n=o,r=t._query,i=new rv,n.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function t(){return e(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(){var t=e(u)(e(s).mark((function t(n,r,i){var a,o,u,c,l;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nb(n,r,!0);case 3:a=e.sent,o=new Gx(r,a.Hi),u=o.Wu(a.documents),c=o.applyChanges(u,!1),i.resolve(c.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),l=Ix(e.t0,"Failed to execute query '".concat(r," against cache")),i.reject(l);case 14:case"end":return e.stop()}}),t,null,[[0,10]])})));return function(e,n,r){return t.apply(this,arguments)}}(),t.next=3,S_(n);case 3:return t.t1=t.sent,t.t2=r,t.t3=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t3));case 7:case"end":return t.stop()}}),t)})))),i.promise).then((function(e){return new nE(a,c,t,e)}))}function hE(e){e=ZI(e,a_);var t=ZI(e.firestore,V_),n=U_(t),r=new oE(t);return P_(n,e._query,{source:"server"}).then((function(n){return new nE(t,r,e,n)}))}function fE(e,t,n){e=ZI(e,i_);var r=ZI(e.firestore,V_),i=JT(e.converter,t,n);return mE(r,[uT(oT(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,rm.none())])}function dE(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];e=ZI(e,i_);var o=ZI(e.firestore,V_),u=oT(o);return mE(o,[("string"==typeof(t=Oe(t))||t instanceof J_?pT(u,"updateDoc",e._key,t,n,i):vT(u,"updateDoc",e._key,t)).toMutation(e._key,rm.exists(!0))])}function vE(e,t){var n=ZI(e.firestore,V_),r=c_(e),i=JT(e.converter,t);return mE(n,[uT(oT(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,rm.exists(!1))]).then((function(){return r}))}function pE(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a,o,c;t=Oe(t);var l={includeMetadataChanges:!1},h=0;"object"!=typeof r[h]||M_(r[h])||(l=r[h],h++);var f,d,v,p={includeMetadataChanges:l.includeMetadataChanges};if(M_(r[h])){var y=r[h];r[h]=null===(a=y.next)||void 0===a?void 0:a.bind(y),r[h+1]=null===(o=y.error)||void 0===o?void 0:o.bind(y),r[h+2]=null===(c=y.complete)||void 0===c?void 0:c.bind(y)}if(t instanceof i_)d=ZI(t.firestore,V_),v=_y(t._key.path),f={next:function(e){r[h]&&r[h](gE(d,t,e))},error:r[h+1],complete:r[h+2]};else{var m=ZI(t,a_);d=ZI(m.firestore,V_),v=m._query;var g=new oE(d);f={next:function(e){r[h]&&r[h](new nE(d,g,m,e))},error:r[h+1],complete:r[h+2]},CT(t._query)}return function(t,n,r,i){var a=new d_(i),o=new Mx(n,a,r);return t.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Cx,e.next=3,D_(t);case 3:return e.t1=e.sent,e.t2=o,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),n)})))),function(){a.bc(),t.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function n(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Dx,e.next=3,D_(t);case 3:return e.t1=e.sent,e.t2=o,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),n)}))))}}(U_(d),v,p,f)}function yE(t,n){return r=U_(t=ZI(t,V_)),i=M_(n)?n:{next:n},a=new d_(i),r.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t){ev(e).Ru.add(t),t.next()},e.next=3,D_(r);case 3:return e.t1=e.sent,e.t2=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)})))),function(){a.bc(),r.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t){ev(e).Ru.delete(t)},e.next=3,D_(r);case 3:return e.t1=e.sent,e.t2=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)}))))};var r,i,a}function mE(t,n){return r=U_(t),i=n,a=new rv,r.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=$x,e.next=3,C_(r);case 3:return e.t1=e.sent,e.t2=i,e.t3=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}}),t)})))),a.promise;var r,i,a}function gE(e,t,n){var r=n.docs.get(t._key),i=new oE(e);return new eE(e,i,t._key,r,new $T(n.hasPendingWrites,n.fromCache),t.converter)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var kE={maxAttempts:5},wE=function(){"use strict";function t(n,r){e(E)(this,t),this._firestore=n,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=oT(n)}return e(S)(t,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=bE(e,this._firestore),i=JT(r.converter,t,n),a=uT(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,rm.none())),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];this._verifyNotCommitted();var o,u=bE(e,this._firestore);return o="string"==typeof(t=Oe(t))||t instanceof J_?pT(this._dataReader,"WriteBatch.update",u._key,t,n,i):vT(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(o.toMutation(u._key,rm.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=bE(e,this._firestore);return this._mutations=this._mutations.concat(new gm(t._key,rm.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new nv(tv.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bE(e,t){if((e=Oe(e)).firestore!==t)throw new nv(tv.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xE=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,t,i))._firestore=t,e(Fc)(a)}return e(S)(r,[{key:"get",value:function(t){var n=this,i=bE(t,this._firestore),a=new oE(this._firestore);return e(fn)(e(pn)(r.prototype),"get",this).call(this,t).then((function(e){return new eE(n._firestore,a,i._key,e._document,new $T(!1,!1),i.converter)}))}}]),r}(function(){"use strict";function t(n,r){e(E)(this,t),this._firestore=n,this._transaction=r,this._dataReader=oT(n)}return e(S)(t,[{key:"get",value:function(e){var t=this,n=bE(e,this._firestore),r=new ZT(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return Zd();var i=e[0];if(i.isFoundDocument())return new ET(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new ET(t._firestore,r,n._key,null,n.converter);throw Zd()}))}},{key:"set",value:function(e,t,n){var r=bE(e,this._firestore),i=JT(r.converter,t,n),a=uT(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=bE(e,this._firestore);return o="string"==typeof(t=Oe(t))||t instanceof J_?pT(this._dataReader,"Transaction.update",u._key,t,n,i):vT(this._dataReader,"Transaction.update",u._key,t),this._transaction.update(u._key,o),this}},{key:"delete",value:function(e){var t=bE(e,this._firestore);return this._transaction.delete(t._key),this}}]),t}());function IE(t,n,r){t=ZI(t,V_);var i,a,o,c,l=Object.assign(Object.assign({},kE),r);return function(e){if(e.maxAttempts<1)throw new nv(tv.INVALID_ARGUMENT,"Max attempts must be at least 1")}(l),i=U_(t),a=function(e){return n(new xE(t,e))},o=l,c=new rv,i.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function t(){var n;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N_(i);case 2:n=e.sent,new y_(i.asyncQueue,n,o,a,c).run();case 4:case"end":return e.stop()}}),t)})))),c.promise}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _E(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new hT("arrayUnion",t)}function TE(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new fT("arrayRemove",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];zd=Pt,St(new Pe("firestore",(function(e,n){var r=n.instanceIdentifier,i=n.options,a=e.getProvider("app").getImmediate(),o=new V_(new uv(e.getProvider("auth-internal")),new hv(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new nv(tv.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jv(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),qt(Gd,"3.8.3",e),qt(Gd,"3.8.3","esm2017")}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function EE(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new nv("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SE(){if("undefined"==typeof Uint8Array)throw new nv("unimplemented","Uint8Arrays are not available in this environment.")}function AE(){if("undefined"==typeof atob)throw new nv("unimplemented","Blobs are unavailable in Firestore in this environment.")}var CE=function(){"use strict";function t(n){e(E)(this,t),this._delegate=n}return e(S)(t,[{key:"toBase64",value:function(){return AE(),this._delegate.toBase64()}},{key:"toUint8Array",value:function(){return SE(),this._delegate.toUint8Array()}},{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}},{key:"toString",value:function(){return"Blob(base64: "+this.toBase64()+")"}}],[{key:"fromBase64String",value:function(e){return AE(),new t(X_.fromBase64String(e))}},{key:"fromUint8Array",value:function(e){return SE(),new t(X_.fromUint8Array(e))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n=e,r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(s in n&&"function"==typeof n[s])return!0}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return!1}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,["next","error","complete"])}var DE=function(){"use strict";function t(){e(E)(this,t)}return e(S)(t,[{key:"enableIndexedDbPersistence",value:function(e,t){return B_(e._delegate,{forceOwnership:t})}},{key:"enableMultiTabIndexedDbPersistence",value:function(e){return j_(e._delegate)}},{key:"clearIndexedDbPersistence",value:function(e){return K_(e._delegate)}}]),t}(),RE=function(){"use strict";function t(n,r,i){var a=this;e(E)(this,t),this._delegate=r,this._persistenceProvider=i,this.INTERNAL={delete:function(){return a.terminate()}},n instanceof Jv||(this._appCompat=n)}return e(S)(t,[{key:"_databaseId",get:function(){return this._delegate._databaseId}},{key:"settings",value:function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||Xd("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r_(this._delegate,e,t,n)}},{key:"enableNetwork",value:function(){return z_(this._delegate)}},{key:"disableNetwork",value:function(){return W_(this._delegate)}},{key:"enablePersistence",value:function(e){var t=!1,n=!1;return e&&QI("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}},{key:"clearPersistence",value:function(){return this._persistenceProvider.clearIndexedDbPersistence(this)}},{key:"terminate",value:function(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}},{key:"waitForPendingWrites",value:function(){return t=this._delegate,n=U_(t=ZI(t,V_)),r=new rv,n.asyncQueue.enqueueAndForget(e(u)(e(s).mark((function t(){return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=lI,e.next=3,C_(n);case 3:return e.t1=e.sent,e.t2=r,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)})))),r.promise;var t,n,r}},{key:"onSnapshotsInSync",value:function(e){return yE(this._delegate,e)}},{key:"app",get:function(){if(!this._appCompat)throw new nv("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}},{key:"collection",value:function(e){try{return new WE(this,u_(this._delegate,e))}catch(e){throw VE(e,"collection()","Firestore.collection()")}}},{key:"doc",value:function(e){try{return new FE(this,c_(this._delegate,e))}catch(e){throw VE(e,"doc()","Firestore.doc()")}}},{key:"collectionGroup",value:function(e){try{return new GE(this,s_(this._delegate,e))}catch(e){throw VE(e,"collectionGroup()","Firestore.collectionGroup()")}}},{key:"runTransaction",value:function(e){var t=this;return IE(this._delegate,(function(n){return e(new PE(t,n))}))}},{key:"batch",value:function(){var e=this;return U_(this._delegate),new LE(new wE(this._delegate,(function(t){return mE(e._delegate,t)})))}},{key:"loadBundle",value:function(e){return H_(this._delegate,e)}},{key:"namedQuery",value:function(e){var t=this;return Q_(this._delegate,e).then((function(e){return e?new GE(t,e):null}))}}]),t}(),OE=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t){var i;return e(E)(this,r),(i=n.call(this)).firestore=t,i}return e(S)(r,[{key:"convertBytes",value:function(e){return new CE(new X_(e))}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return FE.forKey(t,this.firestore,null)}}]),r}(XT);var PE=function(){"use strict";function t(n,r){e(E)(this,t),this._firestore=n,this._delegate=r,this._userDataWriter=new OE(n)}return e(S)(t,[{key:"get",value:function(e){var t=this,n=HE(e);return this._delegate.get(n).then((function(e){return new BE(t._firestore,new eE(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))}},{key:"set",value:function(e,t,n){var r=HE(e);return n?(EE("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(t,n,r){for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];var u,s=HE(t);return 2===arguments.length?this._delegate.update(s,n):(u=this._delegate).update.apply(u,[s,n,r].concat(e(R)(a))),this}},{key:"delete",value:function(e){var t=HE(e);return this._delegate.delete(t),this}}]),t}(),LE=function(){"use strict";function t(n){e(E)(this,t),this._delegate=n}return e(S)(t,[{key:"set",value:function(e,t,n){var r=HE(e);return n?(EE("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(t,n,r){for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];var u,s=HE(t);return 2===arguments.length?this._delegate.update(s,n):(u=this._delegate).update.apply(u,[s,n,r].concat(e(R)(a))),this}},{key:"delete",value:function(e){var t=HE(e);return this._delegate.delete(t),this}},{key:"commit",value:function(){return this._delegate.commit()}}]),t}(),ME=function(){"use strict";function t(n,r,i){e(E)(this,t),this._firestore=n,this._userDataWriter=r,this._delegate=i}return e(S)(t,[{key:"fromFirestore",value:function(e,t){var n=new tE(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new jE(this._firestore,n),null!=t?t:{})}},{key:"toFirestore",value:function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}}],[{key:"getInstance",value:function(e,n){var r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var a=i.get(n);return a||(a=new t(e,new OE(e),n),i.set(n,a)),a}}]),t}();ME.INSTANCES=new WeakMap;var FE=function(){"use strict";function t(n,r){e(E)(this,t),this.firestore=n,this._delegate=r,this._userDataWriter=new OE(n)}return e(S)(t,[{key:"id",get:function(){return this._delegate.id}},{key:"parent",get:function(){return new WE(this.firestore,this._delegate.parent)}},{key:"path",get:function(){return this._delegate.path}},{key:"collection",value:function(e){try{return new WE(this.firestore,u_(this._delegate,e))}catch(e){throw VE(e,"collection()","DocumentReference.collection()")}}},{key:"isEqual",value:function(e){return(e=Oe(e))instanceof i_&&l_(this._delegate,e)}},{key:"set",value:function(e,t){t=EE("DocumentReference.set",t);try{return t?fE(this._delegate,e,t):fE(this._delegate,e)}catch(e){throw VE(e,"setDoc()","DocumentReference.set()")}}},{key:"update",value:function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];try{return 1===arguments.length?dE(this._delegate,t):dE.apply(void 0,[this._delegate,t,n].concat(e(R)(i)))}catch(e){throw VE(e,"updateDoc()","DocumentReference.update()")}}},{key:"delete",value:function(){return mE(ZI((e=this._delegate).firestore,V_),[new gm(e._key,rm.none())]);var e}},{key:"onSnapshot",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this,i=UE(t),a=qE(t,(function(e){return new BE(r.firestore,new eE(r.firestore._delegate,r._userDataWriter,e._key,e._document,e.metadata,r._delegate.converter))}));return pE(this._delegate,i,a)}},{key:"get",value:function(e){var t=this;return("cache"===(null==e?void 0:e.source)?uE(this._delegate):"server"===(null==e?void 0:e.source)?sE(this._delegate):aE(this._delegate)).then((function(e){return new BE(t.firestore,new eE(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}))}},{key:"withConverter",value:function(e){return new t(this.firestore,e?this._delegate.withConverter(ME.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}],[{key:"forPath",value:function(e,n,r){if(e.length%2!=0)throw new nv("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(e.canonicalString()," has ").concat(e.length));return new t(n,new i_(n._delegate,r,new Iv(e)))}},{key:"forKey",value:function(e,n,r){return new t(n,new i_(n._delegate,r,e))}}]),t}();function VE(e,t,n){return e.message=e.message.replace(t,n),e}function UE(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if("object"==typeof o&&!NE(o))return o}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return{}}function qE(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=NE(e[0])?e[0]:NE(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var BE=function(){"use strict";function t(n,r){e(E)(this,t),this._firestore=n,this._delegate=r}return e(S)(t,[{key:"ref",get:function(){return new FE(this._firestore,this._delegate.ref)}},{key:"id",get:function(){return this._delegate.id}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"exists",get:function(){return this._delegate.exists()}},{key:"data",value:function(e){return this._delegate.data(e)}},{key:"get",value:function(e,t){return this._delegate.get(e,t)}},{key:"isEqual",value:function(e){return iE(this._delegate,e._delegate)}}]),t}(),jE=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(){return e(E)(this,r),n.apply(this,arguments)}return e(S)(r,[{key:"data",value:function(e){var t=this._delegate.data(e);return void 0!==t||Zd(),t}}]),r}(BE),GE=function(){"use strict";function t(n,r){e(E)(this,t),this.firestore=n,this._delegate=r,this._userDataWriter=new OE(n)}return e(S)(t,[{key:"where",value:function(e,n,r){try{return new t(this.firestore,RT(this._delegate,PT(e,n,r)))}catch(e){throw VE(e,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"orderBy",value:function(e,n){try{return new t(this.firestore,RT(this._delegate,FT(e,n)))}catch(e){throw VE(e,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"limit",value:function(e){try{return new t(this.firestore,RT(this._delegate,($I("limit",n=e),VT._create("limit",n,"F"))))}catch(e){throw VE(e,"limit()","Query.limit()")}var n}},{key:"limitToLast",value:function(e){try{return new t(this.firestore,RT(this._delegate,($I("limitToLast",n=e),VT._create("limitToLast",n,"L"))))}catch(e){throw VE(e,"limitToLast()","Query.limitToLast()")}var n}},{key:"startAt",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,RT(this._delegate,qT.apply(void 0,e(R)(r))))}catch(e){throw VE(e,"startAt()","Query.startAt()")}}},{key:"startAfter",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,RT(this._delegate,BT.apply(void 0,e(R)(r))))}catch(e){throw VE(e,"startAfter()","Query.startAfter()")}}},{key:"endBefore",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,RT(this._delegate,GT.apply(void 0,e(R)(r))))}catch(e){throw VE(e,"endBefore()","Query.endBefore()")}}},{key:"endAt",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,RT(this._delegate,KT.apply(void 0,e(R)(r))))}catch(e){throw VE(e,"endAt()","Query.endAt()")}}},{key:"isEqual",value:function(e){return h_(this._delegate,e._delegate)}},{key:"get",value:function(e){var t=this;return("cache"===(null==e?void 0:e.source)?lE(this._delegate):"server"===(null==e?void 0:e.source)?hE(this._delegate):cE(this._delegate)).then((function(e){return new zE(t.firestore,new nE(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}))}},{key:"onSnapshot",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this,i=UE(t),a=qE(t,(function(e){return new zE(r.firestore,new nE(r.firestore._delegate,r._userDataWriter,r._delegate,e._snapshot))}));return pE(this._delegate,i,a)}},{key:"withConverter",value:function(e){return new t(this.firestore,e?this._delegate.withConverter(ME.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),t}(),KE=function(){"use strict";function t(n,r){e(E)(this,t),this._firestore=n,this._delegate=r}return e(S)(t,[{key:"type",get:function(){return this._delegate.type}},{key:"doc",get:function(){return new jE(this._firestore,this._delegate.doc)}},{key:"oldIndex",get:function(){return this._delegate.oldIndex}},{key:"newIndex",get:function(){return this._delegate.newIndex}}]),t}(),zE=function(){"use strict";function t(n,r){e(E)(this,t),this._firestore=n,this._delegate=r}return e(S)(t,[{key:"query",get:function(){return new GE(this._firestore,this._delegate.query)}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"size",get:function(){return this._delegate.size}},{key:"empty",get:function(){return this._delegate.empty}},{key:"docs",get:function(){var e=this;return this._delegate.docs.map((function(t){return new jE(e._firestore,t)}))}},{key:"docChanges",value:function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new KE(t._firestore,e)}))}},{key:"forEach",value:function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new jE(n._firestore,r))}))}},{key:"isEqual",value:function(e){return iE(this._delegate,e._delegate)}}]),t}(),WE=function(t){"use strict";e(N)(r,t);var n=e(G)(r);function r(t,i){var a;return e(E)(this,r),(a=n.call(this,t,i)).firestore=t,a._delegate=i,a}return e(S)(r,[{key:"id",get:function(){return this._delegate.id}},{key:"path",get:function(){return this._delegate.path}},{key:"parent",get:function(){var e=this._delegate.parent;return e?new FE(this.firestore,e):null}},{key:"doc",value:function(e){try{return new FE(this.firestore,void 0===e?c_(this._delegate):c_(this._delegate,e))}catch(e){throw VE(e,"doc()","CollectionReference.doc()")}}},{key:"add",value:function(e){var t=this;return vE(this._delegate,e).then((function(e){return new FE(t.firestore,e)}))}},{key:"isEqual",value:function(e){return l_(this._delegate,e._delegate)}},{key:"withConverter",value:function(e){return new r(this.firestore,e?this._delegate.withConverter(ME.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),r}(GE);function HE(e){return ZI(e,i_)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var QE=function(){"use strict";function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e(E)(this,t),this._delegate=e(Mc)(J_,e(R)(r))}return e(S)(t,[{key:"isEqual",value:function(e){return(e=Oe(e))instanceof J_&&this._delegate._internalPath.isEqual(e._internalPath)}}],[{key:"documentId",value:function(){return new t(xv.keyField().canonicalString())}}]),t}(),YE=function(){"use strict";function t(n){e(E)(this,t),this._delegate=n}return e(S)(t,[{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}}],[{key:"serverTimestamp",value:function(){var e=new lT("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)}},{key:"delete",value:function(){var e=new sT("deleteField");return e._methodName="FieldValue.delete",new t(e)}},{key:"arrayUnion",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=_E.apply(void 0,e(R)(r));return a._methodName="FieldValue.arrayUnion",new t(a)}},{key:"arrayRemove",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=TE.apply(void 0,e(R)(r));return a._methodName="FieldValue.arrayRemove",new t(a)}},{key:"increment",value:function(e){var n=new dT("increment",e);return n._methodName="FieldValue.increment",new t(n)}}]),t}(),XE={Firestore:RE,GeoPoint:$_,Timestamp:mv,Blob:CE,Transaction:PE,WriteBatch:LE,DocumentReference:FE,DocumentSnapshot:BE,Query:GE,QueryDocumentSnapshot:jE,QuerySnapshot:zE,CollectionReference:WE,FieldPath:QE,FieldValue:YE,setLogLevel:function(e){var t;t=e,Wd.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){var t;t=function(e,t){return new RE(e,t,new DE)},e.INTERNAL.registerComponent(new Pe("firestore-compat",(function(e){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},XE))),e.registerVersion("@firebase/firestore-compat","0.3.3")}(hn);d=o("6JpON"),y=o("aNvF6");hn.initializeApp({apiKey:"AIzaSyCoCV-uT6m4zkhe8p5jJA8T8Quk2bX8xX8",authDomain:"filmoteka-b315b.firebaseapp.com",projectId:"filmoteka-b315b",storageBucket:"filmoteka-b315b.appspot.com",messagingSenderId:"903917604658",appId:"1:903917604658:web:0382307da84868e996912b",measurementId:"G-WMMJWSVNYB"});var JE=JSON.parse(localStorage.getItem("account"));JE?(document.getElementById("signin").classList.add("close"),document.getElementById("signout").classList.remove("close"),document.getElementById("googleUser").style.display="block",$E(JE.photo),document.querySelector(".firebases").insertAdjacentHTML("beforebegin",'<li><a class="nav__link nav__link--library" href="my-library.html">MY LIBRARY</a></li>')):document.getElementById("signin").addEventListener("click",ZE);function ZE(){var e=new hn.auth.GoogleAuthProvider;hn.auth().signInWithPopup(e).then((function(e){document.getElementById("signin").classList.add("close"),document.getElementById("signout").classList.remove("close"),document.getElementById("googleUser").style.display="block",$E(e.user.photoURL),document.querySelector(".firebases").insertAdjacentHTML("beforebegin",'<li><a class="nav__link nav__link--library" href="my-library.html">MY LIBRARY</a></li>'),console.log(e),localStorage.setItem("account",JSON.stringify({email:e.user.email,photo:e.user.photoURL})),y.storage.resetConstructor(),hn.auth().signOut()})).catch((function(e){console.log(e)}))}function $E(e){document.getElementById("googleUser").innerHTML='\n          <img class="user-img" src="'.concat(e,'">\n        ')}document.getElementById("signout").addEventListener("click",(function(){JSON.parse(localStorage.getItem("account"))?(localStorage.removeItem("account"),document.getElementById("signin").classList.remove("close"),document.getElementById("signout").classList.add("close"),document.getElementById("googleUser").style.display="none",document.querySelector(".nav__link--library").parentNode.remove(),y.storage.resetConstructor()):(e(d).Notify.warning("âž¡ You have to sign in first"),console.log("âž¡ You have to sign in first"));document.getElementById("signin").addEventListener("click",ZE)}))}();
//# sourceMappingURL=index.74783ecd.js.map
